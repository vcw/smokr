/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{251:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(85),o=n(171),c=n(173),h=n(118),i=n(252),f=n(172);var u=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(o),a={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},l=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return r.__extends(e,t),e}(Error),d=new c.Logger("@firebase/firestore");function v(){return d.logLevel}function y(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(d.logLevel<=c.LogLevel.DEBUG){var n=e.map(w);d.debug.apply(d,r.__spreadArrays(["Firestore (7.22.0): "+t],n))}}function p(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(d.logLevel<=c.LogLevel.ERROR){var n=e.map(w);d.error.apply(d,r.__spreadArrays(["Firestore (7.22.0): "+t],n))}}function m(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(d.logLevel<=c.LogLevel.WARN){var n=e.map(w);d.warn.apply(d,r.__spreadArrays(["Firestore (7.22.0): "+t],n))}}function w(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function _(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.22.0) INTERNAL ASSERTION FAILED: "+t;throw p(e),new Error(e)}function g(t,e){t||_()}function I(t,e){return t}function E(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function T(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function b(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var A=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&_(),void 0===n?n=t.length-e:n>t.length-e&&_(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.prototype.R=function(){return this.A().join("/")},e.prototype.toString=function(){return this.R()},e.P=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new l(a.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.g=function(){return new e([])},e}(A),S=/^[_a-zA-Z][_a-zA-Z0-9]*$/,x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.V=function(t){return S.test(t)},e.prototype.R=function(){return this.A().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.V(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.R()},e.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},e.v=function(){return new e(["__name__"])},e.S=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new l(a.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new l(a.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var c=t[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new l(a.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=c,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new l(a.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.g=function(){return new e([])},e}(A),D=function(){function t(t){this.path=t}return t.D=function(e){return new t(N.P(e))},t.C=function(e){return new t(N.P(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===N.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return N.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new N(e.slice()))},t}();function k(t,e){if(0!==e.length)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+H(e.length,"argument")+".")}function O(t,e,n){if(e.length!==n)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires "+H(n,"argument")+", but was called with "+H(e.length,"argument")+".")}function L(t,e,n){if(e.length<n)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires at least "+H(n,"argument")+", but was called with "+H(e.length,"argument")+".")}function R(t,e,n,r){if(e.length<n||e.length>r)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+H(e.length,"argument")+".")}function C(t,e,n,r){j(t,e,W(n)+" argument",r)}function P(t,e,n,r){void 0!==r&&C(t,e,n,r)}function U(t,e,n,r){j(t,e,n+" option",r)}function V(t,e,n,r){void 0!==r&&U(t,e,n,r)}function M(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var c=u[s];if(c===r)return;o.push(B(c))}var h=B(r);throw new l(a.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function F(t,e,n,r){if(!e.some((function(t){return t===r})))throw new l(a.INVALID_ARGUMENT,"Invalid value "+B(r)+" provided to function "+t+"() for its "+W(n)+" argument. Acceptable values: "+e.join(", "));return r}function j(t,e,n,r){if(!("object"===e?G(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=B(r);throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function G(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function B(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":_()}function q(t,e,n){if(void 0===n)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+W(e)+" argument, but it was undefined.")}function z(t,e,n){T(e,(function(e,r){if(n.indexOf(e)<0)throw new l(a.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function Q(t,e,n,r){var i=B(r);return new l(a.INVALID_ARGUMENT,"Function "+t+"() requires its "+W(n)+" argument to be a "+e+", but it was: "+i)}function K(t,e,n){if(n<=0)throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires its "+W(e)+" argument to be a positive number, but it was: "+n+".")}function W(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function H(t,e){return t+" "+e+(1===t?"":"s")}function Y(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var X=function(){function t(){}return t.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Y(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function $(t,e){return t<e?-1:t>e?1:0}function J(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Z(t){return t+"\0"}var tt=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.M,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return $(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();tt.B=new tt("");var et=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t(tt.fromBase64String(e))}catch(e){throw new l(a.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(tt.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();function nt(){if("undefined"==typeof Uint8Array)throw new l(a.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function it(){if("undefined"==typeof atob)throw new l(a.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.fromBase64String=function(t){O("Blob.fromBase64String",arguments,1),C("Blob.fromBase64String","string",1,t),it();try{return new e(tt.fromBase64String(t))}catch(t){throw new l(a.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){if(O("Blob.fromUint8Array",arguments,1),nt(),!(t instanceof Uint8Array))throw Q("Blob.fromUint8Array","Uint8Array",1,t);return new e(tt.fromUint8Array(t))},e.prototype.toBase64=function(){return O("Blob.toBase64",arguments,0),it(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return O("Blob.toUint8Array",arguments,0),nt(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(et),st=function(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},rt=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return $(this.projectId,t.projectId)||$(this.database,t.database)},t}(),ut=function(){function t(t,e){this.j=t,this.K=e,this.G={}}return t.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.K(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){T(this.G,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.m=function(){return b(this.G)},t}(),at=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new l(a.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new l(a.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new l(a.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new l(a.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.H=function(t){return this.seconds===t.seconds?$(this.nanoseconds,t.nanoseconds):$(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ct=function(){function t(t){this.timestamp=t}return t.Y=function(e){return new t(e)},t.min=function(){return new t(new at(0,0))},t.prototype.L=function(t){return this.timestamp.H(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.X=function(){return this.timestamp},t}();function ht(t){return null==t}function ft(t){return 0===t&&1/t==-1/0}function lt(t){return"number"==typeof t&&Number.isInteger(t)&&!ft(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var pt=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function vt(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new pt(t,e,n,r,i,o,s)}function yt(t){var e=I(t);if(null===e.Z){var n=e.path.R();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.R()+t.op.toString()+oe(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.R()+e.dir;var e})).join(","),ht(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ur(e.startAt)),e.endAt&&(n+="|ub:",n+=ur(e.endAt)),e.Z=n}return e.Z}function gt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!pr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ee(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cr(t.startAt,e.startAt)&&cr(t.endAt,e.endAt)}function dt(t){return D.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mt,wt,bt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ct.min()),void 0===o&&(o=ct.min()),void 0===s&&(s=tt.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}(),_t=function(t){this.count=t};function It(t){switch(t){case a.OK:return _();case a.CANCELLED:case a.UNKNOWN:case a.DEADLINE_EXCEEDED:case a.RESOURCE_EXHAUSTED:case a.INTERNAL:case a.UNAVAILABLE:case a.UNAUTHENTICATED:return!1;case a.INVALID_ARGUMENT:case a.NOT_FOUND:case a.ALREADY_EXISTS:case a.PERMISSION_DENIED:case a.FAILED_PRECONDITION:case a.ABORTED:case a.OUT_OF_RANGE:case a.UNIMPLEMENTED:case a.DATA_LOSS:return!0;default:return _()}}function Et(t){if(void 0===t)return p("GRPC error has no .code"),a.UNKNOWN;switch(t){case mt.OK:return a.OK;case mt.CANCELLED:return a.CANCELLED;case mt.UNKNOWN:return a.UNKNOWN;case mt.DEADLINE_EXCEEDED:return a.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return a.RESOURCE_EXHAUSTED;case mt.INTERNAL:return a.INTERNAL;case mt.UNAVAILABLE:return a.UNAVAILABLE;case mt.UNAUTHENTICATED:return a.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return a.INVALID_ARGUMENT;case mt.NOT_FOUND:return a.NOT_FOUND;case mt.ALREADY_EXISTS:return a.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return a.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return a.FAILED_PRECONDITION;case mt.ABORTED:return a.ABORTED;case mt.OUT_OF_RANGE:return a.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return a.UNIMPLEMENTED;case mt.DATA_LOSS:return a.DATA_LOSS;default:return _()}}(wt=mt||(mt={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";var Tt=function(){function t(t,e){this.i=t,this.root=e||Nt.EMPTY}return t.prototype.rt=function(e,n){return new t(this.i,this.root.rt(e,n,this.i).copy(null,null,Nt.ot,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,Nt.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new At(this.root,null,this.i,!1)},t.prototype._t=function(t){return new At(this.root,t,this.i,!1)},t.prototype.ft=function(){return new At(this.root,null,this.i,!0)},t.prototype.dt=function(t){return new At(this.root,t,this.i,!0)},t}(),At=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),Nt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.gt()||i.left.left.gt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.Vt()),i.right.m()||i.right.gt()||i.right.left.gt()||(i=i.bt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},t.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},t.prototype.vt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Vt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw _();if(this.right.gt())throw _();var t=this.left.Ct();if(t!==this.right.Ct())throw _();return t+(this.gt()?0:1)},t}();Nt.EMPTY=null,Nt.RED=!0,Nt.ot=!1,Nt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw _()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw _()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw _()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw _()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw _()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new Nt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());var St=function(){function t(t){this.i=t,this.data=new Tt(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.$t=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new xt(this.data.lt())},t.prototype._t=function(t){return new xt(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),xt=function(){function t(t){this.kt=t}return t.prototype.Et=function(){return this.kt.Et().key},t.prototype.It=function(){return this.kt.It()},t}(),Dt=new Tt(D.i);function kt(){return Dt}function Ot(){return kt()}var Lt=new Tt(D.i);function Rt(){return Lt}var Ct=new Tt(D.i),Pt=new St(D.i);function Ut(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Pt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Vt=new St($);function Mt(){return Vt}var Ft=function(){function t(t){this.i=t?function(e,n){return t(e,n)||D.i(e.key,n.key)}:function(t,e){return D.i(t.key,e.key)},this.Mt=Rt(),this.Ot=new Tt(this.i)}return t.Lt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Mt.get(t)},t.prototype.get=function(t){return this.Mt.get(t)},t.prototype.first=function(){return this.Ot.at()},t.prototype.last=function(){return this.Ot.ct()},t.prototype.m=function(){return this.Ot.m()},t.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ot.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ot.lt(),r=e.Ot.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Mt=e,r.Ot=n,r},t}(),qt=function(){function t(){this.Bt=new Tt(D.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):_():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut((function(e,n){t.push(n)})),t},t}(),jt=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}return t.Kt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ft.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Kn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Gt=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}return t.Jt=function(e,n){var r=new Map;return r.set(e,Bt.Xt(e,n)),new t(ct.min(),r,Mt(),kt(),Ut())},t}(),Bt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t(tt.B,n,Ut(),Ut(),Ut())},t}(),zt=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Qt=function(t,e){this.targetId=t,this.re=e},Kt=function(t,e,n,r){void 0===n&&(n=tt.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Wt=function(){function t(){this.oe=0,this.ae=Xt(),this.ce=tt.B,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.O()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=Ut(),e=Ut(),n=Ut();return this.ae.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:_()}})),new Bt(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=Xt()},t.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ee=function(){this.oe+=1},t.prototype.Ie=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),Ht=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=kt(),this.ye=Yt(),this.Ve=new St($)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof kn?this.be(r,t.ie):t.ie instanceof On&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},t.prototype.Se=function(t){var e=this;this.De(t,(function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.Ie(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.Ie(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.Fe(n),r.fe(t.resumeToken));break;default:_()}}))},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Ne(r)&&e(r)}))},t.prototype.$e=function(t){var e=t.targetId,n=t.re.count,r=this.xe(e);if(r){var i=r.target;if(dt(i))if(0===n){var o=new D(i.path);this.ve(e,o,new On(o,ct.min()))}else g(1===n);else this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e))}},t.prototype.Me=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.xe(i);if(o){if(r.Zt&&dt(o.target)){var s=new D(o.target.path);null!==e.ge.get(s)||e.Oe(i,s)||e.ve(i,s,new On(s,t))}r._e&&(n.set(i,r.de()),r.we())}}));var r=Ut();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.xe(t);return!n||2===n.tt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Gt(t,n,this.Ve,this.ge,r);return this.ge=kt(),this.ye=Yt(),this.Ve=new St($),i},t.prototype.be=function(t,e){if(this.Ne(t)){var n=this.Oe(t,e.key)?2:0;this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t))}},t.prototype.ve=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ee=function(t){this.Ce(t).Ee()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Wt,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new St($),this.ye=this.ye.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.xe(t);return e||y("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.Fe=function(t){var e=this;this.Pe.set(t,new Wt),this.Re.Be(t).forEach((function(n){e.ve(t,n,null)}))},t.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},t}();function Yt(){return new Tt(D.i)}function Xt(){return new Tt(D.i)}function $t(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Jt(t){var e=se(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}var Zt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function te(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$t(t)?4:10:_()}function ee(t,e){var n=te(t);if(n!==te(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jt(t).isEqual(Jt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=se(t.timestampValue),r=se(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ae(t.bytesValue).isEqual(ae(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ue(t.geoPointValue.latitude)===ue(e.geoPointValue.latitude)&&ue(t.geoPointValue.longitude)===ue(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ue(t.integerValue)===ue(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ue(t.doubleValue),r=ue(e.doubleValue);return n===r?ft(n)===ft(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return J(t.arrayValue.values||[],e.arrayValue.values||[],ee);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(E(n)!==E(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ee(n[i],r[i])))return!1;return!0}(t,e);default:return _()}}function ne(t,e){return void 0!==(t.values||[]).find((function(t){return ee(t,e)}))}function re(t,e){var n=te(t),r=te(e);if(n!==r)return $(n,r);switch(n){case 0:return 0;case 1:return $(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ue(t.integerValue||t.doubleValue),r=ue(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ie(t.timestampValue,e.timestampValue);case 4:return ie(Jt(t),Jt(e));case 5:return $(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ae(t),r=ae(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=$(n[i],r[i]);if(0!==o)return o}return $(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=$(ue(t.latitude),ue(e.latitude));return 0!==n?n:$(ue(t.longitude),ue(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=re(n[i],r[i]);if(o)return o}return $(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=$(r[s],o[s]);if(0!==u)return u;var a=re(n[r[s]],i[o[s]]);if(0!==a)return a}return $(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _()}}function ie(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return $(t,e);var n=se(t),r=se(e),i=$(n.seconds,r.seconds);return 0!==i?i:$(n.nanos,r.nanos)}function oe(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=se(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ae(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,D.C(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):_();var n,r}(t)}function se(t){if(g(!!t),"string"==typeof t){var e=0,n=Zt.exec(t);if(g(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ue(t.seconds),nanos:ue(t.nanos)}}function ue(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ae(t){return"string"==typeof t?tt.fromBase64String(t):tt.fromUint8Array(t)}function ce(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function he(t){return!!t&&"integerValue"in t}function fe(t){return!!t&&"arrayValue"in t}function le(t){return!!t&&"nullValue"in t}function pe(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function de(t){return!!t&&"mapValue"in t}var ve={asc:"ASCENDING",desc:"DESCENDING"},ye={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ge=function(t,e){this.U=t,this.Ue=e};function me(t){return{integerValue:""+t}}function we(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ft(e)?"-0":e}}function be(t,e){return lt(e)?me(e):we(t,e)}function _e(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ie(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function Ee(t,e){return _e(t,e.X())}function Te(t){return g(!!t),ct.Y(function(t){var e=se(t);return new at(e.seconds,e.nanos)}(t))}function Ae(t,e){return function(t){return new N(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).R()}function Ne(t){var e=N.P(t);return g(We(e)),e}function Se(t,e){return Ae(t.U,e.path)}function xe(t,e){var n=Ne(e);return g(n.get(1)===t.U.projectId),g(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new D(Le(n))}function De(t,e){return Ae(t.U,e)}function ke(t){var e=Ne(t);return 4===e.length?N.g():Le(e)}function Oe(t){return new N(["projects",t.U.projectId,"databases",t.U.database]).R()}function Le(t){return g(t.length>4&&"documents"===t.get(4)),t.u(5)}function Re(t,e,n){return{name:Se(t,e),fields:n.proto.mapValue.fields}}function Ce(t,e){var n;if(e instanceof mn)n={update:Re(t,e.key,e.value)};else if(e instanceof Tn)n={delete:Se(t,e.key)};else if(e instanceof wn)n={update:Re(t,e.key,e.data),updateMask:Ke(e.Qe)};else if(e instanceof _n)n={transform:{document:Se(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Je)return{fieldPath:e.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ze)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof en)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof rn)return{fieldPath:e.field.R(),increment:n.We};throw _()}(0,t)}))}};else{if(!(e instanceof An))return _();n={verify:Se(t,e.key)}}return e.Ke.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ee(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:_()}(t,e.Ke)),n}function Pe(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?hn.updateTime(Te(t.updateTime)):void 0!==t.exists?hn.exists(t.exists):hn.Ge()}(e.currentDocument):hn.Ge();if(e.update){e.update.name;var r=xe(t,e.update.name),i=new Nn({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new un(e.map((function(t){return x.S(t)})))}(e.updateMask);return new wn(r,i,o,n)}return new mn(r,i,n)}if(e.delete){var s=xe(t,e.delete);return new Tn(s,n)}if(e.transform){var u=xe(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)g("REQUEST_TIME"===e.setToServerValue),n=new Je;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ze(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new en(i)}else"increment"in e?n=new rn(t,e.increment):_();var o=x.S(e.fieldPath);return new an(o,n)}(t,e)}));return g(!0===n.exists),new _n(u,a)}if(e.verify){var c=xe(t,e.verify);return new An(c,n)}return _()}function Ue(t,e){return{documents:[De(t,e.path)]}}function Ve(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=De(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=De(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(pe(t.value))return{unaryFilter:{field:Ge(t.field),op:"IS_NAN"}};if(le(t.value))return{unaryFilter:{field:Ge(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(pe(t.value))return{unaryFilter:{field:Ge(t.field),op:"IS_NOT_NAN"}};if(le(t.value))return{unaryFilter:{field:Ge(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ge(t.field),op:je(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ge(t.field),direction:qe(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||ht(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Me(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Me(e.endAt)),n}function Me(t){return{before:t.before,values:t.position}}function Fe(t){var e=!!t.before,n=t.values||[];return new sr(n,e)}function qe(t){return ve[t]}function je(t){return ye[t]}function Ge(t){return{fieldPath:t.R()}}function Be(t){return x.S(t.fieldPath)}function ze(t){return $n.create(Be(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _()}}(t.fieldFilter.op),t.fieldFilter.value)}function Qe(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Be(t.unaryFilter.field);return $n.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Be(t.unaryFilter.field);return $n.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Be(t.unaryFilter.field);return $n.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Be(t.unaryFilter.field);return $n.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _()}}function Ke(t){var e=[];return t.fields.forEach((function(t){return e.push(t.R())})),{fieldPaths:e}}function We(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var He=function(){this.ze=void 0};function Ye(t,e,n){return t instanceof Je?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ze?tn(t,e):t instanceof en?nn(t,e):function(t,e){var n=$e(t,e),r=on(n)+on(t.We);return he(n)&&he(t.We)?me(r):we(t.serializer,r)}(t,e)}function Xe(t,e,n){return t instanceof Ze?tn(t,e):t instanceof en?nn(t,e):n}function $e(t,e){return t instanceof rn?he(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(He),Ze=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(He);function tn(t,e){for(var n=sn(e),r=function(t){n.some((function(e){return ee(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var en=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(He);function nn(t,e){for(var n=sn(e),r=function(t){n=n.filter((function(e){return!ee(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return r.__extends(e,t),e}(He);function on(t){return ue(t.integerValue||t.doubleValue)}function sn(t){return fe(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var un=function(){function t(t){this.fields=t,t.sort(x.i)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return J(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),an=function(t,e){this.field=t,this.transform=e},cn=function(t,e){this.version=t,this.transformResults=e},hn=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function fn(t,e){return void 0!==t.updateTime?e instanceof kn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof kn}var ln=function(){};function pn(t,e,n){return t instanceof mn?function(t,e,n){return new kn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof wn?function(t,e,n){if(!fn(t.Ke,e))return new Ln(t.key,n.version);var r=bn(t,e);return new kn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof _n?function(t,e,n){if(g(null!=n.transformResults),!fn(t.Ke,e))return new Ln(t.key,n.version);var r=In(t,e),i=function(t,e,n){var r=[];g(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof kn&&(u=e.field(o.field)),r.push(Xe(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=En(t,r.data(),i);return new kn(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new On(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function dn(t,e,n,r){return t instanceof mn?function(t,e){if(!fn(t.Ke,e))return e;var n=gn(e);return new kn(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof wn?function(t,e){if(!fn(t.Ke,e))return e;var n=gn(e),r=bn(t,e);return new kn(t.key,n,r,{Ye:!0})}(t,e):t instanceof _n?function(t,e,n,r){if(!fn(t.Ke,e))return e;var i=In(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof kn&&(c=n.field(u.field)),null===c&&r instanceof kn&&(c=r.field(u.field)),i.push(Ye(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=En(t,i.data(),o);return new kn(t.key,i.version,s,{Ye:!0})}(t,e,r,n):function(t,e){return fn(t.Ke,e)?new On(t.key,ct.min()):e}(t,e)}function vn(t,e){return t instanceof _n?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof kn?e.field(o.field):void 0,u=$e(o.transform,s||null);null!=u&&(n=null==n?(new Sn).set(o.field,u):n.set(o.field,u))}return n?n.Je():null}(t,e):null}function yn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||J(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ze&&e instanceof Ze||t instanceof en&&e instanceof en?J(t.elements,e.elements,ee):t instanceof rn&&e instanceof rn?ee(t.We,e.We):t instanceof Je&&e instanceof Je}(t.transform,e.transform)}(t,e)})))}function gn(t){return t instanceof kn?t.version:ct.min()}var mn=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ke=r,i.type=0,i}return r.__extends(e,t),e}(ln),wn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ke=i,o.type=1,o}return r.__extends(e,t),e}(ln);function bn(t,e){return function(t,e){var n=new Sn(e);return t.Qe.fields.forEach((function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Je()}(t,e instanceof kn?e.data():Nn.empty())}var _n=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ke=hn.exists(!0),r}return r.__extends(e,t),e}(ln);function In(t,e){return e}function En(t,e,n){for(var r=new Sn(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var Tn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=3,r}return r.__extends(e,t),e}(ln),An=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=4,r}return r.__extends(e,t),e}(ln),Nn=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!de(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return ee(this.proto,t.proto)},t}(),Sn=function(){function t(t){void 0===t&&(t=Nn.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===te(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Je=function(){var t=this.en(x.g(),this.Ze);return null!=t?new Nn(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=de(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function xn(t){var e=[];return T(t.fields||{},(function(t,n){var r=new x([t]);if(de(n)){var i=xn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new un(e)}var Dn=function(t,e){this.key=t,this.version=e},kn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).nn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return r.__extends(e,t),e.prototype.field=function(t){return this.nn.field(t)},e.prototype.data=function(){return this.nn},e.prototype.sn=function(){return this.nn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Dn),On=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return r.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Dn),Ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Dn),Rn=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null,this.startAt,this.endAt};function Cn(t,e,n,r,i,o,s,u){return new Rn(t,e,n,r,i,o,s,u)}function Pn(t){return new Rn(t)}function Un(t){return!ht(t.limit)&&"F"===t.on}function Vn(t){return!ht(t.limit)&&"L"===t.on}function Mn(t){return t.rn.length>0?t.rn[0].field:null}function Fn(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function qn(t){return null!==t.collectionGroup}function jn(t){var e=I(t);if(null===e.an){e.an=[];var n=Fn(e),r=Mn(e);if(null!==n&&null===r)n.p()||e.an.push(new fr(n)),e.an.push(new fr(x.v(),"asc"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var u=s[o];e.an.push(u),u.field.p()&&(i=!0)}if(!i){var a=e.rn.length>0?e.rn[e.rn.length-1].dir:"asc";e.an.push(new fr(x.v(),a))}}}return e.an}function Gn(t){var e=I(t);if(!e.cn)if("F"===e.on)e.cn=vt(e.path,e.collectionGroup,jn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=jn(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new fr(o.field,s))}var u=e.endAt?new sr(e.endAt.position,!e.endAt.before):null,a=e.startAt?new sr(e.startAt.position,!e.startAt.before):null;e.cn=vt(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function Bn(t,e,n){return new Rn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zn(t,e){return new Rn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Qn(t,e){return new Rn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Kn(t,e){return gt(Gn(t),Gn(e))&&t.on===e.on}function Wn(t){return yt(Gn(t))+"|lt:"+t.on}function Hn(t){return"Query(target="+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.R()+" "+e.op+" "+oe(e.value);var e})).join(", ")+"]"),ht(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.R()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ur(t.startAt)),t.endAt&&(e+=", endAt: "+ur(t.endAt)),"Target("+e+")"}(Gn(t))+"; limitType="+t.on+")"}function Yn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):D.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ar(t.startAt,jn(t),e)||t.endAt&&ar(t.endAt,jn(t),e))}(t,e)}function Xn(t){return function(e,n){for(var r=!1,i=0,o=jn(t);i<o.length;i++){var s=o[i],u=lr(s,e,n);if(0!==u)return u;r=r||s.field.p()}return 0}}var $n=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return r.__extends(e,t),e.create=function(t,n,r){if(t.p())return"in"===n||"not-in"===n?this.hn(t,n,r):new Jn(t,n,r);if(le(r)){if("=="!==n&&"!="!==n)throw new l(a.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new e(t,n,r)}if(pe(r)){if("=="!==n&&"!="!==n)throw new l(a.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new e(t,n,r)}return"array-contains"===n?new rr(t,r):"in"===n?new tr(t,r):"not-in"===n?new ir(t,r):"array-contains-any"===n?new or(t,r):new e(t,n,r)},e.hn=function(t,e,n){return"in"===e?new Zn(t,n):new er(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(re(e,this.value)):null!==e&&te(this.value)===te(e)&&this.ln(re(e,this.value))},e.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return _()}},e.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Jn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=D.C(r.referenceValue),i}return r.__extends(e,t),e.prototype.matches=function(t){var e=D.i(t.key,this.key);return this.ln(e)},e}($n),Zn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=nr("in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}($n),er=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=nr("not-in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}($n);function nr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return D.C(t.referenceValue)}))}var rr=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return fe(e)&&ne(e.arrayValue,this.value)},e}($n),tr=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ne(this.value.arrayValue,e)},e}($n),ir=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){if(ne(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ne(this.value.arrayValue,e)},e}($n),or=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!fe(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ne(e.value.arrayValue,t)}))},e}($n),sr=function(t,e){this.position=t,this.before=e};function ur(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return oe(t)})).join(",")}function ar(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.p()?D.i(D.C(s.referenceValue),n.key):re(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function cr(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ee(t.position[n],e.position[n]))return!1;return!0}var fr=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function lr(t,e,n){var r=t.field.p()?D.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?re(r,i):_()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _()}}function pr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var hr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},dr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.An=function(){this.Tn=this.mn},t.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&y("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,(function(){return e.In=Date.now(),t()})),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},t.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},t}(),vr=function(){function t(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t((function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)}),(function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Sn&&_(),this.Sn=!0,this.vn?this.error?this.Dn(n,this.error):this.Cn(e,this.result):new t((function(t,i){r.pn=function(n){r.Cn(e,n).next(t,i)},r.bn=function(e){r.Dn(n,e).next(t,i)}}))},t.prototype.Nn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Dn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.$n=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.xn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},t}(),yr=function(){function e(t,n,i){this.name=t,this.version=n,this.kn=i,12.2===e.Mn(h.getUA())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return y("SimpleDb","Removing database:",t),Er(window.indexedDB.deleteDatabase(t)).Nn()},e.On=function(){if("undefined"==typeof indexedDB)return!1;if(e.Ln())return!0;var t=h.getUA(),n=e.Mn(t),i=0<n&&n<10,r=e.Bn(t),s=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||s)},e.Ln=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.qn)},e.Un=function(t,e){return t.store(e)},e.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Bn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Qn=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:return this.db?[3,2]:(y("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,n){var r=indexedDB.open(e.name,e.version);r.onsuccess=function(e){var n=e.target.result;t(n)},r.onblocked=function(){n(new mr("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){var e=t.target.error;"VersionError"===e.name?n(new l(a.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new mr(e))},r.onupgradeneeded=function(t){y("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;e.kn.createOrUpgrade(n,r.transaction,t.oldVersion,e.version).next((function(){y("SimpleDb","Database upgrade to version "+e.version+" complete")}))}}))]);case 1:t.db=n.sent(),n.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return e.Wn(t)}),this.db)]}}))}))},e.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a;return r.__generator(this,(function(c){switch(c.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,a,c,h;return r.__generator(this,(function(r){switch(r.label){case 0:++o,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,u.Qn()];case 2:return u.db=r.sent(),t=_r.open(u.db,i?"readonly":"readwrite",e),s=n(t).catch((function(e){return t.abort(e),vr.reject(e)})).Nn(),a={},s.catch((function(){})),[4,t.Kn];case 3:return[2,(a.value=(r.sent(),s),a)];case 4:return c=r.sent(),h="FirebaseError"!==c.name&&o<3,y("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),gr=function(){function t(t){this.Gn=t,this.zn=!1,this.Hn=null}return Object.defineProperty(t.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.zn=!0},t.prototype.Jn=function(t){this.Hn=t},t.prototype.delete=function(){return Er(this.Gn.delete())},t}(),mr=function(t){function e(e){var n=this;return(n=t.call(this,a.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return r.__extends(e,t),e}(l);function wr(t){return"IndexedDbTransactionError"===t.name}var _r=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.Xn=new hr,this.transaction.oncomplete=function(){e.Xn.resolve()},this.transaction.onabort=function(){t.error?e.Xn.reject(new mr(t.error)):e.Xn.resolve()},this.transaction.onerror=function(t){var n=br(t.target.error);e.Xn.reject(new mr(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new mr(e)}},Object.defineProperty(t.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(y("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ir(e)},t}(),Ir=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(y("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(y("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Er(n)},t.prototype.add=function(t){return y("SimpleDb","ADD",this.store.name,t,t),Er(this.store.add(t))},t.prototype.get=function(t){var e=this;return Er(this.store.get(t)).next((function(n){return void 0===n&&(n=null),y("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return y("SimpleDb","DELETE",this.store.name,t),Er(this.store.delete(t))},t.prototype.count=function(){return y("SimpleDb","COUNT",this.store.name),Er(this.store.count())},t.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.es=function(t,e){y("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,(function(t,e,n){return n.delete()}))},t.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},t.prototype.rs=function(t){var e=this.cursor({});return new vr((function(n,r){e.onerror=function(t){var e=br(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.ts=function(t,e){var n=[];return new vr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new gr(i),s=e(i.primaryKey,i.value,o);if(s instanceof vr){var u=s.catch((function(t){return o.done(),vr.reject(t)}));n.push(u)}o.vn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return vr.$n(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Er(t){return new vr((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=br(t.target.error);n(e)}}))}var Tr=!1;function br(t){var e=yr.Mn(h.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var i=new l("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Tr||(Tr=!0,setTimeout((function(){throw i}),0)),i}}return t}function Ar(){return"undefined"!=typeof window?window:null}function Nr(){return"undefined"!=typeof document?document:null}var Sr=function(){function t(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new hr,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch((function(t){}))}return t.ls=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this._s=setTimeout((function(){return e.fs()}),t)},t.prototype.Vn=function(){return this.fs()},t.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new l(a.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.fs=function(){var t=this;this.os.ds((function(){return null!==t._s?(t.clearTimeout(),t.op().then((function(e){return t.hs.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},t}(),xr=function(){function t(){var t=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new dr(this,"async_queue_retry"),this.ys=function(){var e=Nr();e&&y("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.gs.yn()};var e=Nr();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),t.prototype.ds=function(t){this.enqueue(t)},t.prototype.ps=function(t){this.bs(),this.vs(t)},t.prototype.Ss=function(){if(!this.Es){this.Es=!0;var t=Nr();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise((function(t){})):this.vs(t)},t.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds((function(){return e.Cs()}))},t.prototype.Cs=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!wr(t=n.sent()))throw t;return y("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.gs.Rn((function(){return e.Cs()})),n.label=5;case 5:return[2]}}))}))},t.prototype.vs=function(t){var e=this,n=this.ws.then((function(){return e.Rs=!0,t().catch((function(t){throw e.As=t,e.Rs=!1,p("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Rs=!1,t}))}));return this.ws=n,n},t.prototype.gn=function(t,e,n){var r=this;this.bs(),this.Ps.indexOf(t)>-1&&(e=0);var i=Sr.ls(this,t,e,n,(function(t){return r.Ns(t)}));return this.Is.push(i),i},t.prototype.bs=function(){this.As&&_()},t.prototype.Fs=function(){},t.prototype.$s=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.ws];case 1:e.sent(),e.label=2;case 2:if(t!==this.ws)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},t.prototype.ks=function(t){var e=this;return this.$s().then((function(){e.Is.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.Is;n<r.length;n++){var i=r[n];if(i.Vn(),"all"!==t&&i.fn===t)break}return e.$s()}))},t.prototype.Ms=function(t){this.Ps.push(t)},t.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},t}();function Dr(t,e){if(p("AsyncQueue",e+": "+t),wr(t))return new l(a.UNAVAILABLE,e+": "+t);throw t}var kr=function(){this.Os=void 0,this.listeners=[]},Or=function(){this.Ls=new ut((function(t){return Wn(t)}),Kn),this.onlineState="Unknown",this.Bs=new Set};function Lr(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c;return r.__generator(this,(function(r){switch(r.label){case 0:if(n=I(t),i=e.query,o=!1,(s=n.Ls.get(i))||(o=!0,s=new kr),!o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),u=s,[4,n.qs(i)];case 2:return u.Os=r.sent(),[3,4];case 3:return a=r.sent(),c=Dr(a,"Initialization of query '"+Hn(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.Ls.set(i,s),s.listeners.push(e),e.Us(n.onlineState),s.Os&&e.Qs(s.Os)&&Ur(n),[2]}}))}))}function Rr(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u;return r.__generator(this,(function(r){return n=I(t),i=e.query,o=!1,(s=n.Ls.get(i))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),o?[2,(n.Ls.delete(i),n.Ws(i))]:[2]}))}))}function Cr(t,e){for(var n=I(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.Ls.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Os=s}}r&&Ur(n)}function Pr(t,e,n){var r=I(t),i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}function Ur(t){t.Bs.forEach((function(t){t.next()}))}var Vr=function(){function t(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new jt(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},t.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},t.prototype.zs=function(t){if(t.docChanges.length>0)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=jt.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},t}(),Mr=function(){function t(t){this.uid=t}return t.prototype.Xs=function(){return null!=this.uid},t.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Mr.UNAUTHENTICATED=new Mr(null),Mr.ti=new Mr("google-credentials-uid"),Mr.ei=new Mr("first-party-uid");var Fr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}return t.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},t}();function qr(t,e){return"firestore_clients_"+t+"_"+e}function jr(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Xs()&&(r+="_"+e.uid),r}function Gr(t,e){return"firestore_targets_"+t+"_"+e}Fr.oi=-1;var Br=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ai=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new l(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(p("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),zr=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ai=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new l(r.error.code,r.error.message)),i?new t(e,r.state,o):(p("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Qr=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ai=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Mt(),s=0;i&&s<r.activeTargetIds.length;++s)i=lt(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(p("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Kr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ai=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(p("SharedClientState","Failed to parse online state: "+e),null)},t}(),Wr=function(){function t(){this.activeTargetIds=Mt()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Hr=function(){function t(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new Tt($),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=qr(this.persistenceKey,this.li),this.Ai=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.mi=this.mi.rt(this.li,new Wr),this.Ri=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.di)}return t.On=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n,i,o,s,u,a,c,h,f,l=this;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._i.Vi()];case 1:for(t=r.sent(),e=0,n=t;e<n.length;e++)(i=n[e])!==this.li&&(o=this.getItem(qr(this.persistenceKey,i)))&&(s=Qr.ai(i,o))&&(this.mi=this.mi.rt(s.clientId,s));for(this.pi(),(u=this.storage.getItem(this.yi))&&(a=this.bi(u))&&this.vi(a),c=0,h=this.Ei;c<h.length;c++)f=h[c],this.wi(f);return this.Ei=[],this.window.addEventListener("unload",(function(){return l.Si()})),this.Ti=!0,[2]}}))}))},t.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},t.prototype.Di=function(){return this.Ci(this.mi)},t.prototype.Ni=function(t){var e=!1;return this.mi.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Fi=function(t){this.$i(t,"pending")},t.prototype.xi=function(t,e,n){this.$i(t,e,n),this.ki(t)},t.prototype.Mi=function(t){var e="not-current";if(this.Ni(t)){var n=this.storage.getItem(Gr(this.persistenceKey,t));if(n){var r=zr.ai(t,n);r&&(e=r.state)}}return this.Oi.ui(t),this.pi(),e},t.prototype.Li=function(t){this.Oi.hi(t),this.pi()},t.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},t.prototype.qi=function(t){this.removeItem(Gr(this.persistenceKey,t))},t.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.ki(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},t.prototype.ji=function(t){this.Ki(t)},t.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return y("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){y("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){y("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wi=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(y("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ii)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds((function(){return r.__awaiter(e,void 0,void 0,(function(){var t,e,i,o,s,u;return r.__generator(this,(function(r){if(this.Ti){if(null!==n.key)if(this.Ri.test(n.key)){if(null==n.newValue)return t=this.Gi(n.key),[2,this.zi(t,null)];if(e=this.Hi(n.key,n.newValue))return[2,this.zi(e.clientId,e)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(i=this.Yi(n.key,n.newValue)))return[2,this.Ji(i)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(o=this.Xi(n.key,n.newValue)))return[2,this.Zi(o)]}else if(n.key===this.yi){if(null!==n.newValue&&(s=this.bi(n.newValue)))return[2,this.vi(s)]}else n.key===this.Ai&&(u=function(t){var e=Fr.oi;if(null!=t)try{var n=JSON.parse(t);g("number"==typeof n),e=n}catch(t){p("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Fr.oi&&this.ni(u)}else this.Ei.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),t.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},t.prototype.$i=function(t,e,n){var r=new Br(this.currentUser,t,e,n),i=jr(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.ki=function(t){var e=jr(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ki=function(t){var e={clientId:this.li,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},t.prototype.Qi=function(t,e,n){var r=Gr(this.persistenceKey,t),i=new zr(t,e,n);this.setItem(r,i.ci())},t.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},t.prototype.Hi=function(t,e){var n=this.Gi(t);return Qr.ai(n,e)},t.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Br.ai(new Mr(i),r,e)},t.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return zr.ai(r,e)},t.prototype.bi=function(t){return Kr.ai(t)},t.prototype.Ji=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._i.tr(t.batchId,t.state,t.error)]:(y("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},t.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this._i.nr(s,u).then((function(){n.mi=r}))},t.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},t.prototype.Ci=function(t){var e=Mt();return t.forEach((function(t,n){e=e.xt(n.activeTargetIds)})),e},t}(),Yr=function(){function t(){this.sr=new Wr,this.ir={},this.fi=null,this.ni=null}return t.prototype.Fi=function(t){},t.prototype.xi=function(t,e,n){},t.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},t.prototype.Ui=function(t,e,n){this.ir[t]=e},t.prototype.Li=function(t){this.sr.hi(t)},t.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.qi=function(t){delete this.ir[t]},t.prototype.Di=function(){return this.sr.activeTargetIds},t.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.start=function(){return this.sr=new Wr,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Si=function(){},t.prototype.ri=function(t){},t}(),Xr=function(){function t(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}return t.prototype.ar=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=pn(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=dn(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=dn(a,e,o,this.rr))}return e},t.prototype.hr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ut())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&J(this.mutations,t.mutations,(function(t,e){return yn(t,e)}))&&J(this.baseMutations,t.baseMutations,(function(t,e){return yn(t,e)}))},t}(),$r=function(){function t(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}return t.from=function(e,n,r){g(e.mutations.length===r.length);for(var i=Ct,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Jr=function(){function t(){this.dr=new ut((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.wr=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},t.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},t.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?vr.resolve(n):this.Rr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},t.prototype.Er=function(){},t}(),Zr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ti=function(){function t(){this.yr=[]}return t.prototype.Vr=function(t){this.yr.push(t)},t.prototype.pr=function(){this.yr.forEach((function(t){return t()}))},t}(),ei=function(){function t(t,e,n){this.br=t,this.vr=e,this.Sr=n}return t.prototype.Dr=function(t,e){var n=this;return this.vr.Cr(t,e).next((function(r){return n.Nr(t,e,r)}))},t.prototype.Nr=function(t,e,n){return this.br.Ar(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.Fr=function(t,e,n){var r=Ot();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.rt(t,e)})),r},t.prototype.$r=function(t,e){var n=this;return this.br.getEntries(t,e).next((function(e){return n.kr(t,e)}))},t.prototype.kr=function(t,e){var n=this;return this.vr.Mr(t,e).next((function(r){var i=n.Fr(t,e,r),o=kt();return i.forEach((function(t,e){e||(e=new On(t,ct.min())),o=o.rt(t,e)})),o}))},t.prototype.Or=function(t,e,n){return function(t){return D.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Lr(t,e.path):qn(e)?this.Br(t,e,n):this.qr(t,e,n)},t.prototype.Lr=function(t,e){return this.Dr(t,new D(e)).next((function(t){var e=Rt();return t instanceof kn&&(e=e.rt(t.key,t)),e}))},t.prototype.Br=function(t,e,n){var r=this,i=e.collectionGroup,o=Rt();return this.Sr.Ur(t,i).next((function(s){return vr.forEach(s,(function(s){var u=function(t,e){return new Rn(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(e,s.child(i));return r.qr(t,u,n).next((function(t){t.forEach((function(t,e){o=o.rt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.qr=function(t,e,n){var r,i,o=this;return this.br.Or(t,e,n).next((function(n){return r=n,o.vr.Qr(t,e)})).next((function(e){return i=e,o.Wr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=dn(a,h,h,o.rr);r=f instanceof kn?r.rt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Yn(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=Ut(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof wn&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof kn&&(c=c.rt(t,e))})),c}))},t}(),ni=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}return t.Gr=function(e,n){for(var r=Ut(),i=Ut(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function ri(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=$(n,i);return 0===s?$(r,o):s}var ii=function(){function t(t){this.zr=t,this.buffer=new St(ri),this.Hr=0}return t.prototype.Yr=function(){return++this.Hr},t.prototype.Jr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.zr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ri(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),oi={Xr:!1,Zr:0,eo:0,no:0},si=function(){function t(t,e,n){this.so=t,this.io=e,this.ro=n}return t.oo=function(e){return new t(e,t.ao,t.co)},t}();si.uo=-1,si.ho=1048576,si.lo=41943040,si.ao=10,si.co=1e3,si._o=new si(si.lo,si.ao,si.co),si.fo=new si(si.uo,0,0);var ui=function(){function t(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}return t.prototype.start=function(t){this.do.params.so!==si.uo&&this.To(t)},t.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(t.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),t.prototype.To=function(t){var e=this,n=this.wo?3e5:6e4;y("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.mo=this.os.gn("lru_garbage_collection",n,(function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:this.mo=null,this.wo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Eo(this.do)];case 2:return n.sent(),[3,7];case 3:return wr(e=n.sent())?(y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,To(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.To(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),ai=function(){function t(t,e){this.Io=t,this.params=e}return t.prototype.Ao=function(t,e){return this.Io.Ro(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Po=function(t,e){var n=this;if(0===e)return vr.resolve(Fr.oi);var r=new ii(e);return this.Io.De(t,(function(t){return r.Jr(t.sequenceNumber)})).next((function(){return n.Io.yo(t,(function(t){return r.Jr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},t.prototype.po=function(t,e){return this.Io.po(t,e)},t.prototype.bo=function(t,e){var n=this;return this.params.so===si.uo?(y("LruGarbageCollector","Garbage collection skipped; disabled"),vr.resolve(oi)):this.vo(t).next((function(r){return r<n.params.so?(y("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.so),oi):n.So(t,e)}))},t.prototype.vo=function(t){return this.Io.vo(t)},t.prototype.So=function(t,e){var n,i,r,s,u,a,o,h=this,p=Date.now();return this.Ao(t,this.params.io).next((function(e){return e>h.params.ro?(y("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ro+" from "+e),i=h.params.ro):i=e,s=Date.now(),h.Po(t,i)})).next((function(r){return n=r,u=Date.now(),h.Vo(t,n,e)})).next((function(e){return r=e,a=Date.now(),h.po(t,n)})).next((function(t){return o=Date.now(),v()<=c.LogLevel.DEBUG&&y("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-p)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+r+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(o-a)+"ms\nTotal Duration: "+(o-p)+"ms"),vr.resolve({Xr:!0,Zr:i,eo:r,no:t})}))},t}();function ci(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=fi(e)),e=hi(t.get(n),e);return fi(e)}function hi(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function fi(t){return t+""}function pi(t){var e=t.length;if(g(e>=2),2===e)return g(""===t.charAt(0)&&""===t.charAt(1)),N.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&_(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:_()}o=s+2}return new N(r)}var di=function(t){this.Do=t};function vi(t,e){if(e.document)return function(t,e,n){var r=xe(t,e.name),i=Te(e.updateTime),o=new Nn({mapValue:{fields:e.fields}});return new kn(r,i,o,{hasCommittedMutations:!!n})}(t.Do,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=D.$(e.noDocument.path),r=wi(e.noDocument.readTime);return new On(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=D.$(e.unknownDocument.path),o=wi(e.unknownDocument.version);return new Ln(i,o)}return _()}function li(t,e,n){var r=yi(n),i=e.key.path.h().A();if(e instanceof kn){var o=function(t,e){return{name:Se(t,e.key),fields:e.sn().mapValue.fields,updateTime:_e(t,e.version.X())}}(t.Do,e),s=e.hasCommittedMutations;return new zi(null,null,o,s,r,i)}if(e instanceof On){var u=e.key.path.A(),a=mi(e.version),c=e.hasCommittedMutations;return new zi(null,new Gi(u,a),null,c,r,i)}if(e instanceof Ln){var h=e.key.path.A(),f=mi(e.version);return new zi(new Bi(h,f),null,null,!0,r,i)}return _()}function yi(t){var e=t.X();return[e.seconds,e.nanoseconds]}function gi(t){var e=new at(t[0],t[1]);return ct.Y(e)}function mi(t){var e=t.X();return new Vi(e.seconds,e.nanoseconds)}function wi(t){var e=new at(t.seconds,t.nanoseconds);return ct.Y(e)}function bi(t,e){var n=(e.baseMutations||[]).map((function(e){return Pe(t.Do,e)})),r=e.mutations.map((function(e){return Pe(t.Do,e)})),i=at.fromMillis(e.localWriteTimeMs);return new Xr(e.batchId,i,n,r)}function _i(t){var e,n,r=wi(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?wi(t.lastLimboFreeSnapshotVersion):ct.min();return void 0!==t.query.documents?(g(1===(n=t.query).documents.length),e=Gn(Pn(ke(n.documents[0])))):e=function(t){var e=ke(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){g(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[Qe(e)]:void 0!==e.fieldFilter?[ze(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):_():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new fr(Be(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return ht(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Fe(n.startAt));var h=null;return n.endAt&&(h=Fe(n.endAt)),Gn(Cn(e,i,u,s,a,"F",c,h))}(t.query),new bt(e,t.targetId,0,t.lastListenSequenceNumber,r,i,tt.fromBase64String(t.resumeToken))}function Ii(t,e){var n,r=mi(e.et),i=mi(e.lastLimboFreeSnapshotVersion);n=dt(e.target)?Ue(t.Do,e.target):Ve(t.Do,e.target);var o=e.resumeToken.toBase64();return new Ki(e.targetId,yt(e.target),r,o,e.sequenceNumber,i,n)}var Ei=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}return t.Fo=function(e,n,r,i){return g(""!==e.uid),new t(e.Xs()?e.uid:"",n,r,i)},t.prototype.$o=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ni(t).ss({index:qi.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.xo=function(t,e,n,r){var i=this,o=Si(t),s=Ni(t);return s.add({}).next((function(u){g("number"==typeof u);for(var a=new Xr(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ce(t.Do,e)})),i=n.mutations.map((function(e){return Ce(t.Do,e)}));return new qi(e,n.batchId,n.rr.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new St((function(t,e){return $(t.R(),e.R())})),l=0,p=r;l<p.length;l++){var d=p[l],v=ji.key(i.userId,d.key.path,u);f=f.add(d.key.path.h()),h.push(s.put(c)),h.push(o.put(v,ji.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Sr.ko(t,e))})),t.Vr((function(){i.No[u]=a.keys()})),vr.$n(h).next((function(){return a}))}))},t.prototype.Mo=function(t,e){var n=this;return Ni(t).get(e).next((function(t){return t?(g(t.userId===n.userId),bi(n.serializer,t)):null}))},t.prototype.Oo=function(t,e){var n=this;return this.No[e]?vr.resolve(this.No[e]):this.Mo(t,e).next((function(t){if(t){var r=t.keys();return n.No[e]=r,r}return null}))},t.prototype.Lo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ni(t).ss({index:qi.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(g(e.batchId>=r),o=bi(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ni(t).ss({index:qi.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ni(t).Zn(qi.userMutationsIndex,n).next((function(t){return t.map((function(t){return bi(e.serializer,t)}))}))},t.prototype.Cr=function(t,e){var n=this,r=ji.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Si(t).ss({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=pi(a);if(u===n.userId&&e.path.isEqual(h))return Ni(t).get(c).next((function(t){if(!t)throw _();g(t.userId===n.userId),o.push(bi(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.Mr=function(t,e){var n=this,r=new St($),i=[];return e.forEach((function(e){var o=ji.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Si(t).ss({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=pi(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),vr.$n(i).next((function(){return n.Uo(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=ji.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new St($);return Si(t).ss({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=pi(a);s===n.userId&&r.T(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Uo(t,u)}))},t.prototype.Uo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ni(t).get(e).next((function(t){if(null===t)throw _();g(t.userId===n.userId),r.push(bi(n.serializer,t))})))})),vr.$n(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return Ai(t.Wo,this.userId,e).next((function(r){return t.Vr((function(){n.jo(e.batchId)})),vr.forEach(r,(function(e){return n.Co.Ko(t,e)}))}))},t.prototype.jo=function(t){delete this.No[t]},t.prototype.Go=function(t){var e=this;return this.$o(t).next((function(n){if(!n)return vr.resolve();var r=IDBKeyRange.lowerBound(ji.prefixForUser(e.userId)),i=[];return Si(t).ss({range:r},(function(t,n,r){if(t[0]===e.userId){var o=pi(t[1]);i.push(o)}else r.done()})).next((function(){g(0===i.length)}))}))},t.prototype.zo=function(t,e){return Ti(t,this.userId,e)},t.prototype.Ho=function(t){var e=this;return xi(t).get(this.userId).next((function(t){return t||new Fi(e.userId,-1,"")}))},t}();function Ti(t,e,n){var r=ji.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Si(t).ss({range:o,ns:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function Ai(t,e,n){var r=t.store(qi.store),i=t.store(ji.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ss({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){g(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ji.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return vr.$n(o).next((function(){return c}))}function Ni(t){return ao.Un(t,qi.store)}function Si(t){return ao.Un(t,ji.store)}function xi(t){return ao.Un(t,Fi.store)}var Di=function(){function t(t,e){this.serializer=t,this.Sr=e}return t.prototype.Tr=function(t,e,n){return Oi(t).put(Li(e),n)},t.prototype.Ir=function(t,e){var n=Oi(t),r=Li(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Ar=function(t,e){var n=this;return Oi(t).get(Li(e)).next((function(t){return n.Jo(t)}))},t.prototype.Xo=function(t,e){var n=this;return Oi(t).get(Li(e)).next((function(t){var e=n.Jo(t);return e?{Zo:e,size:Ri(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ot();return this.ta(t,e,(function(t,e){var i=n.Jo(e);r=r.rt(t,i)})).next((function(){return r}))},t.prototype.ea=function(t,e){var n=this,r=Ot(),i=new Tt(D.i);return this.ta(t,e,(function(t,e){var o=n.Jo(e);o?(r=r.rt(t,o),i=i.rt(t,Ri(e))):(r=r.rt(t,null),i=i.rt(t,0))})).next((function(){return{na:r,sa:i}}))},t.prototype.ta=function(t,e,n){if(e.m())return vr.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e.lt(),o=i.Et();return Oi(t).ss({range:r},(function(t,e,r){for(var s=D.$(t);o&&D.i(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.It()?i.Et():null}))},t.prototype.Or=function(t,e,n){var r=this,i=Rt(),o=e.path.length+1,s={};if(n.isEqual(ct.min())){var u=e.path.A();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.A(),c=yi(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=zi.collectionReadTimeIndex}return Oi(t).ss(s,(function(t,n,s){if(t.length===o){var u=vi(r.serializer,n);e.path.T(u.key.path)?u instanceof kn&&Yn(e,u)&&(i=i.rt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.ia=function(t,e){var n=this,r=kt(),i=yi(e),o=Oi(t),s=IDBKeyRange.lowerBound(i,!0);return o.ss({index:zi.readTimeIndex,range:s},(function(t,e){var o=vi(n.serializer,e);r=r.rt(o.key,o),i=e.readTime})).next((function(){return{ra:r,readTime:gi(i)}}))},t.prototype.oa=function(t){var e=Oi(t),n=ct.min();return e.ss({index:zi.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=gi(e.readTime)),r.done()})).next((function(){return n}))},t.prototype.aa=function(e){return new t.ca(this,!!e&&e.ua)},t.prototype.ha=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ki(t).get(Qi.key).next((function(t){return g(!!t),t}))},t.prototype.Yo=function(t,e){return ki(t).put(Qi.key,e)},t.prototype.Jo=function(t){if(t){var e=vi(this.serializer,t);return e instanceof On&&e.version.isEqual(ct.min())?null:e}return null},t}();function ki(t){return ao.Un(t,Qi.store)}function Oi(t){return ao.Un(t,zi.store)}function Li(t){return t.path.A()}function Ri(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _();e=t.noDocument}return JSON.stringify(e).length}Di.ca=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).la=e,r.ua=n,r._a=new ut((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return r.__extends(e,t),e.prototype.gr=function(t){var e=this,n=[],r=0,i=new St((function(t,e){return $(t.R(),e.R())}));return this.dr.forEach((function(o,s){var u=e._a.get(o);if(s){var a=li(e.la.serializer,s,e.readTime);i=i.add(o.path.h());var c=Ri(a);r+=c-u,n.push(e.la.Tr(t,o,a))}else if(r-=u,e.ua){var h=li(e.la.serializer,new On(o,ct.min()),e.readTime);n.push(e.la.Tr(t,o,h))}else n.push(e.la.Ir(t,o))})),i.forEach((function(r){n.push(e.la.Sr.ko(t,r))})),n.push(this.la.updateMetadata(t,r)),vr.$n(n)},e.prototype.Rr=function(t,e){var n=this;return this.la.Xo(t,e).next((function(t){return null===t?(n._a.set(e,0),null):(n._a.set(e,t.size),t.Zo)}))},e.prototype.Pr=function(t,e){var n=this;return this.la.ea(t,e).next((function(t){var e=t.na;return t.sa.forEach((function(t,e){n._a.set(t,e)})),e}))},e}(Jr);var Ci=function(){function t(){this.fa=new Pi}return t.prototype.ko=function(t,e){return this.fa.add(e),vr.resolve()},t.prototype.Ur=function(t,e){return vr.resolve(this.fa.getEntries(e))},t}(),Pi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new St(N.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new St(N.i)).A()},t}(),Ui=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;g(n<r&&n>=0&&r<=10);var o=new _r(e);n<1&&r>=1&&(function(t){t.createObjectStore(Mi.store)}(t),function(t){t.createObjectStore(Fi.store,{keyPath:Fi.keyPath}),t.createObjectStore(qi.store,{keyPath:qi.keyPath,autoIncrement:!0}).createIndex(qi.userMutationsIndex,qi.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ji.store)}(t),Xi(t),function(t){t.createObjectStore(zi.store)}(t));var s=vr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Wi.store),t.deleteObjectStore(Ki.store),t.deleteObjectStore(Hi.store)}(t),Xi(t)),s=s.next((function(){return function(t){var e=t.store(Hi.store),n=new Hi(0,0,ct.min().X(),0);return e.put(Hi.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(qi.store).Zn().next((function(n){t.deleteObjectStore(qi.store),t.createObjectStore(qi.store,{keyPath:qi.keyPath,autoIncrement:!0}).createIndex(qi.userMutationsIndex,qi.userMutationsKeyPath,{unique:!0});var r=e.store(qi.store),i=n.map((function(t){return r.put(t)}));return vr.$n(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore($i.store,{keyPath:$i.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Qi.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(zi.store);e.createIndex(zi.readTimeIndex,zi.readTimeIndexPath,{unique:!1}),e.createIndex(zi.collectionReadTimeIndex,zi.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(zi.store).ss((function(t,n){e+=Ri(n)})).next((function(){var n=new Qi(e);return t.store(Qi.store).put(Qi.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Fi.store),r=t.store(qi.store);return n.Zn().next((function(n){return vr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Zn(qi.userMutationsIndex,i).next((function(r){return vr.forEach(r,(function(r){g(r.userId===n.userId);var i=bi(e.serializer,r);return Ai(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Wi.store),n=t.store(zi.store);return t.store(Hi.store).get(Hi.key).next((function(t){var r=[];return n.ss((function(n,i){var o=new N(n),s=function(t){return[0,ci(t)]}(o);r.push(e.get(s).next((function(n){return n?vr.resolve():function(n){return e.put(new Wi(0,ci(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return vr.$n(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Yi.store,{keyPath:Yi.keyPath});var n=e.store(Yi.store),r=new Pi,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:ci(i)})}};return e.store(zi.store).ss({ns:!0},(function(t,e){var n=new N(t);return i(n.h())})).next((function(){return e.store(ji.store).ss({ns:!0},(function(t,e){t[0];var n=t[1],r=(t[2],pi(n));return i(r.h())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Ki.store);return n.ss((function(t,r){var i=_i(r),o=Ii(e.serializer,i);return n.put(o)}))},t}(),Vi=function(t,e){this.seconds=t,this.nanoseconds=e},Mi=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Mi.store="owner",Mi.key="owner";var Fi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fi.store="mutationQueues",Fi.keyPath="userId";var qi=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};qi.store="mutations",qi.keyPath="batchId",qi.userMutationsIndex="userMutationsIndex",qi.userMutationsKeyPath=["userId","batchId"];var ji=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ci(e)]},t.key=function(t,e,n){return[t,ci(e),n]},t}();ji.store="documentMutations",ji.PLACEHOLDER=new ji;var Gi=function(t,e){this.path=t,this.readTime=e},Bi=function(t,e){this.path=t,this.version=e},zi=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zi.store="remoteDocuments",zi.readTimeIndex="readTimeIndex",zi.readTimeIndexPath="readTime",zi.collectionReadTimeIndex="collectionReadTimeIndex",zi.collectionReadTimeIndexPath=["parentPath","readTime"];var Qi=function(t){this.byteSize=t};Qi.store="remoteDocumentGlobal",Qi.key="remoteDocumentGlobalKey";var Ki=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ki.store="targets",Ki.keyPath="targetId",Ki.queryTargetsIndexName="queryTargetsIndex",Ki.queryTargetsKeyPath=["canonicalId","targetId"];var Wi=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Wi.store="targetDocuments",Wi.keyPath=["targetId","path"],Wi.documentTargetsIndex="documentTargetsIndex",Wi.documentTargetsKeyPath=["path","targetId"];var Hi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Hi.key="targetGlobalKey",Hi.store="targetGlobal";var Yi=function(t,e){this.collectionId=t,this.parent=e};function Xi(t){t.createObjectStore(Wi.store,{keyPath:Wi.keyPath}).createIndex(Wi.documentTargetsIndex,Wi.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ki.store,{keyPath:Ki.keyPath}).createIndex(Ki.queryTargetsIndexName,Ki.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Hi.store)}Yi.store="collectionParents",Yi.keyPath=["collectionId","parent"];var $i=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};$i.store="clientMetadata",$i.keyPath="clientId";var Ji=r.__spreadArrays(r.__spreadArrays(r.__spreadArrays([Fi.store,qi.store,ji.store,zi.store,Ki.store,Mi.store,Hi.store,Wi.store],[$i.store]),[Qi.store]),[Yi.store]),Zi=function(){function t(){this.da=new Pi}return t.prototype.ko=function(t,e){var n=this;if(!this.da.has(e)){var r=e._(),i=e.h();t.Vr((function(){n.da.add(e)}));var o={collectionId:r,parent:ci(i)};return to(t).put(o)}return vr.resolve()},t.prototype.Ur=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Z(e),""],!1,!0);return to(t).Zn(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(pi(o.parent))}return n}))},t}();function to(t){return ao.Un(t,Yi.store)}var eo=function(){function t(t){this.wa=t}return t.prototype.next=function(){return this.wa+=2,this.wa},t.ma=function(){return new t(0)},t.Ta=function(){return new t(-1)},t}(),no=function(){function t(t,e){this.Co=t,this.serializer=e}return t.prototype.Ea=function(t){var e=this;return this.Ia(t).next((function(n){var r=new eo(n.highestTargetId);return n.highestTargetId=r.next(),e.Aa(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ra=function(t){return this.Ia(t).next((function(t){return ct.Y(new at(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Pa=function(t){return this.Ia(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.ga=function(t,e,n){var r=this;return this.Ia(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.X()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Aa(t,i)}))},t.prototype.ya=function(t,e){var n=this;return this.Va(t,e).next((function(){return n.Ia(t).next((function(r){return r.targetCount+=1,n.pa(e,r),n.Aa(t,r)}))}))},t.prototype.ba=function(t,e){return this.Va(t,e)},t.prototype.va=function(t,e){var n=this;return this.Sa(t,e.targetId).next((function(){return ro(t).delete(e.targetId)})).next((function(){return n.Ia(t)})).next((function(e){return g(e.targetCount>0),e.targetCount-=1,n.Aa(t,e)}))},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return ro(t).ss((function(s,u){var a=_i(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.va(t,a)))})).next((function(){return vr.$n(o)})).next((function(){return i}))},t.prototype.De=function(t,e){return ro(t).ss((function(t,n){var r=_i(n);e(r)}))},t.prototype.Ia=function(t){return io(t).get(Hi.key).next((function(t){return g(null!==t),t}))},t.prototype.Aa=function(t,e){return io(t).put(Hi.key,e)},t.prototype.Va=function(t,e){return ro(t).put(Ii(this.serializer,e))},t.prototype.pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Da=function(t){return this.Ia(t).next((function(t){return t.targetCount}))},t.prototype.Ca=function(t,e){var n=yt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return ro(t).ss({range:r,index:Ki.queryTargetsIndexName},(function(t,n,r){var o=_i(n);gt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Na=function(t,e,n){var r=this,i=[],o=oo(t);return e.forEach((function(e){var s=ci(e.path);i.push(o.put(new Wi(n,s))),i.push(r.Co.Fa(t,n,e))})),vr.$n(i)},t.prototype.$a=function(t,e,n){var r=this,i=oo(t);return vr.forEach(e,(function(e){var o=ci(e.path);return vr.$n([i.delete([n,o]),r.Co.xa(t,n,e)])}))},t.prototype.Sa=function(t,e){var n=oo(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ka=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=oo(t),i=Ut();return r.ss({range:n,ns:!0},(function(t,e,n){var r=pi(t[1]),o=new D(r);i=i.add(o)})).next((function(){return i}))},t.prototype.zo=function(t,e){var n=ci(e.path),r=IDBKeyRange.bound([n],[Z(n)],!1,!0),i=0;return oo(t).ss({index:Wi.documentTargetsIndex,ns:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.qe=function(t,e){return ro(t).get(e).next((function(t){return t?_i(t):null}))},t}();function ro(t){return ao.Un(t,Ki.store)}function io(t){return ao.Un(t,Hi.store)}function oo(t){return ao.Un(t,Wi.store)}var so="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",uo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Ma=n,r}return r.__extends(e,t),e}(ti),ao=function(){function t(e,n,r,i,o,s,u,c,h,f){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this._n=o,this.window=s,this.document=u,this.Oa=h,this.La=f,this.Ba=null,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.On())throw new l(a.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Co=new fo(this,i),this.Ga=n+"main",this.serializer=new di(c),this.za=new yr(this.Ga,10,new Ui(this.serializer)),this.Ha=new no(this.Co,this.serializer),this.Sr=new Zi,this.br=new Di(this.serializer,this.Sr),this.window&&this.window.localStorage?this.Ya=this.window.localStorage:(this.Ya=null,!1===f&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Un=function(t,e){if(t instanceof uo)return yr.Un(t.Wo,e);throw _()},t.prototype.start=function(){var t=this;return this.Ja().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new l(a.FAILED_PRECONDITION,so);return t.Xa(),t.Za(),t.tc(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ha.Pa(e)}))})).then((function(e){t.Ba=new Fr(e,t.Oa)})).then((function(){t.qa=!0})).catch((function(e){return t.za&&t.za.close(),Promise.reject(e)}))},t.prototype.ec=function(t){var e=this;return this.Ka=function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.Ti?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.nc=function(t){var e=this;this.za.jn((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.sc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Ti?[4,this.Ja()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Ja=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ho(e).put(new $i(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ic(e).next((function(e){e||(t.isPrimary=!1,t._n.Ds((function(){return t.Ka(!1)})))}))})).next((function(){return t.rc(e)})).next((function(n){return t.isPrimary&&!n?t.oc(e).next((function(){return!1})):!!n&&t.ac(e).next((function(){return!0}))}))})).catch((function(e){if(wr(e))return y("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t._n.Ds((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.ic=function(t){var e=this;return co(t).get(Mi.key).next((function(t){return vr.resolve(e.cc(t))}))},t.prototype.uc=function(t){return ho(t).delete(this.clientId)},t.prototype.hc=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s=this;return r.__generator(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.lc(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Un(e,$i.store);return n.Zn().next((function(t){var e=s._c(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return vr.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=r.sent(),this.Ya)for(n=0,i=e;n<i.length;n++)o=i[n],this.Ya.removeItem(this.fc(o.clientId));r.label=2;case 2:return[2]}}))}))},t.prototype.tc=function(){var t=this;this.Wa=this._n.gn("client_metadata_refresh",4e3,(function(){return t.Ja().then((function(){return t.hc()})).then((function(){return t.tc()}))}))},t.prototype.cc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.rc=function(t){var e=this;return this.La?vr.resolve(!0):co(t).get(Mi.key).next((function(n){if(null!==n&&e.lc(n.leaseTimestampMs,5e3)&&!e.dc(n.ownerId)){if(e.cc(n)&&e.networkEnabled)return!0;if(!e.cc(n)){if(!n.allowTabSynchronization)throw new l(a.FAILED_PRECONDITION,so);return!1}}return!(!e.networkEnabled||!e.inForeground)||ho(t).Zn().next((function(t){return void 0===e._c(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&y("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Si=function(){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(e){switch(e.label){case 0:return this.qa=!1,this.wc(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.mc(),this.Tc(),[4,this.za.runTransaction("readwrite",[Mi.store,$i.store],(function(e){var n=new uo(e,Fr.oi);return t.oc(n).next((function(){return t.uc(n)}))}))];case 1:return e.sent(),this.za.close(),this.Ec(),[2]}}))}))},t.prototype._c=function(t,e){var n=this;return t.filter((function(t){return n.lc(t.updateTimeMs,e)&&!n.dc(t.clientId)}))},t.prototype.Vi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ho(e).Zn().next((function(e){return t._c(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.Ic=function(t){return Ei.Fo(t,this.serializer,this.Sr,this.Co)},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.Pc=function(){return this.Sr},t.prototype.runTransaction=function(t,e,n){var r=this;y("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.za.runTransaction(o,Ji,(function(o){return i=new uo(o,r.Ba?r.Ba.next():Fr.oi),"readwrite-primary"===e?r.ic(i).next((function(t){return!!t||r.rc(i)})).next((function(e){if(!e)throw p("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r._n.Ds((function(){return r.Ka(!1)})),new l(a.FAILED_PRECONDITION,Zr);return n(i)})).next((function(t){return r.ac(i).next((function(){return t}))})):r.gc(i).next((function(){return n(i)}))})).then((function(t){return i.pr(),t}))},t.prototype.gc=function(t){var e=this;return co(t).get(Mi.key).next((function(t){if(null!==t&&e.lc(t.leaseTimestampMs,5e3)&&!e.dc(t.ownerId)&&!e.cc(t)&&!(e.La||e.allowTabSynchronization&&t.allowTabSynchronization))throw new l(a.FAILED_PRECONDITION,so)}))},t.prototype.ac=function(t){var e=new Mi(this.clientId,this.allowTabSynchronization,Date.now());return co(t).put(Mi.key,e)},t.On=function(){return yr.On()},t.prototype.oc=function(t){var e=this,n=co(t);return n.get(Mi.key).next((function(t){return e.cc(t)?(y("IndexedDbPersistence","Releasing primary lease."),n.delete(Mi.key)):vr.resolve()}))},t.prototype.lc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(p("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Xa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qa=function(){t._n.ds((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ja()}))},this.document.addEventListener("visibilitychange",this.Qa),this.inForeground="visible"===this.document.visibilityState)},t.prototype.mc=function(){this.Qa&&(this.document.removeEventListener("visibilitychange",this.Qa),this.Qa=null)},t.prototype.Za=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ua=function(){e.wc(),e._n.ds((function(){return e.Si()}))},this.window.addEventListener("unload",this.Ua))},t.prototype.Tc=function(){this.Ua&&(this.window.removeEventListener("unload",this.Ua),this.Ua=null)},t.prototype.dc=function(t){var e;try{var n=null!==(null===(e=this.Ya)||void 0===e?void 0:e.getItem(this.fc(t)));return y("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return p("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wc=function(){if(this.Ya)try{this.Ya.setItem(this.fc(this.clientId),String(Date.now()))}catch(t){p("Failed to set zombie client id.",t)}},t.prototype.Ec=function(){if(this.Ya)try{this.Ya.removeItem(this.fc(this.clientId))}catch(t){}},t.prototype.fc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function co(t){return ao.Un(t,Mi.store)}function ho(t){return ao.Un(t,$i.store)}var fo=function(){function t(t,e){this.db=t,this.do=new ai(this,e)}return t.prototype.Ro=function(t){var e=this.yc(t);return this.db.Ac().Da(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.yc=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.De=function(t,e){return this.db.Ac().De(t,e)},t.prototype.yo=function(t,e){return this.Vc(t,(function(t,n){return e(n)}))},t.prototype.Fa=function(t,e,n){return lo(t,n)},t.prototype.xa=function(t,e,n){return lo(t,n)},t.prototype.Vo=function(t,e,n){return this.db.Ac().Vo(t,e,n)},t.prototype.Ko=function(t,e){return lo(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return xi(t).rs((function(r){return Ti(t,r,e).next((function(t){return t&&(n=!0),vr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.po=function(t,e){var n=this,r=this.db.Rc().aa(),i=[],o=0;return this.Vc(t,(function(s,u){if(u<=e){var a=n.bc(t,s).next((function(e){if(!e)return o++,r.Ar(t,s).next((function(){return r.Ir(s),oo(t).delete([0,ci(s.path)])}))}));i.push(a)}})).next((function(){return vr.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Ma);return this.db.Ac().ba(t,n)},t.prototype.vc=function(t,e){return lo(t,e)},t.prototype.Vc=function(t,e){var n,r=oo(t),i=Fr.oi;return r.ss({index:Wi.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Fr.oi&&e(new D(pi(n)),i),i=u,n=s):i=Fr.oi})).next((function(){i!==Fr.oi&&e(new D(pi(n)),i)}))},t.prototype.vo=function(t){return this.db.Rc().ha(t)},t}();function lo(t,e){return oo(t).put(function(t,e){return new Wi(0,ci(t.path),e)}(e,t.Ma))}function po(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var vo=function(){function t(t,e,n){this.persistence=t,this.Sc=e,this.Dc=new Tt($),this.Cc=new ut((function(t){return yt(t)}),gt),this.Nc=ct.min(),this.vr=t.Ic(n),this.Fc=t.Rc(),this.Ha=t.Ac(),this.$c=new ei(this.Fc,this.vr,this.persistence.Pc()),this.Sc.xc(this.$c)}return t.prototype.Eo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.bo(n,e.Dc)}))},t}();function yo(t,e){var n=I(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Fc.aa({ua:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=vr.resolve();return o.forEach((function(t){s=s.next((function(){return r.Ar(e,t)})).next((function(e){var o=e,s=n._r.get(t);g(null!==s),(!o||o.version.L(s)<0)&&(o=i.ar(t,o,n))&&r.Tr(o,n.lr)}))})),s.next((function(){return t.vr.Qo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.vr.Go(t)})).next((function(){return n.$c.$r(t,r)}))}))}function go(t){var e=I(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ha.Ra(t)}))}function mo(t,e){var n=I(t),r=e.et,i=n.Dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Fc.aa({ua:!0});i=n.Dc;var s=[];e.Gt.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.Ha.$a(t,e.ne,o).next((function(){return n.Ha.Na(t,e.te,o)})));var a=e.resumeToken;if(a.O()>0){var c=u.st(a,r).nt(t.Ma);i=i.rt(o,c),function(t,e,n){return g(e.resumeToken.O()>0),0===t.resumeToken.O()||e.et.J()-t.et.J()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(u,c,e)&&s.push(n.Ha.ba(t,c))}}}));var u=kt(),a=Ut();if(e.Ht.forEach((function(t,e){a=a.add(t)})),s.push(o.getEntries(t,a).next((function(i){e.Ht.forEach((function(a,c){var h=i.get(a);c instanceof On&&c.version.isEqual(ct.min())?(o.Ir(a,r),u=u.rt(a,c)):null==h||c.version.L(h.version)>0||0===c.version.L(h.version)&&h.hasPendingWrites?(o.Tr(c,r),u=u.rt(a,c)):y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Yt.has(a)&&s.push(n.persistence.Co.vc(t,a))}))}))),!r.isEqual(ct.min())){var c=n.Ha.Ra(t).next((function(e){return n.Ha.ga(t,t.Ma,r)}));s.push(c)}return vr.$n(s).next((function(){return o.apply(t)})).next((function(){return n.$c.kr(t,u)}))})).then((function(t){return n.Dc=i,t}))}function wo(t,e){var n=I(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.vr.Lo(t,e)}))}function bo(t,e){var n=I(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ha.Ca(t,e).next((function(i){return i?(r=i,vr.resolve(r)):n.Ha.Ea(t).next((function(i){return r=new bt(e,i,0,t.Ma),n.Ha.ya(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Dc.get(t.targetId);return(null===r||t.et.L(r.et)>0)&&(n.Dc=n.Dc.rt(t.targetId,t),n.Cc.set(e,t.targetId)),t}))}function _o(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:i=I(t),o=i.Dc.get(e),s=n?"readwrite":"readwrite-primary",r.label=1;case 1:return r.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",s,(function(t){return i.persistence.Co.removeTarget(t,o)}))];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:if(!wr(u=r.sent()))throw u;return y("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return i.Dc=i.Dc.remove(e),i.Cc.delete(o.target),[2]}}))}))}function Io(t,e,n){var r=I(t),i=ct.min(),o=Ut();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=I(t),i=r.Cc.get(n);return void 0!==i?vr.resolve(r.Dc.get(i)):r.Ha.Ca(e,n)}(r,t,Gn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ha.ka(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Sc.Or(t,e,n?i:ct.min(),n?o:Ut())})).next((function(t){return{documents:t,kc:o}}))}))}function Eo(t,e){var n=I(t),r=I(n.Ha),i=n.Dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.qe(t,e).next((function(t){return t?t.target:null}))}))}function To(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){if(t.code!==a.FAILED_PRECONDITION||t.message!==Zr)throw t;return y("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Ao=function(){function t(){this.Mc=new St(No.Oc),this.Lc=new St(No.Bc)}return t.prototype.m=function(){return this.Mc.m()},t.prototype.Fa=function(t,e){var n=new No(t,e);this.Mc=this.Mc.add(n),this.Lc=this.Lc.add(n)},t.prototype.qc=function(t,e){var n=this;t.forEach((function(t){return n.Fa(t,e)}))},t.prototype.xa=function(t,e){this.Uc(new No(t,e))},t.prototype.Qc=function(t,e){var n=this;t.forEach((function(t){return n.xa(t,e)}))},t.prototype.Wc=function(t){var e=this,n=new D(new N([])),r=new No(n,t),i=new No(n,t+1),o=[];return this.Lc.Nt([r,i],(function(t){e.Uc(t),o.push(t.key)})),o},t.prototype.jc=function(){var t=this;this.Mc.forEach((function(e){return t.Uc(e)}))},t.prototype.Uc=function(t){this.Mc=this.Mc.delete(t),this.Lc=this.Lc.delete(t)},t.prototype.Kc=function(t){var e=new D(new N([])),n=new No(e,t),r=new No(e,t+1),i=Ut();return this.Lc.Nt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.zo=function(t){var e=new No(t,0),n=this.Mc.$t(e);return null!==n&&t.isEqual(n.key)},t}(),No=function(){function t(t,e){this.key=t,this.Gc=e}return t.Oc=function(t,e){return D.i(t.key,e.key)||$(t.Gc,e.Gc)},t.Bc=function(t,e){return $(t.Gc,e.Gc)||D.i(t.key,e.key)},t}(),So=function(t,e){this.user=e,this.type="OAuth",this.zc={},this.zc.Authorization="Bearer "+t},xo=function(){function t(){this.Hc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Yc=function(){},t.prototype.Jc=function(t){this.Hc=t,t(Mr.UNAUTHENTICATED)},t.prototype.Xc=function(){this.Hc=null},t}(),Do=function(){function t(t){var e=this;this.Zc=null,this.currentUser=Mr.UNAUTHENTICATED,this.tu=!1,this.eu=0,this.Hc=null,this.forceRefresh=!1,this.Zc=function(){e.eu++,e.currentUser=e.nu(),e.tu=!0,e.Hc&&e.Hc(e.currentUser)},this.eu=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Zc):(this.Zc(null),t.get().then((function(t){e.auth=t,e.Zc&&e.auth.addAuthTokenListener(e.Zc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.eu,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.eu!==e?(y("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(g("string"==typeof n.accessToken),new So(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Yc=function(){this.forceRefresh=!0},t.prototype.Jc=function(t){this.Hc=t,this.tu&&t(this.currentUser)},t.prototype.Xc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Zc),this.Zc=null,this.Hc=null},t.prototype.nu=function(){var t=this.auth&&this.auth.getUid();return g(null===t||"string"==typeof t),new Mr(t)},t}(),ko=function(){function t(t,e){this.su=t,this.iu=e,this.type="FirstParty",this.user=Mr.ei}return Object.defineProperty(t.prototype,"zc",{get:function(){var t={"X-Goog-AuthUser":this.iu},e=this.su.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Oo=function(){function t(t,e){this.su=t,this.iu=e}return t.prototype.getToken=function(){return Promise.resolve(new ko(this.su,this.iu))},t.prototype.Jc=function(t){t(Mr.ei)},t.prototype.Xc=function(){},t.prototype.Yc=function(){},t}(),Lo=function(){function t(t,e,n,r,i,o){this._n=t,this.ru=n,this.ou=r,this.au=i,this.listener=o,this.state=0,this.cu=0,this.uu=null,this.stream=null,this.gs=new dr(t,e)}return t.prototype.hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.lu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this._u()},t.prototype.stop=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.fu=function(){this.state=0,this.gs.reset()},t.prototype.du=function(){var t=this;this.lu()&&null===this.uu&&(this.uu=this._n.gn(this.ru,6e4,(function(){return t.wu()})))},t.prototype.mu=function(t){this.Tu(),this.stream.send(t)},t.prototype.wu=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.lu()?[2,this.close(0)]:[2]}))}))},t.prototype.Tu=function(){this.uu&&(this.uu.cancel(),this.uu=null)},t.prototype.close=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.Tu(),this.gs.cancel(),this.cu++,3!==t?this.gs.reset():e&&e.code===a.RESOURCE_EXHAUSTED?(p(e.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):e&&e.code===a.UNAUTHENTICATED&&this.au.Yc(),null!==this.stream&&(this.Eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Au(this.cu),n=this.cu;this.au.getToken().then((function(e){t.cu===n&&t.Ru(e)}),(function(n){e((function(){var e=new l(a.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Pu(e)}))}))},t.prototype.Ru=function(t){var e=this,n=this.Au(this.cu);this.stream=this.gu(t),this.stream.yu((function(){n((function(){return e.state=2,e.listener.yu()}))})),this.stream.Iu((function(t){n((function(){return e.Pu(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype._u=function(){var t=this;this.state=4,this.gs.Rn((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Pu=function(t){return y("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Au=function(t){var e=this;return function(n){e._n.ds((function(){return e.cu===t?n():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Ro=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return r.__extends(e,t),e.prototype.gu=function(t){return this.ou.Vu("Listen",t)},e.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:_()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(g(void 0===e||"string"==typeof e),tt.fromBase64String(e||"")):(g(void 0===e||e instanceof Uint8Array),tt.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?a.UNKNOWN:Et(t.code);return new l(e,t.message||"")}(s);n=new Kt(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var c=e.documentChange;c.document,c.document.name,c.document.updateTime;var h=xe(t,c.document.name),f=Te(c.document.updateTime),p=new Nn({mapValue:{fields:c.document.fields}}),d=new kn(h,f,p,{}),v=c.targetIds||[],y=c.removedTargetIds||[];n=new zt(v,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;var m=e.documentDelete;m.document;var w=xe(t,m.document),b=m.readTime?Te(m.readTime):ct.min(),I=new On(w,b),E=m.removedTargetIds||[];n=new zt([],E,I.key,I)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var A=xe(t,T.document),N=T.removedTargetIds||[];n=new zt([],N,A,null)}else{if(!("filter"in e))return _();e.filter;var S=e.filter;S.targetId;var x=S.count||0,D=new _t(x),k=S.targetId;n=new Qt(k,D)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ct.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ct.min():e.readTime?Te(e.readTime):ct.min()}(t);return this.listener.pu(e,n)},e.prototype.bu=function(t){var e={};e.database=Oe(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=dt(r)?{documents:Ue(t,r)}:{query:Ve(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=Ie(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _()}}(0,e.tt);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.mu(e)},e.prototype.vu=function(t){var e={};e.database=Oe(this.serializer),e.removeTarget=t,this.mu(e)},e}(Lo),Co=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Su=!1,s}return r.__extends(e,t),Object.defineProperty(e.prototype,"Du",{get:function(){return this.Su},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Su=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Eu=function(){this.Su&&this.Cu([])},e.prototype.gu=function(t){return this.ou.Vu("Write",t)},e.prototype.onMessage=function(t){if(g(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Su){this.gs.reset();var e=function(t,e){return t&&t.length>0?(g(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Te(t.updateTime):Te(e);n.isEqual(ct.min())&&(n=Te(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new cn(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Te(t.commitTime);return this.listener.Nu(n,e)}return g(!t.writeResults||0===t.writeResults.length),this.Su=!0,this.listener.Fu()},e.prototype.$u=function(){var t={};t.database=Oe(this.serializer),this.mu(t)},e.prototype.Cu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ce(e.serializer,t)}))};this.mu(n)},e}(Lo),Po=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.ou=n,i.serializer=r,i.xu=!1,i}return r.__extends(e,t),e.prototype.ku=function(){if(this.xu)throw new l(a.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mu=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then((function(i){return r.ou.Mu(t,e,n,i)})).catch((function(t){throw t.code===a.UNAUTHENTICATED&&r.credentials.Yc(),t}))},e.prototype.Ou=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then((function(i){return r.ou.Ou(t,e,n,i)})).catch((function(t){throw t.code===a.UNAUTHENTICATED&&r.credentials.Yc(),t}))},e.prototype.terminate=function(){this.xu=!1},e}((function(){})),Uo=function(){function t(t,e){this.os=t,this.fi=e,this.state="Unknown",this.Lu=0,this.Bu=null,this.qu=!0}return t.prototype.Uu=function(){var t=this;0===this.Lu&&(this.Qu("Unknown"),this.Bu=this.os.gn("online_state_timeout",1e4,(function(){return t.Bu=null,t.Wu("Backend didn't respond within 10 seconds."),t.Qu("Offline"),Promise.resolve()})))},t.prototype.ju=function(t){"Online"===this.state?this.Qu("Unknown"):(this.Lu++,this.Lu>=1&&(this.Ku(),this.Wu("Connection failed 1 times. Most recent error: "+t.toString()),this.Qu("Offline")))},t.prototype.set=function(t){this.Ku(),this.Lu=0,"Online"===t&&(this.qu=!1),this.Qu(t)},t.prototype.Qu=function(t){t!==this.state&&(this.state=t,this.fi(t))},t.prototype.Wu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qu?(p(e),this.qu=!1):y("OnlineStateTracker",e)},t.prototype.Ku=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},t}(),Vo=function(t,e,n,i,o){var s=this;this.Gu=t,this.zu=e,this.os=n,this.Hu={},this.Yu=[],this.Ju=new Map,this.Xu=new Set,this.Zu=[],this.th=o,this.th.eh((function(t){n.ds((function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return Wo(this)?(y("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return(e=I(t)).Xu.add(4),[4,Fo(e)];case 1:return n.sent(),e.nh.set("Unknown"),e.Xu.delete(4),[4,Mo(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.nh=new Uo(n,i)};function Mo(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:if(!Wo(t))return[3,4];e=0,n=t.Zu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Fo(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:e=0,n=t.Zu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function qo(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return e=I(t),y("RemoteStore","RemoteStore shutting down."),e.Xu.add(5),[4,Fo(e)];case 1:return n.sent(),e.th.Si(),e.nh.set("Unknown"),[2]}}))}))}function jo(t,e){var n=I(t);n.Ju.has(e.targetId)||(n.Ju.set(e.targetId,e),Ko(n)?Qo(n):as(n).lu()&&Bo(n,e))}function Go(t,e){var n=I(t),r=as(n);n.Ju.delete(e),r.lu()&&zo(n,e),0===n.Ju.size&&(r.lu()?r.du():Wo(n)&&n.nh.set("Unknown"))}function Bo(t,e){t.sh.Ee(e.targetId),as(t).bu(e)}function zo(t,e){t.sh.Ee(e),as(t).vu(e)}function Qo(t){t.sh=new Ht({Be:function(e){return t.Hu.Be(e)},qe:function(e){return t.Ju.get(e)||null}}),as(t).start(),t.nh.Uu()}function Ko(t){return Wo(t)&&!as(t).hu()&&t.Ju.size>0}function Wo(t){return 0===I(t).Xu.size}function Ho(t){t.sh=void 0}function Yo(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.Ju.forEach((function(e,n){Bo(t,e)})),[2]}))}))}function Xo(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){return Ho(t),Ko(t)?(t.nh.ju(e),Qo(t)):t.nh.set("Unknown"),[2]}))}))}function $o(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s;return r.__generator(this,(function(u){switch(u.label){case 0:if(t.nh.set("Online"),!(e instanceof Kt&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:n=e.cause,i=0,o=e.targetIds,r.label=1;case 1:return i<o.length?(s=o[i],t.Ju.has(s)?[4,t.Hu.ih(s,n)]:[3,3]):[3,5];case 2:r.sent(),t.Ju.delete(s),t.sh.removeTarget(s),r.label=3;case 3:r.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return i=u.sent(),y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),[4,Jo(t,i)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof zt?t.sh.pe(e):e instanceof Qt?t.sh.$e(e):t.sh.Se(e),n.isEqual(ct.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,go(t.Gu)];case 8:return o=u.sent(),n.L(o)>=0?[4,function(t,e){var n=t.sh.Me(e);return n.Gt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=t.Ju.get(r);i&&t.Ju.set(r,i.st(n.resumeToken,e))}})),n.zt.forEach((function(e){var n=t.Ju.get(e);if(n){t.Ju.set(e,n.st(tt.B,n.et)),zo(t,e);var r=new bt(n.target,e,1,n.sequenceNumber);Bo(t,r)}})),t.Hu.rh(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return y("RemoteStore","Failed to raise snapshot:",s=u.sent()),[4,Jo(t,s)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Jo(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i=this;return r.__generator(this,(function(o){switch(o.label){case 0:if(!wr(e))throw e;return t.Xu.add(1),[4,Fo(t)];case 1:return o.sent(),t.nh.set("Offline"),n||(n=function(){return go(t.Gu)}),t.os.Ds((function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return y("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Xu.delete(1),[4,Mo(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Zo(t,e){return e().catch((function(n){return Jo(t,n,e)}))}function ts(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:e=I(t),n=cs(e),i=e.Yu.length>0?e.Yu[e.Yu.length-1].batchId:-1,r.label=1;case 1:if(!function(t){return Wo(t)&&t.Yu.length<10}(e))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,wo(e.Gu,i)];case 3:return null===(o=r.sent())?(0===e.Yu.length&&n.du(),[3,7]):(i=o.batchId,function(t,e){t.Yu.push(e);var n=cs(t);n.lu()&&n.Du&&n.Cu(e.mutations)}(e,o),[3,6]);case 4:return s=r.sent(),[4,Jo(e,s)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return es(e)&&ns(e),[2]}}))}))}function es(t){return Wo(t)&&!cs(t).hu()&&t.Yu.length>0}function ns(t){cs(t).start()}function rs(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return cs(t).$u(),[2]}))}))}function is(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o;return r.__generator(this,(function(r){for(e=cs(t),n=0,i=t.Yu;n<i.length;n++)o=i[n],e.Cu(o.mutations);return[2]}))}))}function os(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return i=t.Yu.shift(),o=$r.from(i,e,n),[4,Zo(t,(function(){return t.Hu.oh(o)}))];case 1:return r.sent(),[4,ts(t)];case 2:return r.sent(),[2]}}))}))}function ss(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return e&&cs(t).Du?[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return It(i=e.code)&&i!==a.ABORTED?(n=t.Yu.shift(),cs(t).fu(),[4,Zo(t,(function(){return t.Hu.ah(n.batchId,e)}))]):[3,3];case 1:return r.sent(),[4,ts(t)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return es(t)&&ns(t),[2]}}))}))}function us(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return n=I(t),e?(n.Xu.delete(2),[4,Mo(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Xu.add(2),[4,Fo(n)]);case 3:r.sent(),n.nh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function as(t){var e=this;return t.uh||(t.uh=function(t,e,n){var r=I(t);return r.ku(),new Ro(e,r.ou,r.credentials,r.serializer,n)}(t.zu,t.os,{yu:Yo.bind(null,t),Iu:Xo.bind(null,t),pu:$o.bind(null,t)}),t.Zu.push((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return n?(t.uh.fu(),Ko(t)?Qo(t):t.nh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.uh.stop()];case 2:e.sent(),Ho(t),e.label=3;case 3:return[2]}}))}))}))),t.uh}function cs(t){var e=this;return t.hh||(t.hh=function(t,e,n){var r=I(t);return r.ku(),new Co(e,r.ou,r.credentials,r.serializer,n)}(t.zu,t.os,{yu:rs.bind(null,t),Iu:ss.bind(null,t),Fu:is.bind(null,t),Nu:os.bind(null,t)}),t.Zu.push((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return n?(t.hh.fu(),[4,ts(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.hh.stop()];case 3:e.sent(),t.Yu.length>0&&(y("RemoteStore","Stopping write stream with "+t.Yu.length+" pending writes"),t.Yu=[]),e.label=4;case 4:return[2]}}))}))}))),t.hh}var hs=function(t){this.key=t},fs=function(t){this.key=t},ls=function(){function t(t,e){this.query=t,this.lh=e,this._h=null,this.Zt=!1,this.fh=Ut(),this.Qt=Ut(),this.dh=Xn(t),this.wh=new Ft(this.dh)}return Object.defineProperty(t.prototype,"mh",{get:function(){return this.lh},enumerable:!1,configurable:!0}),t.prototype.Th=function(t,e){var n=this,r=e?e.Eh:new qt,i=e?e.wh:this.wh,o=e?e.Qt:this.Qt,s=i,u=!1,a=Un(this.query)&&i.size===this.query.limit?i.last():null,c=Vn(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var h=i.get(t),f=e instanceof kn?e:null;f&&(f=Yn(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Ye||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Ih(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.dh(f,a)>0||c&&n.dh(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Un(this.query)||Vn(this.query))for(;s.size>this.query.limit;){var h=Un(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{wh:s,Eh:r,Ah:u,Qt:o}},t.prototype.Ih=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.gr=function(t,e,n){var r=this,i=this.wh;this.wh=t.wh,this.Qt=t.Qt;var o=t.Eh.qt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _()}};return n(t)-n(e)}(t.type,e.type)||r.dh(t.doc,e.doc)})),this.Rh(n);var s=e?this.Ph():[],u=0===this.fh.size&&this.Zt?1:0,a=u!==this._h;return this._h=u,0!==o.length||a?{snapshot:new jt(this.query,t.wh,i,o,t.Qt,0===u,a,!1),gh:s}:{gh:s}},t.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({wh:this.wh,Eh:new qt,Qt:this.Qt,Ah:!1},!1)):{gh:[]}},t.prototype.yh=function(t){return!this.lh.has(t)&&!!this.wh.has(t)&&!this.wh.get(t).Ye},t.prototype.Rh=function(t){var e=this;t&&(t.te.forEach((function(t){return e.lh=e.lh.add(t)})),t.ee.forEach((function(t){})),t.ne.forEach((function(t){return e.lh=e.lh.delete(t)})),this.Zt=t.Zt)},t.prototype.Ph=function(){var t=this;if(!this.Zt)return[];var e=this.fh;this.fh=Ut(),this.wh.forEach((function(e){t.yh(e.key)&&(t.fh=t.fh.add(e.key))}));var n=[];return e.forEach((function(e){t.fh.has(e)||n.push(new fs(e))})),this.fh.forEach((function(t){e.has(t)||n.push(new hs(t))})),n},t.prototype.Vh=function(t){this.lh=t.kc,this.fh=Ut();var e=this.Th(t.documents);return this.gr(e,!0)},t.prototype.ph=function(){return jt.Kt(this.query,this.wh,this.Qt,0===this._h)},t}(),ps=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ds=function(t){this.key=t,this.bh=!1},vs=function(){function t(t,e,n,r,i,o){this.Gu=t,this.Sh=e,this.Dh=n,this.Ch=r,this.currentUser=i,this.Nh=o,this.Fh={},this.$h=new ut((function(t){return Wn(t)}),Kn),this.xh=new Map,this.kh=[],this.Mh=new Tt(D.i),this.Oh=new Map,this.Lh=new Ao,this.Bh={},this.qh=new Map,this.Uh=eo.Ta(),this.onlineState="Unknown",this.Qh=void 0}return Object.defineProperty(t.prototype,"Wh",{get:function(){return!0===this.Qh},enumerable:!1,configurable:!0}),t}();function ys(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a;return r.__generator(this,(function(r){switch(r.label){case 0:return n=Gs(t),(s=n.$h.get(e))?(i=s.targetId,n.Ch.Mi(i),o=s.view.ph(),[3,4]):[3,1];case 1:return[4,bo(n.Gu,Gn(e))];case 2:return u=r.sent(),a=n.Ch.Mi(u.targetId),i=u.targetId,[4,gs(n,e,i,"current"===a)];case 3:o=r.sent(),n.Wh&&jo(n.Sh,u),r.label=4;case 4:return[2,o]}}))}))}function gs(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,u,a,c,h;return r.__generator(this,(function(f){switch(f.label){case 0:return t.jh=function(e,n,i){return function(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=e.view.Th(n)).Ah?[4,Io(t.Gu,e.query,!1).then((function(t){var n=t.documents;return e.view.Th(n,o)}))]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return s=i&&i.Gt.get(e.targetId),u=e.view.gr(o,t.Wh,s),[2,(xs(t,e.targetId,u.gh),u.snapshot)]}}))}))}(t,e,n,i)},[4,Io(t.Gu,e,!0)];case 1:return o=f.sent(),s=new ls(e,o.kc),u=s.Th(o.documents),a=Bt.Xt(n,i&&"Offline"!==t.onlineState),c=s.gr(u,t.Wh,a),xs(t,n,c.gh),h=new ps(e,n,s),[2,(t.$h.set(e,h),t.xh.has(n)?t.xh.get(n).push(e):t.xh.set(n,[e]),c.snapshot)]}}))}))}function ms(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=I(t),i=n.$h.get(e),(o=n.xh.get(i.targetId)).length>1?[2,(n.xh.set(i.targetId,o.filter((function(t){return!Kn(t,e)}))),void n.$h.delete(e))]:n.Wh?(n.Ch.Li(i.targetId),n.Ch.Ni(i.targetId)?[3,2]:[4,_o(n.Gu,i.targetId,!1).then((function(){n.Ch.qi(i.targetId),Go(n.Sh,i.targetId),Ns(n,i.targetId)})).catch(To)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return Ns(n,i.targetId),[4,_o(n.Gu,i.targetId,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}function ws(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=I(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,mo(n.Gu,e)];case 2:return i=r.sent(),e.Gt.forEach((function(t,e){var r=n.Oh.get(e);r&&(g(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?r.bh=!0:t.ee.size>0?g(r.bh):t.ne.size>0&&(g(r.bh),r.bh=!1))})),[4,Os(n,i,e)];case 3:return r.sent(),[3,6];case 4:return[4,To(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function bs(t,e,n){var r=I(t);if(r.Wh&&0===n||!r.Wh&&1===n){var i=[];r.$h.forEach((function(t,n){var r=n.view.Us(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=I(t);n.onlineState=e;var r=!1;n.Ls.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Us(e)&&(r=!0)})),r&&Ur(n)}(r.Dh,e),i.length&&r.Fh.pu(i),r.onlineState=e,r.Wh&&r.Ch.ji(e)}}function _s(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c;return r.__generator(this,(function(r){switch(r.label){case 0:return(i=I(t)).Ch.Ui(e,"rejected",n),o=i.Oh.get(e),(s=o&&o.key)?(u=(u=new Tt(D.i)).rt(s,new On(s,ct.min())),a=Ut().add(s),c=new Gt(ct.min(),new Map,new St($),u,a),[4,ws(i,c)]):[3,2];case 1:return r.sent(),i.Mh=i.Mh.remove(s),i.Oh.delete(e),ks(i),[3,4];case 2:return[4,_o(i.Gu,e,!1).then((function(){return Ns(i,e,n)})).catch(To)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}function Is(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:n=I(t),i=e.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,yo(n.Gu,e)];case 2:return o=r.sent(),As(n,i,null),Ts(n,i),n.Ch.xi(i,"acknowledged"),[4,Os(n,o)];case 3:return r.sent(),[3,6];case 4:return[4,To(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Es(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:i=I(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=I(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.vr.Mo(t,e).next((function(e){return g(null!==e),r=e.keys(),n.vr.Qo(t,e)})).next((function(){return n.vr.Go(t)})).next((function(){return n.$c.$r(t,r)}))}))}(i.Gu,e)];case 2:return o=r.sent(),As(i,e,n),Ts(i,e),i.Ch.xi(e,"rejected",n),[4,Os(i,o)];case 3:return r.sent(),[3,6];case 4:return[4,To(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Ts(t,e){(t.qh.get(e)||[]).forEach((function(t){t.resolve()})),t.qh.delete(e)}function As(t,e,n){var r=I(t),i=r.Bh[r.currentUser.Zs()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Bh[r.currentUser.Zs()]=i}}function Ns(t,e,n){void 0===n&&(n=null),t.Ch.Li(e);for(var r=0,i=t.xh.get(e);r<i.length;r++){var o=i[r];t.$h.delete(o),n&&t.Fh.Kh(o,n)}t.xh.delete(e),t.Wh&&t.Lh.Wc(e).forEach((function(e){t.Lh.zo(e)||Ss(t,e)}))}function Ss(t,e){var n=t.Mh.get(e);null!==n&&(Go(t.Sh,n),t.Mh=t.Mh.remove(e),t.Oh.delete(n),ks(t))}function xs(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof hs?(t.Lh.Fa(o.key,e),Ds(t,o)):o instanceof fs?(y("SyncEngine","Document no longer in limbo: "+o.key),t.Lh.xa(o.key,e),t.Lh.zo(o.key)||Ss(t,o.key)):_()}}function Ds(t,e){var n=e.key;t.Mh.get(n)||(y("SyncEngine","New document in limbo: "+n),t.kh.push(n),ks(t))}function ks(t){for(;t.kh.length>0&&t.Mh.size<t.Nh;){var e=t.kh.shift(),n=t.Uh.next();t.Oh.set(n,new ds(e)),t.Mh=t.Mh.rt(e,n),jo(t.Sh,new bt(Gn(Pn(e.path)),n,2,Fr.oi))}}function Os(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return r.__generator(this,(function(a){switch(a.label){case 0:return i=I(t),o=[],s=[],u=[],i.$h.m()?[3,3]:(i.$h.forEach((function(t,r){u.push(i.jh(r,e,n).then((function(t){if(t){i.Wh&&i.Ch.Ui(r.targetId,t.fromCache?"not-current":"current"),o.push(t);var e=ni.Gr(r.targetId,t);s.push(e)}})))})),[4,Promise.all(u)]);case 1:return a.sent(),i.Fh.pu(o),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h,f;return r.__generator(this,(function(r){switch(r.label){case 0:n=I(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return vr.forEach(e,(function(e){return vr.forEach(e.jr,(function(r){return n.persistence.Co.Fa(t,e.targetId,r)})).next((function(){return vr.forEach(e.Kr,(function(r){return n.persistence.Co.xa(t,e.targetId,r)}))}))}))}))];case 2:return r.sent(),[3,4];case 3:if(!wr(i=r.sent()))throw i;return y("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,s=e;o<s.length;o++)u=s[o],a=u.targetId,u.fromCache||(c=n.Dc.get(a),h=c.et,f=c.it(h),n.Dc=n.Dc.rt(a,f));return[2]}}))}))}(i.Gu,s)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Ls(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(o){switch(o.label){case 0:return(n=I(t)).currentUser.isEqual(e)?[3,3]:(y("SyncEngine","User change. New user:",e.Zs()),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return n=I(t),i=n.vr,o=n.$c,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var r;return n.vr.qo(t).next((function(s){return r=s,i=n.persistence.Ic(e),o=new ei(n.Fc,i,n.persistence.Pc()),i.qo(t)})).next((function(e){for(var n=[],i=[],s=Ut(),u=0,a=r;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return o.$r(t,s).next((function(t){return{Gh:t,zh:n,Hh:i}}))}))}))];case 1:return s=r.sent(),[2,(n.vr=i,n.$c=o,n.Sc.xc(n.$c),s)]}}))}))}(n.Gu,e)]);case 1:return i=o.sent(),n.currentUser=e,function(t,e){t.qh.forEach((function(t){t.forEach((function(t){t.reject(new l(a.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.qh.clear()}(n),n.Ch.Wi(e,i.zh,i.Hh),[4,Os(n,i.Gh)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function Rs(t,e){var n=I(t),r=n.Oh.get(e);if(r&&r.bh)return Ut().add(r.key);var i=Ut(),o=n.xh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.$h.get(a);i=i.xt(c.view.mh)}return i}function Cs(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,Io((n=I(t)).Gu,e.query,!0)];case 1:return i=r.sent(),o=e.view.Vh(i),[2,(n.Wh&&xs(n,e.targetId,o.gh),o)]}}))}))}function Ps(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,function(t,e){var n=I(t),r=I(n.vr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Oo(t,e).next((function(e){return e?n.$c.$r(t,e):vr.resolve(null)}))}))}((o=I(t)).Gu,e)];case 1:return null===(s=r.sent())?[3,6]:"pending"!==n?[3,3]:[4,ts(o.Sh)];case 2:return r.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(As(o,e,i||null),Ts(o,e),function(t,e){I(I(t).vr).jo(e)}(o.Gu,e)):_(),r.label=4;case 4:return[4,Os(o,s)];case 5:return r.sent(),[3,7];case 6:y("SyncEngine","Cannot apply mutation batch with id: "+e),r.label=7;case 7:return[2]}}))}))}function Us(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h;return r.__generator(this,(function(r){switch(r.label){case 0:return Gs(n=I(t)),Bs(n),!0!==e||!0===n.Qh?[3,3]:(i=n.Ch.Di(),[4,Vs(n,i.A())]);case 1:return o=r.sent(),n.Qh=!0,[4,us(n.Sh,!0)];case 2:for(r.sent(),s=0,u=o;s<u.length;s++)a=u[s],jo(n.Sh,a);return[3,7];case 3:return!1!==e||!1===n.Qh?[3,7]:(c=[],h=Promise.resolve(),n.xh.forEach((function(t,e){n.Ch.Bi(e)?c.push(e):h=h.then((function(){return Ns(n,e),_o(n.Gu,e,!0)})),Go(n.Sh,e)})),[4,h]);case 4:return r.sent(),[4,Vs(n,c)];case 5:return r.sent(),function(t){var e=I(t);e.Oh.forEach((function(t,n){Go(e.Sh,n)})),e.Lh.jc(),e.Oh=new Map,e.Mh=new Tt(D.i)}(n),n.Qh=!1,[4,us(n.Sh,!1)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))}function Vs(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a,c,h,f,l,p,d,v,y;return r.__generator(this,(function(r){switch(r.label){case 0:n=I(t),i=[],o=[],s=0,u=e,r.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=n.xh.get(a))&&0!==h.length?[4,bo(n.Gu,Gn(h[0]))]:[3,7]):[3,13];case 2:c=r.sent(),f=0,l=h,r.label=3;case 3:return f<l.length?(p=l[f],d=n.$h.get(p),[4,Cs(n,d)]):[3,6];case 4:(v=r.sent()).snapshot&&o.push(v.snapshot),r.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Eo(n.Gu,a)];case 8:return y=r.sent(),[4,bo(n.Gu,y)];case 9:return c=r.sent(),[4,gs(n,Ms(y),a,!1)];case 10:r.sent(),r.label=11;case 11:i.push(c),r.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Fh.pu(o),i)]}}))}))}function Ms(t){return Cn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Fs(t){var e=I(t);return I(I(e.Gu).persistence).Vi()}function qs(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=I(t)).Qh?(y("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.xh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=I(t),n=I(e.Fc);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n.ia(t,e.Nc)})).then((function(t){var n=t.ra,r=t.readTime;return e.Nc=r,n}))}(o.Gu)];case 3:return s=r.sent(),u=Gt.Jt(e,"current"===n),[4,Os(o,s,u)];case 4:return r.sent(),[3,8];case 5:return[4,_o(o.Gu,e,!0)];case 6:return r.sent(),Ns(o,e,i),[3,8];case 7:_(),r.label=8;case 8:return[2]}}))}))}function js(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,p,l;return r.__generator(this,(function(d){switch(d.label){case 0:if(!(i=Gs(t)).Qh)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?(u=s[o],i.xh.has(u)?(y("SyncEngine","Adding an already active target "+u),[3,5]):[4,Eo(i.Gu,u)]):[3,6];case 2:return a=d.sent(),[4,bo(i.Gu,a)];case 3:return c=d.sent(),[4,gs(i,Ms(a),c.targetId,!1)];case 4:d.sent(),jo(i.Sh,c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return r.__generator(this,(function(e){switch(e.label){case 0:return i.xh.has(t)?[4,_o(i.Gu,t,!1).then((function(){Go(i.Sh,t),Ns(i,t)})).catch(To)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,p=n,d.label=7;case 7:return f<p.length?(l=p[f],[5,h(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function Gs(t){var e=I(t);return e.Sh.Hu.rh=ws.bind(null,e),e.Sh.Hu.Be=Rs.bind(null,e),e.Sh.Hu.ih=_s.bind(null,e),e.Fh.pu=Cr.bind(null,e.Dh),e.Fh.Kh=Pr.bind(null,e.Dh),e}function Bs(t){var e=I(t);return e.Sh.Hu.oh=Is.bind(null,e),e.Sh.Hu.ah=Es.bind(null,e),e}var zs=function(){function t(){}return t.prototype.xc=function(t){this.Yh=t},t.prototype.Or=function(t,e,n,i){var r=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.p())}(e)||n.isEqual(ct.min())?this.Jh(t,e):this.Yh.$r(t,i).next((function(s){var u=r.Xh(e,s);return(Un(e)||Vn(e))&&r.Ah(e.on,u,i,n)?r.Jh(t,e):(v()<=c.LogLevel.DEBUG&&y("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Hn(e)),r.Yh.Or(t,e,n).next((function(t){return u.forEach((function(e){t=t.rt(e.key,e)})),t})))}))},t.prototype.Xh=function(t,e){var n=new St(Xn(t));return e.forEach((function(e,r){r instanceof kn&&Yn(t,r)&&(n=n.add(r))})),n},t.prototype.Ah=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Jh=function(t,e){return v()<=c.LogLevel.DEBUG&&y("IndexFreeQueryEngine","Using full collection scan to execute query:",Hn(e)),this.Yh.Or(t,e,ct.min())},t}(),Qs=function(){function t(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Zh=1,this.tl=new St(No.Oc)}return t.prototype.$o=function(t){return vr.resolve(0===this.vr.length)},t.prototype.xo=function(t,e,n,r){var i=this.Zh;this.Zh++,this.vr.length>0&&this.vr[this.vr.length-1];var o=new Xr(i,e,n,r);this.vr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.tl=this.tl.add(new No(a.key,i)),this.Sr.ko(t,a.key.path.h())}return vr.resolve(o)},t.prototype.Mo=function(t,e){return vr.resolve(this.el(e))},t.prototype.Lo=function(t,e){var n=e+1,r=this.nl(n),i=r<0?0:r;return vr.resolve(this.vr.length>i?this.vr[i]:null)},t.prototype.Bo=function(){return vr.resolve(0===this.vr.length?-1:this.Zh-1)},t.prototype.qo=function(t){return vr.resolve(this.vr.slice())},t.prototype.Cr=function(t,e){var n=this,r=new No(e,0),i=new No(e,Number.POSITIVE_INFINITY),o=[];return this.tl.Nt([r,i],(function(t){var e=n.el(t.Gc);o.push(e)})),vr.resolve(o)},t.prototype.Mr=function(t,e){var n=this,r=new St($);return e.forEach((function(t){var e=new No(t,0),i=new No(t,Number.POSITIVE_INFINITY);n.tl.Nt([e,i],(function(t){r=r.add(t.Gc)}))})),vr.resolve(this.sl(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;D.F(i)||(i=i.child(""));var o=new No(new D(i),0),s=new St($);return this.tl.Ft((function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Gc)),!0)}),o),vr.resolve(this.sl(s))},t.prototype.sl=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.el(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;g(0===this.il(e.batchId,"removed")),this.vr.shift();var r=this.tl;return vr.forEach(e.mutations,(function(i){var o=new No(i.key,e.batchId);return r=r.delete(o),n.Co.Ko(t,i.key)})).next((function(){n.tl=r}))},t.prototype.jo=function(t){},t.prototype.zo=function(t,e){var n=new No(e,0),r=this.tl.$t(n);return vr.resolve(e.isEqual(r&&r.key))},t.prototype.Go=function(t){return this.vr.length,vr.resolve()},t.prototype.il=function(t,e){return this.nl(t)},t.prototype.nl=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},t.prototype.el=function(t){var e=this.nl(t);return e<0||e>=this.vr.length?null:this.vr[e]},t}(),Ks=function(){function t(t,e){this.Sr=t,this.rl=e,this.docs=new Tt(D.i),this.size=0}return t.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rl(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},t.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ar=function(t,e){var n=this.docs.get(e);return vr.resolve(n?n.Zo:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ot();return e.forEach((function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)})),vr.resolve(r)},t.prototype.Or=function(t,e,n){for(var r=Rt(),i=new D(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,c=a.Zo,h=a.readTime;if(!e.path.T(u.path))break;h.L(n)<=0||c instanceof kn&&Yn(e,c)&&(r=r.rt(c.key,c))}return vr.resolve(r)},t.prototype.ol=function(t,e){return vr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.aa=function(e){return new t.ca(this)},t.prototype.ha=function(t){return vr.resolve(this.size)},t}();Ks.ca=function(t){function e(e){var n=this;return(n=t.call(this)||this).la=e,n}return r.__extends(e,t),e.prototype.gr=function(t){var e=this,n=[];return this.dr.forEach((function(r,i){i?n.push(e.la.Tr(t,i,e.readTime)):e.la.Ir(r)})),vr.$n(n)},e.prototype.Rr=function(t,e){return this.la.Ar(t,e)},e.prototype.Pr=function(t,e){return this.la.getEntries(t,e)},e}(Jr);var Ws=function(){function t(t){this.persistence=t,this.al=new ut((function(t){return yt(t)}),gt),this.lastRemoteSnapshotVersion=ct.min(),this.highestTargetId=0,this.cl=0,this.ul=new Ao,this.targetCount=0,this.hl=eo.ma()}return t.prototype.De=function(t,e){return this.al.forEach((function(t,n){return e(n)})),vr.resolve()},t.prototype.Ra=function(t){return vr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Pa=function(t){return vr.resolve(this.cl)},t.prototype.Ea=function(t){return this.highestTargetId=this.hl.next(),vr.resolve(this.highestTargetId)},t.prototype.ga=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.cl&&(this.cl=e),vr.resolve()},t.prototype.Va=function(t){this.al.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new eo(e),this.highestTargetId=e),t.sequenceNumber>this.cl&&(this.cl=t.sequenceNumber)},t.prototype.ya=function(t,e){return this.Va(e),this.targetCount+=1,vr.resolve()},t.prototype.ba=function(t,e){return this.Va(e),vr.resolve()},t.prototype.va=function(t,e){return this.al.delete(e.target),this.ul.Wc(e.targetId),this.targetCount-=1,vr.resolve()},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return this.al.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.al.delete(s),o.push(r.Sa(t,u.targetId)),i++)})),vr.$n(o).next((function(){return i}))},t.prototype.Da=function(t){return vr.resolve(this.targetCount)},t.prototype.Ca=function(t,e){var n=this.al.get(e)||null;return vr.resolve(n)},t.prototype.Na=function(t,e,n){return this.ul.qc(e,n),vr.resolve()},t.prototype.$a=function(t,e,n){this.ul.Qc(e,n);var r=this.persistence.Co,i=[];return r&&e.forEach((function(e){i.push(r.Ko(t,e))})),vr.$n(i)},t.prototype.Sa=function(t,e){return this.ul.Wc(e),vr.resolve()},t.prototype.ka=function(t,e){var n=this.ul.Kc(e);return vr.resolve(n)},t.prototype.zo=function(t,e){return vr.resolve(this.ul.zo(e))},t}(),Hs=function(){function t(t){var e=this;this.ll={},this.Ba=new Fr(0),this.qa=!1,this.qa=!0,this.Co=t(this),this.Ha=new Ws(this),this.Sr=new Ci,this.br=new Ks(this.Sr,(function(t){return e.Co._l(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Si=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.nc=function(){},t.prototype.sc=function(){},t.prototype.Pc=function(){return this.Sr},t.prototype.Ic=function(t){var e=this.ll[t.Zs()];return e||(e=new Qs(this.Sr,this.Co),this.ll[t.Zs()]=e),e},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.runTransaction=function(t,e,n){var r=this;y("MemoryPersistence","Starting transaction:",t);var i=new Ys(this.Ba.next());return this.Co.fl(),n(i).next((function(t){return r.Co.dl(i).next((function(){return t}))})).Nn().then((function(t){return i.pr(),t}))},t.prototype.wl=function(t,e){return vr.xn(Object.values(this.ll).map((function(n){return function(){return n.zo(t,e)}})))},t}(),Ys=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ma=e,n}return r.__extends(e,t),e}(ti),Xs=function(){function t(t){this.persistence=t,this.ml=new Ao,this.Tl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,"Il",{get:function(){if(this.Tl)return this.Tl;throw _()},enumerable:!1,configurable:!0}),t.prototype.Fa=function(t,e,n){return this.ml.Fa(n,e),this.Il.delete(n.toString()),vr.resolve()},t.prototype.xa=function(t,e,n){return this.ml.xa(n,e),this.Il.add(n.toString()),vr.resolve()},t.prototype.Ko=function(t,e){return this.Il.add(e.toString()),vr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.ml.Wc(e.targetId).forEach((function(t){return n.Il.add(t.toString())}));var r=this.persistence.Ac();return r.ka(t,e.targetId).next((function(t){t.forEach((function(t){return n.Il.add(t.toString())}))})).next((function(){return r.va(t,e)}))},t.prototype.fl=function(){this.Tl=new Set},t.prototype.dl=function(t){var e=this,n=this.persistence.Rc().aa();return vr.forEach(this.Il,(function(r){var i=D.D(r);return e.Al(t,i).next((function(t){t||n.Ir(i)}))})).next((function(){return e.Tl=null,n.apply(t)}))},t.prototype.vc=function(t,e){var n=this;return this.Al(t,e).next((function(t){t?n.Il.delete(e.toString()):n.Il.add(e.toString())}))},t.prototype._l=function(t){return 0},t.prototype.Al=function(t,e){var n=this;return vr.xn([function(){return vr.resolve(n.ml.zo(e))},function(){return n.persistence.Ac().zo(t,e)},function(){return n.persistence.wl(t,e)}])},t}(),$s=function(){function t(t){this.Rl=t.Rl,this.Pl=t.Pl}return t.prototype.yu=function(t){this.gl=t},t.prototype.Iu=function(t){this.yl=t},t.prototype.onMessage=function(t){this.Vl=t},t.prototype.close=function(){this.Pl()},t.prototype.send=function(t){this.Rl(t)},t.prototype.pl=function(){this.gl()},t.prototype.bl=function(t){this.yl(t)},t.prototype.vl=function(t){this.Vl(t)},t}(),Js={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Zs=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n}return r.__extends(e,t),e.prototype.$l=function(t,e,n,r){return new Promise((function(o,s){var u=new i.XhrIo;u.listenOnce(i.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case i.ErrorCode.NO_ERROR:var e=u.getResponseJson();y("Connection","XHR received:",JSON.stringify(e)),o(e);break;case i.ErrorCode.TIMEOUT:y("Connection",'RPC "'+t+'" timed out'),s(new l(a.DEADLINE_EXCEEDED,"Request time out"));break;case i.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(y("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var c=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(a).indexOf(e)>=0?e:a.UNKNOWN}(r.status);s(new l(c,r.message))}else s(new l(a.UNKNOWN,"Server responded with status "+u.getStatus()))}else s(new l(a.UNAVAILABLE,"Connection failed."));break;default:_()}}finally{y("Connection",'RPC "'+t+'" completed.')}}));var c=JSON.stringify(r);u.send(e,"POST",c,n,15)}))},e.prototype.Vu=function(t,e){var n=[this.Dl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=i.createWebChannelTransport(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Fl(s.initMessageHeaders,e),h.isMobileCordova()||h.isReactNative()||h.isElectron()||h.isIE()||h.isUWP()||h.isBrowserExtension()||(s.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");y("Connection","Creating WebChannel: "+u,s);var o=r.createWebChannel(u,s),c=!1,p=!1,f=new $s({Rl:function(t){p?y("Connection","Not sending because WebChannel is closed:",t):(c||(y("Connection","Opening WebChannel transport."),o.open(),c=!0),y("Connection","WebChannel sending:",t),o.send(t))},Pl:function(){return o.close()}}),d=function(t,e){o.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return d(i.WebChannel.EventType.OPEN,(function(){p||y("Connection","WebChannel transport opened.")})),d(i.WebChannel.EventType.CLOSE,(function(){p||(p=!0,y("Connection","WebChannel transport closed"),f.bl())})),d(i.WebChannel.EventType.ERROR,(function(t){p||(p=!0,m("Connection","WebChannel transport errored:",t),f.bl(new l(a.UNAVAILABLE,"The operation could not be completed")))})),d(i.WebChannel.EventType.MESSAGE,(function(t){var e;if(!p){var n=t.data[0];g(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){y("Connection","WebChannel received error:",i);var c=i.status,s=function(t){var e=mt[t];if(void 0!==e)return Et(e)}(c),u=i.message;void 0===s&&(s=a.INTERNAL,u="Unknown error status: "+c+" with message "+i.message),p=!0,f.bl(new l(s,u)),o.close()}else y("Connection","WebChannel received:",n),f.vl(n)}})),setTimeout((function(){f.pl()}),0),f},e}(function(){function t(t){this.Sl=t,this.U=t.U;var e=t.ssl?"https":"http";this.Dl=e+"://"+t.host,this.Cl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return t.prototype.Mu=function(t,e,n,r){var i=this.Nl(t,e);y("RestConnection","Sending: ",i,n);var o={};return this.Fl(o,r),this.$l(t,i,o,n).then((function(t){return y("RestConnection","Received: ",t),t}),(function(e){throw m("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Ou=function(t,e,n,r){return this.Mu(t,e,n,r)},t.prototype.Fl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.0",t["Content-Type"]="text/plain",e)for(var n in e.zc)e.zc.hasOwnProperty(n)&&(t[n]=e.zc[n])},t.prototype.Nl=function(t,e){var n=Js[t];return this.Dl+"/v1/"+e+":"+n},t}()),tu=function(){function t(){var t=this;this.xl=function(){return t.kl()},this.Ml=function(){return t.Ol()},this.Ll=[],this.Bl()}return t.prototype.eh=function(t){this.Ll.push(t)},t.prototype.Si=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.Ml)},t.prototype.Bl=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.Ml)},t.prototype.kl=function(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(1)},t.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),eu=function(){function t(){}return t.prototype.eh=function(t){},t.prototype.Si=function(){},t}();function nu(t){return new ge(t,!0)}var ru="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",iu=function(){function t(){}return t.prototype.initialize=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Ch=this.ql(t),this.persistence=this.Ul(t),[4,this.persistence.start()];case 1:return e.sent(),this.Ql=this.Wl(t),this.Gu=this.jl(t),[2]}}))}))},t.prototype.Wl=function(t){return null},t.prototype.jl=function(t){return e=this.persistence,n=new zs,r=t.Kl,new vo(e,n,r);var e,n,r},t.prototype.Ul=function(t){if(t.persistenceSettings.Gl)throw new l(a.FAILED_PRECONDITION,ru);return new Hs(Xs.El)},t.prototype.ql=function(t){return new Yr},t.prototype.terminate=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Ql&&this.Ql.stop(),[4,this.Ch.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}}))}))},t.prototype.clearPersistence=function(t,e){throw new l(a.FAILED_PRECONDITION,ru)},t}(),ou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),n=this.zl._i,this.Ch instanceof Hr?(this.Ch._i={tr:Ps.bind(null,n),er:qs.bind(null,n),nr:js.bind(null,n),Vi:Fs.bind(null,n)},[4,this.Ch.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.ec((function(t){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,Us(this.zl._i,t)];case 1:return e.sent(),this.Ql&&(t&&!this.Ql.Ti?this.Ql.start(this.Gu):t||this.Ql.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},e.prototype.ql=function(t){if(t.persistenceSettings.Gl&&t.persistenceSettings.synchronizeTabs){var e=Ar();if(!Hr.On(e))throw new l(a.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=po(t.Sl.U,t.Sl.persistenceKey);return new Hr(e,t.os,n,t.clientId,t.Kl)}return new Yr},e}(function(t){function e(e){var n=this;return(n=t.call(this)||this).zl=e,n}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){return e=I(t),n=I(e.Fc),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return n.oa(t)})).then((function(t){e.Nc=t}))]}))}))}(this.Gu)];case 2:return n.sent(),[4,this.zl.initialize(this,e)];case 3:return n.sent(),[4,Bs(this.zl._i)];case 4:return n.sent(),[4,ts(this.zl.Sh)];case 5:return n.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=this.persistence.Co.do;return new ui(e,t.os)},e.prototype.Ul=function(t){var e=po(t.Sl.U,t.Sl.persistenceKey),n=nu(t.Sl.U);return new ao(t.persistenceSettings.synchronizeTabs,e,t.clientId,si.oo(t.persistenceSettings.cacheSizeBytes),t.os,Ar(),Nr(),n,this.Ch,t.persistenceSettings.La)},e.prototype.ql=function(t){return new Yr},e.prototype.clearPersistence=function(t,e){return function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return yr.On()?(e=t+"main",[4,yr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(po(t,e))},e}(iu)),su=function(){function t(){}return t.prototype.initialize=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.Gu?[3,2]:(this.Gu=t.Gu,this.Ch=t.Ch,this.zu=this.Hl(e),this.Sh=this.Yl(e),this.Dh=this.Jl(e),this._i=this.Xl(e),this.Ch.fi=function(t){return bs(n._i,t,1)},this.Sh.Hu.Zl=Ls.bind(null,this._i),[4,us(this.Sh,this._i.Wh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.Jl=function(t){return new Or},t.prototype.Hl=function(t){var e,n=nu(t.Sl.U),r=(e=t.Sl,new Zs(e));return function(t,e,n){return new Po(t,e,n)}(t.credentials,r,n)},t.prototype.Yl=function(t){var e,n,r,i,o,s=this;return e=this.Gu,n=this.zu,r=t.os,i=function(t){return bs(s._i,t,0)},o=tu.On()?new tu:new eu,new Vo(e,n,r,i,o)},t.prototype.Xl=function(t){return function(t,e,n,r,i,o,s){var u=new vs(t,e,n,r,i,o);return s&&(u.Qh=!0),u}(this.Gu,this.Sh,this.Dh,this.Ch,t.Kl,t.Nh,!t.persistenceSettings.Gl||!t.persistenceSettings.synchronizeTabs)},t.prototype.terminate=function(){return qo(this.Sh)},t}(),uu=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.t_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.t_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.e_=function(){this.muted=!0},t.prototype.t_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),au=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new l(a.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+H(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(C("FieldPath","string",e,t[e]),0===t[e].length)throw new l(a.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.n_=new x(t)},cu=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return r.__extends(e,t),e.documentId=function(){return new e(x.v().R())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","FieldPath",1,t);return this.n_.isEqual(t.n_)},e}(au),hu=new RegExp("[~\\*/\\[\\]]"),fu=function(t){this.s_=t},lu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.i_=function(t){if(2!==t.r_)throw 1===t.r_?t.o_(this.s_+"() can only appear at the top level of your update data"):t.o_(this.s_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(fu);function pu(t,e,n){return new Au({r_:3,a_:e.settings.a_,methodName:t.s_,c_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var du=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.i_=function(t){return new an(t.path,new Je)},e.prototype.isEqual=function(t){return t instanceof e},e}(fu),vu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).u_=n,r}return r.__extends(e,t),e.prototype.i_=function(t){var e=pu(this,t,!0),n=this.u_.map((function(t){return Ou(t,e)})),r=new Ze(n);return new an(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fu),yu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).u_=n,r}return r.__extends(e,t),e.prototype.i_=function(t){var e=pu(this,t,!0),n=this.u_.map((function(t){return Ou(t,e)})),r=new en(n);return new an(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fu),gu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).h_=n,r}return r.__extends(e,t),e.prototype.i_=function(t){var e=new rn(t.serializer,be(t.serializer,this.h_));return new an(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(fu),mu=function(){function t(t,e){if(O("GeoPoint",arguments,2),C("GeoPoint","number",1,t),C("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new l(a.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new l(a.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.l_=t,this.__=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.l_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.__},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.l_===t.l_&&this.__===t.__},t.prototype.toJSON=function(){return{latitude:this.l_,longitude:this.__}},t.prototype.H=function(t){return $(this.l_,t.l_)||$(this.__,t.__)},t}(),wu=function(t){this.f_=t},bu=/^__.*__$/,_u=function(t,e,n){this.d_=t,this.w_=e,this.m_=n},Iu=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[];return null!==this.Qe?n.push(new wn(t,this.data,this.Qe,e)):n.push(new mn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new _n(t,this.fieldTransforms)),n},t}(),Eu=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[new wn(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new _n(t,this.fieldTransforms)),n},t}();function Tu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _()}}var Au=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.E_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"r_",{get:function(){return this.settings.r_},enumerable:!1,configurable:!0}),t.prototype.I_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,c_:!1});return r.R_(t),r},t.prototype.P_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,c_:!1});return r.E_(),r},t.prototype.g_=function(t){return this.I_({path:void 0,c_:!0})},t.prototype.o_=function(t){return Vu(t,this.settings.methodName,this.settings.y_||!1,this.path,this.settings.a_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.T(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.T(e.field)}))},t.prototype.E_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.R_(this.path.get(t))},t.prototype.R_=function(t){if(0===t.length)throw this.o_("Document fields must not be empty");if(Tu(this.r_)&&bu.test(t))throw this.o_('Document fields cannot begin and end with "__"')},t}(),Nu=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||nu(t)}return t.prototype.V_=function(t,e,n,r){return void 0===r&&(r=!1),new Au({r_:t,methodName:e,a_:n,path:x.g(),c_:!1,y_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function Su(t,e,n,r,i,o){void 0===o&&(o={});var s=t.V_(o.merge||o.mergeFields?2:0,e,n,i);Cu("Data must be an object, but it was:",s,r);var u,c,h=Lu(r,s);if(o.merge)u=new un(s.Qe),c=s.fieldTransforms;else if(o.mergeFields){for(var f=[],p=0,d=o.mergeFields;p<d.length;p++){var v=d[p],g=void 0;if(v instanceof au)g=v.n_;else{if("string"!=typeof v)throw _();g=Uu(e,v,n)}if(!s.contains(g))throw new l(a.INVALID_ARGUMENT,"Field '"+g+"' is specified in your field mask but missing from your input data.");Mu(f,g)||f.push(g)}u=new un(f),c=s.fieldTransforms.filter((function(t){return u.He(t.field)}))}else u=null,c=s.fieldTransforms;return new Iu(new Nn(h),u,c)}function xu(t,e,n,r){var i=t.V_(1,e,n);Cu("Data must be an object, but it was:",i,r);var o=[],s=new Sn;T(r,(function(t,r){var u=Uu(e,t,n),a=i.P_(u);if(r instanceof lu||r instanceof wu&&r.f_ instanceof lu)o.push(u);else{var c=Ou(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new un(o);return new Eu(s.Je(),u,i.fieldTransforms)}function Du(t,e,n,r,i,o){var s=t.V_(1,e,n),u=[Pu(e,r,n)],c=[i];if(o.length%2!=0)throw new l(a.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Pu(e,o[h])),c.push(o[h+1]);for(var f=[],p=new Sn,d=u.length-1;d>=0;--d)if(!Mu(f,u[d])){var v=u[d],y=c[d],g=s.P_(v);if(y instanceof lu||y instanceof wu&&y.f_ instanceof lu)f.push(v);else{var m=Ou(y,g);null!=m&&(f.push(v),p.set(v,m))}}var w=new un(f);return new Eu(p.Je(),w,s.fieldTransforms)}function ku(t,e,n,r){return void 0===r&&(r=!1),Ou(n,t.V_(r?4:3,e))}function Ou(t,e){if(t instanceof wu&&(t=t.f_),Ru(t))return Cu("Unsupported field value:",e,t),Lu(t,e);if(t instanceof fu)return function(t,e){if(!Tu(e.r_))throw e.o_(t.s_+"() can only be used with update() and set()");if(!e.path)throw e.o_(t.s_+"() is not currently supported inside arrays");var n=t.i_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.c_&&4!==e.r_)throw e.o_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Ou(o[i],e.g_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return be(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=at.fromDate(t);return{timestampValue:_e(e.serializer,n)}}if(t instanceof at){var r=new at(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_e(e.serializer,r)}}if(t instanceof mu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof et)return{bytesValue:Ie(e.serializer,t.q)};if(t instanceof _u){var i=e.U,o=t.d_;if(!o.isEqual(i))throw e.o_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Ae(t.d_||e.U,t.w_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.o_("Unsupported field value: "+B(t))}(t,e)}function Lu(t,e){var n={};return b(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):T(t,(function(t,r){var i=Ou(r,e.A_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ru(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof at||t instanceof mu||t instanceof et||t instanceof _u||t instanceof fu)}function Cu(t,e,n){if(!Ru(n)||!G(n)){var r=B(n);throw"an object"===r?e.o_(t+" a custom object"):e.o_(t+" "+r)}}function Pu(t,e,n){if(e instanceof au)return e.n_;if("string"==typeof e)return Uu(t,e);throw Vu("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Uu(t,e,n){try{return function(t){if(t.search(hu)>=0)throw new l(a.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(cu.bind.apply(cu,r.__spreadArrays([void 0],t.split("."))))}catch(e){throw new l(a.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).n_}catch(e){throw Vu((i=e)instanceof Error?i.message:i.toString(),t,!1,void 0,n)}var i}function Vu(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var c="";return(o||s)&&(c+=" (found",o&&(c+=" in field "+r),s&&(c+=" in document "+i),c+=")"),new l(a.INVALID_ARGUMENT,(u+=". ")+t+c)}function Mu(t,e){return t.some((function(t){return t.isEqual(e)}))}var Fu=function(){function t(t){this.zu=t,this.p_=new Map,this.mutations=[],this.b_=!1,this.v_=null,this.S_=new Set}return t.prototype.D_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:if(this.C_(),this.mutations.length>0)throw new l(a.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u,a;return r.__generator(this,(function(r){switch(r.label){case 0:return n=I(t),i=Oe(n.serializer)+"/documents",o={documents:e.map((function(t){return Se(n.serializer,t)}))},[4,n.Ou("BatchGetDocuments",i,o)];case 1:return s=r.sent(),u=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){g(!!e.found),e.found.name,e.found.updateTime;var n=xe(t,e.found.name),r=Te(e.found.updateTime),i=new Nn({mapValue:{fields:e.found.fields}});return new kn(n,r,i,{})}(t,e):"missing"in e?function(t,e){g(!!e.missing),g(!!e.readTime);var n=xe(t,e.missing),r=Te(e.readTime);return new On(n,r)}(t,e):_()}(n.serializer,t);u.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());g(!!e),a.push(e)})),a)]}}))}))}(this.zu,t)];case 1:return[2,((e=i.sent()).forEach((function(t){t instanceof On||t instanceof kn?n.N_(t):_()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.T_(t,this.Ke(t))),this.S_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.T_(t,this.F_(t)))}catch(t){this.v_=t}this.S_.add(t.toString())},t.prototype.delete=function(t){this.write([new Tn(t,this.Ke(t))]),this.S_.add(t.toString())},t.prototype.commit=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(this.C_(),this.v_)throw this.v_;return t=this.p_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=D.D(n);e.mutations.push(new An(r,e.Ke(r)))})),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=I(t),i=Oe(n.serializer)+"/documents",o={writes:e.map((function(t){return Ce(n.serializer,t)}))},[4,n.Mu("Commit",i,o)];case 1:return r.sent(),[2]}}))}))}(this.zu,this.mutations)];case 1:return n.sent(),this.b_=!0,[2]}}))}))},t.prototype.N_=function(t){var e;if(t instanceof kn)e=t.version;else{if(!(t instanceof On))throw _();e=ct.min()}var n=this.p_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new l(a.ABORTED,"Document version changed between two reads.")}else this.p_.set(t.key.toString(),e)},t.prototype.Ke=function(t){var e=this.p_.get(t.toString());return!this.S_.has(t.toString())&&e?hn.updateTime(e):hn.Ge()},t.prototype.F_=function(t){var e=this.p_.get(t.toString());if(!this.S_.has(t.toString())&&e){if(e.isEqual(ct.min()))throw new l(a.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hn.updateTime(e)}return hn.exists(!0)},t.prototype.write=function(t){this.C_(),this.mutations=this.mutations.concat(t)},t.prototype.C_=function(){},t}(),qu=function(){function t(t,e,n,r){this.os=t,this.zu=e,this.updateFunction=n,this.hs=r,this.x_=5,this.gs=new dr(this.os,"transaction_retry")}return t.prototype.run=function(){this.k_()},t.prototype.k_=function(){var t=this;this.gs.Rn((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return r.__generator(this,(function(r){return t=new Fu(this.zu),(e=this.M_(t))&&e.then((function(e){n.os.ds((function(){return t.commit().then((function(){n.hs.resolve(e)})).catch((function(t){n.O_(t)}))}))})).catch((function(t){n.O_(t)})),[2]}))}))}))},t.prototype.M_=function(t){try{var e=this.updateFunction(t);return!ht(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},t.prototype.O_=function(t){var e=this;this.x_>0&&this.L_(t)?(this.x_-=1,this.os.ds((function(){return e.k_(),Promise.resolve()}))):this.hs.reject(t)},t.prototype.L_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!It(e)}return!1},t}(),ju=function(){function t(t,e){this.credentials=t,this.os=e,this.clientId=X.k(),this.B_=new hr}return t.prototype.start=function(t,e,n,i){var o=this;this.q_(),this.Sl=t;var s=new hr,u=!1;return this.credentials.Jc((function(t){if(!u)return u=!0,y("FirestoreClient","Initializing. user=",t.uid),o.U_(e,n,i,t,s).then(o.B_.resolve,o.B_.reject);o.os.Ds((function(){return function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return(n=I(t)).os.Fs(),y("RemoteStore","RemoteStore received new credentials"),i=Wo(n),n.Xu.add(3),[4,Fo(n)];case 1:return r.sent(),i&&n.nh.set("Unknown"),[4,n.Hu.Zl(e)];case 2:return r.sent(),n.Xu.delete(3),[4,Mo(n)];case 3:return r.sent(),[2]}}))}))}(o.Sh,t)}))})),this.os.ds((function(){return o.B_.promise})),s.promise},t.prototype.enableNetwork=function(){var t=this;return this.q_(),this.os.enqueue((function(){return t.persistence.sc(!0),function(t){var e=I(t);return e.Xu.delete(0),Mo(e)}(t.Sh)}))},t.prototype.U_=function(t,e,n,i,o){return r.__awaiter(this,void 0,void 0,(function(){var s,u,a=this;return r.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),s={os:this.os,Sl:this.Sl,clientId:this.clientId,credentials:this.credentials,Kl:i,Nh:100,persistenceSettings:n},[4,t.initialize(s)];case 1:return c.sent(),[4,e.initialize(t,s)];case 2:return c.sent(),this.persistence=t.persistence,this.Ch=t.Ch,this.Gu=t.Gu,this.Ql=t.Ql,this.zu=e.zu,this.Sh=e.Sh,this._i=e._i,this.Q_=e.Dh,this.Q_.qs=ys.bind(null,this._i),this.Q_.Ws=ms.bind(null,this._i),this.persistence.nc((function(){return r.__awaiter(a,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(u=c.sent(),o.reject(u),!this.W_(u))throw u;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+u),this.U_(new iu,new su,{Gl:!1},i,o))];case 4:return[2]}}))}))},t.prototype.W_=function(t){return"FirebaseError"===t.name?t.code===a.FAILED_PRECONDITION||t.code===a.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.q_=function(){if(this.os.Vs)throw new l(a.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.q_(),this.os.enqueue((function(){return t.persistence.sc(!1),function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return(e=I(t)).Xu.add(0),[4,Fo(e)];case 1:return n.sent(),e.nh.set("Offline"),[2]}}))}))}(t.Sh)}))},t.prototype.terminate=function(){var t=this;this.os.Ss();var e=new hr;return this.os.ps((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.Ql&&this.Ql.stop(),[4,qo(this.Sh)];case 1:return r.sent(),[4,this.Ch.Si()];case 2:return r.sent(),[4,this.persistence.Si()];case 3:return r.sent(),this.credentials.Xc(),e.resolve(),[3,5];case 4:return t=r.sent(),n=Dr(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.q_();var e=new hr;return this.os.ds((function(){return function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:Wo((n=I(t)).Sh)||y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,function(t){var e=I(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.vr.Bo(t)}))}(n.Gu)];case 2:return-1===(i=r.sent())?[2,void e.resolve()]:((o=n.qh.get(i)||[]).push(e),n.qh.set(i,o),[3,4]);case 3:return s=r.sent(),u=Dr(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}(t._i,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.q_();var i=new uu(n),o=new Vr(t,i,e);return this.os.ds((function(){return Lr(r.Q_,o)})),function(){i.e_(),r.os.ds((function(){return Rr(r.Q_,o)}))}},t.prototype.j_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),e=new hr,[2,(this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t,e){var n=I(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.$c.Dr(t,e)}))}(t,e)];case 1:return(i=r.sent())instanceof kn?n.resolve(i):i instanceof On?n.resolve(null):n.reject(new l(a.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=r.sent(),s=Dr(o,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}}))}))}(n.Gu,t,e)})),e.promise)]}}))}))},t.prototype.K_=function(t,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return r.sent(),n=new hr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new uu({next:function(o){e.ds((function(){return Rr(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new l(a.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new l(a.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Vr(Pn(n.path),o,{includeMetadataChanges:!0,Js:!0});return Lr(t,s)}(i.Q_,i.os,t,e,n)})),n.promise)]}}))}))},t.prototype.G_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),e=new hr,[2,(this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Io(t,e,!0)];case 1:return i=r.sent(),o=new ls(e,i.kc),s=o.Th(i.documents),u=o.gr(s,!1),n.resolve(u.snapshot),[3,3];case 2:return a=r.sent(),c=Dr(a,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))}(n.Gu,t,e)})),e.promise)]}}))}))},t.prototype.z_=function(t,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return r.sent(),n=new hr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new uu({next:function(n){e.ds((function(){return Rr(t,s)})),n.fromCache&&"server"===r.source?i.reject(new l(a.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Vr(n,o,{includeMetadataChanges:!0,Js:!0});return Lr(t,s)}(i.Q_,i.os,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.q_();var n=new hr;return this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:i=Bs(t),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,function(t,e){var n,r=I(t),i=at.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Ut());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.$c.$r(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=vn(c,n.get(c.key));null!=h&&s.push(new wn(c.key,h,xn(h.proto.mapValue),hn.exists(!0)))}return r.vr.xo(t,i,s,e)}))})).then((function(t){var e=t.hr(n);return{batchId:t.batchId,dr:e}}))}(i.Gu,e)];case 2:return o=r.sent(),i.Ch.Fi(o.batchId),function(t,e,n){var r=t.Bh[t.currentUser.Zs()];r||(r=new Tt($)),r=r.rt(e,n),t.Bh[t.currentUser.Zs()]=r}(i,o.batchId,n),[4,Os(i,o.dr)];case 3:return r.sent(),[4,ts(i.Sh)];case 4:return r.sent(),[3,6];case 5:return s=r.sent(),u=Dr(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}(e._i,t,n)})),n.promise},t.prototype.U=function(){return this.Sl.U},t.prototype.H_=function(t){var e=this;this.q_();var n=new uu(t);return this.os.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,function(t,e){I(t).Bs.add(e),e.next()}(this.Q_,n)]}))}))})),function(){n.e_(),e.os.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,function(t,e){I(t).Bs.delete(e)}(this.Q_,n)]}))}))}))}},Object.defineProperty(t.prototype,"Y_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.q_();var n=new hr;return this.os.ds((function(){return new qu(e.os,e.zu,t,n).run(),Promise.resolve()})),n.promise},t}();function Gu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Bu=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.J_=n,this.X_=r,this.Z_=i}return t.prototype.tf=function(t){switch(te(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ue(t.integerValue||t.doubleValue);case 3:return this.ef(t.timestampValue);case 4:return this.nf(t);case 5:return t.stringValue;case 6:return this.Z_(ae(t.bytesValue));case 7:return this.sf(t.referenceValue);case 8:return this.if(t.geoPointValue);case 9:return this.rf(t.arrayValue);case 10:return this.af(t.mapValue);default:throw _()}},t.prototype.af=function(t){var e=this,n={};return T(t.fields||{},(function(t,r){n[t]=e.tf(r)})),n},t.prototype.if=function(t){return new mu(ue(t.latitude),ue(t.longitude))},t.prototype.rf=function(t){var e=this;return(t.values||[]).map((function(t){return e.tf(t)}))},t.prototype.nf=function(t){switch(this.J_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return $t(n)?t(n):n}(t);return null==e?null:this.tf(e);case"estimate":return this.ef(Jt(t));default:return null}},t.prototype.ef=function(t){var e=se(t),n=new at(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.sf=function(t){var e=N.P(t);g(We(e));var n=new rt(e.get(1),e.get(3)),r=new D(e.u(5));return n.isEqual(this.U)||p("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.X_(r)},t}(),zu=si.uo,Qu=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new l(a.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else U("settings","non-empty string","host",t.host),this.host=t.host,V("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(z("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),V("settings","object","credentials",t.credentials),this.credentials=t.credentials,V("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),V("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?p("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&p("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,V("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=si.lo;else{if(t.cacheSizeBytes!==zu&&t.cacheSizeBytes<si.ho)throw new l(a.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+si.ho);this.cacheSizeBytes=t.cacheSizeBytes}V("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Ku=function(){function t(e,n,i,o){var s=this;if(void 0===i&&(i=new iu),void 0===o&&(o=new su),this.cf=i,this.uf=o,this.hf=null,this.lf=new xr,this.INTERNAL={delete:function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this._f(),[4,this.ff.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var u=e;this.hf=u,this.d_=t.df(u),this.wf=u.name,this.mf=new Do(n)}else{var c=e;if(!c.projectId)throw new l(a.INVALID_ARGUMENT,"Must provide projectId");this.d_=new rt(c.projectId,c.database),this.wf="[DEFAULT]",this.mf=new xo}this.Tf=new Qu({})}return Object.defineProperty(t.prototype,"Ef",{get:function(){return this.If||(this.If=new Nu(this.d_,this.Tf.ignoreUndefinedProperties)),this.If},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){O("Firestore.settings",arguments,1),C("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Tf),t)).merge;var e=new Qu(t);if(this.ff&&!this.Tf.isEqual(e))throw new l(a.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.Tf=e,void 0!==e.credentials&&(this.mf=function(t){if(!t)return new xo;switch(t.type){case"gapi":var e=t.client;return g(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Oo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new l(a.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this._f(),this.ff.enableNetwork()},t.prototype.disableNetwork=function(){return this._f(),this.ff.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.ff)throw new l(a.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&p("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new l(a.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Af(this.cf,this.uf,{Gl:!0,cacheSizeBytes:this.Tf.cacheSizeBytes,synchronizeTabs:r,La:i})},t.prototype.clearPersistence=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){if(void 0!==this.ff&&!this.ff.Y_)throw new l(a.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new hr,[2,(this.lf.ps((function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cf.clearPersistence(this.d_,this.wf)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"Rf",{get:function(){return this._f(),this.ff.Y_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this._f(),this.ff.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this._f(),Gu(t))return this.ff.H_(t);C("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ff.H_(e)},t.prototype._f=function(){return this.ff||this.Af(new iu,new su,{Gl:!1}),this.ff},t.prototype.Pf=function(){return new st(this.d_,this.wf,this.Tf.host,this.Tf.ssl,this.Tf.experimentalForceLongPolling)},t.prototype.Af=function(t,e,n){var r=this.Pf();return this.ff=new ju(this.mf,this.lf),this.ff.start(r,t,e,n)},t.df=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new l(a.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new l(a.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new rt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.hf)throw new l(a.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.hf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return O("Firestore.collection",arguments,1),C("Firestore.collection","non-empty string",1,t),this._f(),new ua(N.P(t),this,null)},t.prototype.doc=function(t){return O("Firestore.doc",arguments,1),C("Firestore.doc","non-empty string",1,t),this._f(),Yu.gf(N.P(t),this,null)},t.prototype.collectionGroup=function(t){if(O("Firestore.collectionGroup",arguments,1),C("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new l(a.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._f(),new oa(function(t){return new Rn(N.g(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return O("Firestore.runTransaction",arguments,1),C("Firestore.runTransaction","function",1,t),this._f().transaction((function(n){return t(new Wu(e,n))}))},t.prototype.batch=function(){return this._f(),new Hu(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(v()){case c.LogLevel.DEBUG:return"debug";case c.LogLevel.ERROR:return"error";case c.LogLevel.SILENT:return"silent";case c.LogLevel.WARN:return"warn";case c.LogLevel.INFO:return"info";case c.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;O("Firestore.setLogLevel",arguments,1),F("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,d.setLogLevel(e)},t.prototype.yf=function(){return this.Tf.timestampsInSnapshots},t.prototype.Vf=function(){return this.Tf},t}(),Wu=function(){function t(t,e){this.pf=t,this.bf=e}return t.prototype.get=function(t){var e=this;O("Transaction.get",arguments,1);var n=fa("Transaction.get",t,this.pf);return this.bf.D_([n.w_]).then((function(t){if(!t||1!==t.length)return _();var r=t[0];if(r instanceof On)return new $u(e.pf,n.w_,null,!1,!1,n.m_);if(r instanceof kn)return new $u(e.pf,n.w_,r,!1,!1,n.m_);throw _()}))},t.prototype.set=function(t,e,n){R("Transaction.set",arguments,2,3);var r=fa("Transaction.set",t,this.pf);n=aa("Transaction.set",n);var i=pa(r.m_,e,n),o=Su(this.pf.Ef,"Transaction.set",r.w_,i,null!==r.m_,n);return this.bf.set(r.w_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof cu?(L("Transaction.update",arguments,3),r=fa("Transaction.update",t,this.pf),i=Du(this.pf.Ef,"Transaction.update",r.w_,e,n,o)):(O("Transaction.update",arguments,2),r=fa("Transaction.update",t,this.pf),i=xu(this.pf.Ef,"Transaction.update",r.w_,e)),this.bf.update(r.w_,i),this},t.prototype.delete=function(t){O("Transaction.delete",arguments,1);var e=fa("Transaction.delete",t,this.pf);return this.bf.delete(e.w_),this},t}(),Hu=function(){function t(t){this.pf=t,this.vf=[],this.Sf=!1}return t.prototype.set=function(t,e,n){R("WriteBatch.set",arguments,2,3),this.Df();var r=fa("WriteBatch.set",t,this.pf);n=aa("WriteBatch.set",n);var i=pa(r.m_,e,n),o=Su(this.pf.Ef,"WriteBatch.set",r.w_,i,null!==r.m_,n);return this.vf=this.vf.concat(o.T_(r.w_,hn.Ge())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Df(),"string"==typeof e||e instanceof cu?(L("WriteBatch.update",arguments,3),r=fa("WriteBatch.update",t,this.pf),i=Du(this.pf.Ef,"WriteBatch.update",r.w_,e,n,o)):(O("WriteBatch.update",arguments,2),r=fa("WriteBatch.update",t,this.pf),i=xu(this.pf.Ef,"WriteBatch.update",r.w_,e)),this.vf=this.vf.concat(i.T_(r.w_,hn.exists(!0))),this},t.prototype.delete=function(t){O("WriteBatch.delete",arguments,1),this.Df();var e=fa("WriteBatch.delete",t,this.pf);return this.vf=this.vf.concat(new Tn(e.w_,hn.Ge())),this},t.prototype.commit=function(){return this.Df(),this.Sf=!0,this.vf.length>0?this.pf._f().write(this.vf):Promise.resolve()},t.prototype.Df=function(){if(this.Sf)throw new l(a.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Yu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.d_,e,r)||this).w_=e,i.firestore=n,i.m_=r,i.ff=i.firestore._f(),i}return r.__extends(e,t),e.gf=function(t,n,r){if(t.length%2!=0)throw new l(a.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new e(new D(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new ua(this.w_.path.h(),this.firestore,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.w_.path.R()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(O("DocumentReference.collection",arguments,1),C("DocumentReference.collection","non-empty string",1,t),!t)throw new l(a.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=N.P(t);return new ua(this.w_.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.w_.isEqual(t.w_)&&this.m_===t.m_},e.prototype.set=function(t,e){R("DocumentReference.set",arguments,1,2),e=aa("DocumentReference.set",e);var n=pa(this.m_,t,e),r=Su(this.firestore.Ef,"DocumentReference.set",this.w_,n,null!==this.m_,e);return this.ff.write(r.T_(this.w_,hn.Ge()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof cu?(L("DocumentReference.update",arguments,2),n=Du(this.firestore.Ef,"DocumentReference.update",this.w_,t,e,r)):(O("DocumentReference.update",arguments,1),n=xu(this.firestore.Ef,"DocumentReference.update",this.w_,t)),this.ff.write(n.T_(this.w_,hn.exists(!0)))},e.prototype.delete=function(){return O("DocumentReference.delete",arguments,0),this.ff.write([new Tn(this.w_,hn.Ge())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];R("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Gu(i[u])||(z("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),V("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Gu(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else C("DocumentReference.onSnapshot","function",u,i[u]),P("DocumentReference.onSnapshot","function",u+1,i[u+1]),P("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.Cf(t))},error:i[u+1],complete:i[u+2]};return this.ff.listen(Pn(this.w_.path),a,h)},e.prototype.get=function(t){var e=this;R("DocumentReference.get",arguments,0,1),ha("DocumentReference.get",t);var n=this.firestore._f();return t&&"cache"===t.source?n.j_(this.w_).then((function(t){return new $u(e.firestore,e.w_,t,!0,t instanceof kn&&t.Ye,e.m_)})):n.K_(this.w_,t).then((function(t){return e.Cf(t)}))},e.prototype.withConverter=function(t){return new e(this.w_,this.firestore,t)},e.prototype.Cf=function(t){var e=t.docs.get(this.w_);return new $u(this.firestore,this.w_,e,t.fromCache,t.hasPendingWrites,this.m_)},e}(_u),Xu=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$u=function(){function t(t,e,n,r,i,o){this.pf=t,this.w_=e,this.Nf=n,this.Ff=r,this.$f=i,this.m_=o}return t.prototype.data=function(t){var e=this;if(R("DocumentSnapshot.data",arguments,0,1),t=ca("DocumentSnapshot.data",t),this.Nf){if(this.m_){var n=new Ju(this.pf,this.w_,this.Nf,this.Ff,this.$f,null);return this.m_.fromFirestore(n,t)}return new Bu(this.pf.d_,this.pf.yf(),t.serverTimestamps||"none",(function(t){return new Yu(t,e.pf,null)}),(function(t){return new ot(t)})).tf(this.Nf.sn())}},t.prototype.get=function(t,e){var n=this;if(R("DocumentSnapshot.get",arguments,1,2),e=ca("DocumentSnapshot.get",e),this.Nf){var r=this.Nf.data().field(Pu("DocumentSnapshot.get",t,this.w_));if(null!==r)return new Bu(this.pf.d_,this.pf.yf(),e.serverTimestamps||"none",(function(t){return new Yu(t,n.pf,n.m_)}),(function(t){return new ot(t)})).tf(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Yu(this.w_,this.pf,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Nf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Xu(this.$f,this.Ff)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","DocumentSnapshot",1,e);return this.pf===e.pf&&this.Ff===e.Ff&&this.w_.isEqual(e.w_)&&(null===this.Nf?null===e.Nf:this.Nf.isEqual(e.Nf))&&this.m_===e.m_},t}(),Ju=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}($u);function Zu(t,e,n,r,i,o,s){var u;if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new l(a.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){na(s,o);for(var c=[],h=0,f=s;h<f.length;h++){var p=f[h];c.push(ea(r,t,p))}u={arrayValue:{values:c}}}else u=ea(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||na(s,o),u=ku(n,e,s,"in"===o||"not-in"===o);var d=$n.create(i,o,u);return function(t,e){if(e.un()){var n=Fn(t);if(null!==n&&!n.isEqual(e.field))throw new l(a.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Mn(t);null!==r&&ra(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new l(a.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new l(a.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,d),d}function ta(t,e,n){if(null!==t.startAt)throw new l(a.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new l(a.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new fr(e,n);return function(t,e){if(null===Mn(t)){var n=Fn(t);null!==n&&ra(t,n,e.field)}}(t,r),r}function ea(t,e,n){if("string"==typeof n){if(""===n)throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qn(e)&&-1!==n.indexOf("/"))throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(N.P(n));if(!D.F(r))throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ce(t,new D(r))}if(n instanceof _u)return ce(t,n.w_);throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+B(n)+".")}function na(t,e){if(!Array.isArray(t)||0===t.length)throw new l(a.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new l(a.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new l(a.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new l(a.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function ra(t,e,n){if(!n.isEqual(e))throw new l(a.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ia(t){if(Vn(t)&&0===t.rn.length)throw new l(a.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var oa=function(){function t(t,e,n){this.xf=t,this.firestore=e,this.m_=n}return t.prototype.where=function(e,n,r){O("Query.where",arguments,3),q("Query.where",3,r);var i=F("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),o=Pu("Query.where",e),s=Zu(this.xf,"Query.where",this.firestore.Ef,this.firestore.d_,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new Rn(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.on,t.startAt,t.endAt)}(this.xf,s),this.firestore,this.m_)},t.prototype.orderBy=function(e,n){var r;if(R("Query.orderBy",arguments,1,2),P("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new l(a.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Pu("Query.orderBy",e),o=ta(this.xf,i,r);return new t(function(t,e){var n=t.rn.concat([e]);return new Rn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(this.xf,o),this.firestore,this.m_)},t.prototype.limit=function(e){return O("Query.limit",arguments,1),C("Query.limit","number",1,e),K("Query.limit",1,e),new t(Bn(this.xf,e,"F"),this.firestore,this.m_)},t.prototype.limitToLast=function(e){return O("Query.limitToLast",arguments,1),C("Query.limitToLast","number",1,e),K("Query.limitToLast",1,e),new t(Bn(this.xf,e,"L"),this.firestore,this.m_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];L("Query.startAt",arguments,1);var i=this.kf("Query.startAt",e,n,!0);return new t(zn(this.xf,i),this.firestore,this.m_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];L("Query.startAfter",arguments,1);var i=this.kf("Query.startAfter",e,n,!1);return new t(zn(this.xf,i),this.firestore,this.m_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];L("Query.endBefore",arguments,1);var i=this.kf("Query.endBefore",e,n,!0);return new t(Qn(this.xf,i),this.firestore,this.m_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];L("Query.endAt",arguments,1);var i=this.kf("Query.endAt",e,n,!1);return new t(Qn(this.xf,i),this.firestore,this.m_)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","Query",1,e);return this.firestore===e.firestore&&Kn(this.xf,e.xf)&&this.m_===e.m_},t.prototype.withConverter=function(e){return new t(this.xf,this.firestore,e)},t.prototype.kf=function(t,e,n,i){if(q(t,1,e),e instanceof $u)return O(t,r.__spreadArrays([e],n),1),function(t,e,n,r,i){if(!r)throw new l(a.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=jn(t);s<u.length;s++){var c=u[s];if(c.field.p())o.push(ce(e,r.key));else{var h=r.field(c.field);if($t(h))throw new l(a.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===h){var f=c.field.R();throw new l(a.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+f+"' (used as the orderBy) does not exist.")}o.push(h)}}return new sr(o,i)}(this.xf,this.firestore.d_,t,e.Nf,i);var o=[e].concat(n);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new l(a.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],c=0;c<i.length;c++){var h=i[c];if(s[c].field.p()){if("string"!=typeof h)throw new l(a.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!qn(t)&&-1!==h.indexOf("/"))throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var f=t.path.child(N.P(h));if(!D.F(f))throw new l(a.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+f+"' is not because it contains an odd number of segments.");var p=new D(f);u.push(ce(e,p))}else{var d=ku(n,r,h);u.push(d)}}return new sr(u,o)}(this.xf,this.firestore.d_,this.firestore.Ef,t,o,i)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];R("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||Gu(i[u])||(z("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),V("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),Gu(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else C("Query.onSnapshot","function",u,i[u]),P("Query.onSnapshot","function",u+1,i[u+1]),P("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new sa(r.firestore,r.xf,t,r.m_))},error:i[u+1],complete:i[u+2]};return ia(this.xf),this.firestore._f().listen(this.xf,s,c)},t.prototype.get=function(t){var e=this;R("Query.get",arguments,0,1),ha("Query.get",t),ia(this.xf);var n=this.firestore._f();return(t&&"cache"===t.source?n.G_(this.xf):n.z_(this.xf,t)).then((function(t){return new sa(e.firestore,e.xf,t,e.m_)}))},t}(),sa=function(){function t(t,e,n,r){this.pf=t,this.Mf=e,this.Of=n,this.m_=r,this.Lf=null,this.Bf=null,this.metadata=new Xu(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Of.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Of.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;R("QuerySnapshot.forEach",arguments,1,2),C("QuerySnapshot.forEach","function",1,t),this.Of.docs.forEach((function(r){t.call(e,n.qf(r,n.metadata.fromCache,n.Of.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new oa(this.Mf,this.pf,this.m_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(z("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),V("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Of.jt)throw new l(a.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Lf&&this.Bf===e||(this.Lf=function(t,e,n){if(t.Ut.m()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Ut;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:la(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Of,e,this.qf.bind(this)),this.Bf=e),this.Lf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","QuerySnapshot",1,e);return this.pf===e.pf&&Kn(this.Mf,e.Mf)&&this.Of.isEqual(e.Of)&&this.m_===e.m_},t.prototype.qf=function(t,e,n){return new Ju(this.pf,t.key,t,e,n,this.m_)},t}(),ua=function(t){function e(e,n,r){var i=this;if((i=t.call(this,Pn(e),n,r)||this).Uf=e,e.length%2!=1)throw new l(a.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.R()+" has "+e.length);return i}return r.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.xf.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.xf.path.h();return t.m()?null:new Yu(new D(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.xf.path.R()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){R("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=X.k()),C("CollectionReference.doc","non-empty string",1,t);var e=N.P(t);return Yu.gf(this.xf.path.child(e),this.firestore,this.m_)},e.prototype.add=function(t){O("CollectionReference.add",arguments,1);var e=this.m_?this.m_.toFirestore(t):t;C("CollectionReference.add","object",1,e);var n=this.doc();return new Yu(n.w_,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Uf,this.firestore,t)},e}(oa);function aa(t,e){if(void 0===e)return{merge:!1};if(z(t,e,["merge","mergeFields"]),V(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+B(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new l(a.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+B(r[o]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof cu}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new l(a.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ca(t,e){return void 0===e?{}:(z(t,e,["serverTimestamps"]),M(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ha(t,e){P(t,"object",1,e),e&&(z(t,e,["source"]),M(t,0,"source",e.source,["default","server","cache"]))}function fa(t,e,n){if(e instanceof _u){if(e.firestore!==n)throw new l(a.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Q(t,"DocumentReference",1,e)}function la(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _()}}function pa(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.serverTimestamp=function(){k("FieldValue.serverTimestamp",arguments);var t=new du("serverTimestamp");return t.s_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){k("FieldValue.delete",arguments);var t=new lu("deleteField");return t.s_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];L("FieldValue.arrayUnion",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return L("arrayUnion()",arguments,1),new vu("arrayUnion",t)}.apply(void 0,t);return r.s_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];L("FieldValue.arrayRemove",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return L("arrayRemove()",arguments,1),new yu("arrayRemove",t)}.apply(void 0,t);return r.s_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){C("FieldValue.increment","number",1,t),O("FieldValue.increment",arguments,1);var n=function(t){return new gu("increment",t)}(t);return n.s_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},e}(wu),va={Firestore:Ku,GeoPoint:mu,Timestamp:at,Blob:ot,Transaction:Wu,WriteBatch:Hu,DocumentReference:Yu,DocumentSnapshot:$u,Query:oa,QueryDocumentSnapshot:Ju,QuerySnapshot:sa,CollectionReference:ua,FieldPath:cu,FieldValue:da,setLogLevel:Ku.setLogLevel,CACHE_SIZE_UNLIMITED:zu};function ya(t){!function(t,e){t.INTERNAL.registerComponent(new f.Component("firestore",(function(t){return function(t,e){var n=new su,r=new ou(n);return new Ku(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},va)))}(t),t.registerVersion("@firebase/firestore","1.17.2")}ya(u.default),e.__PRIVATE_registerFirestore=ya}).call(this,n(117))},252:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",(function(){return sr})),n.d(e,"EventType",(function(){return ur})),n.d(e,"WebChannel",(function(){return ar})),n.d(e,"XhrIo",(function(){return cr})),n.d(e,"createWebChannelTransport",(function(){return or}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)};function o(t){var s="function"==typeof Symbol&&Symbol.iterator,e=s&&t[s],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}var g,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},h=h||{},f=c||self;function l(){}function d(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function v(a){var b=d(a);return"array"==b||"object"==b&&"number"==typeof a.length}function y(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var m="closure_uid_"+(1e9*Math.random()>>>0),w=0;function _(a,b,t){return a.call.apply(a.bind,arguments)}function I(a,b,t){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,e),a.apply(b,t)}}return function(){return a.apply(b,arguments)}}function p(a,b,t){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:I).apply(null,arguments)}function E(a,b){var t=Array.prototype.slice.call(arguments,1);return function(){var e=t.slice();return e.push.apply(e,arguments),a.apply(this,e)}}var q=Date.now;function T(a,b){function t(){}t.prototype=b.prototype,a.S=b.prototype,a.prototype=new t,a.prototype.constructor=a}function u(){this.j=this.j,this.i=this.i}u.prototype.j=!1,u.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(a){Object.prototype.hasOwnProperty.call(a,m)&&a[m]||(a[m]=++w)})(this)},u.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var A=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var t=0;t<a.length;t++)if(t in a&&a[t]===b)return t;return-1},N=Array.prototype.forEach?function(a,b,t){Array.prototype.forEach.call(a,b,t)}:function(a,b,t){for(var e=a.length,n="string"==typeof a?a.split(""):a,r=0;r<e;r++)r in n&&b.call(t,n[r],r,a)};function S(a){return Array.prototype.concat.apply([],arguments)}function x(a){var b=a.length;if(0<b){for(var t=Array(b),e=0;e<b;e++)t[e]=a[e];return t}return[]}function D(a){return/^[\s\xa0]*$/.test(a)}var k,O=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function L(a,b){return-1!=a.indexOf(b)}function R(a,b){return a<b?-1:a>b?1:0}t:{var C=f.navigator;if(C){var P=C.userAgent;if(P){k=P;break t}}k=""}function U(a,b,t){for(var e in a)b.call(t,a[e],e,a)}function V(a){var b={};for(var t in a)b[t]=a[t];return b}var M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(a,b){for(var t,e,n=1;n<arguments.length;n++){for(t in e=arguments[n])a[t]=e[t];for(var r=0;r<M.length;r++)t=M[r],Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}}function j(a){return j[" "](a),a}j[" "]=l;var G,a,B=L(k,"Opera"),z=L(k,"Trident")||L(k,"MSIE"),Q=L(k,"Edge"),K=Q||z,W=L(k,"Gecko")&&!(L(k.toLowerCase(),"webkit")&&!L(k,"Edge"))&&!(L(k,"Trident")||L(k,"MSIE"))&&!L(k,"Edge"),H=L(k.toLowerCase(),"webkit")&&!L(k,"Edge");function Y(){var a=f.document;return a?a.documentMode:void 0}t:{var X="",$=(a=k,W?/rv:([^\);]+)(\)|;)/.exec(a):Q?/Edge\/([\d\.]+)/.exec(a):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):H?/WebKit\/(\S+)/.exec(a):B?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if($&&(X=$?$[1]:""),z){var J=Y();if(null!=J&&J>parseFloat(X)){G=String(J);break t}}G=X}var Z,tt={};function et(a){return function(a,b){var t=tt;return Object.prototype.hasOwnProperty.call(t,a)?t[a]:t[a]=b(a)}(a,(function(){for(var b=0,t=O(String(G)).split("."),e=O(String(a)).split("."),n=Math.max(t.length,e.length),r=0;0==b&&r<n;r++){var o=t[r]||"",c=e[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],c=/(\d*)(\D*)(.*)/.exec(c)||["","","",""],0==o[0].length&&0==c[0].length)break;b=R(0==o[1].length?0:parseInt(o[1],10),0==c[1].length?0:parseInt(c[1],10))||R(0==o[2].length,0==c[2].length)||R(o[2],c[2]),o=o[3],c=c[3]}while(0==b)}return 0<=b}))}if(f.document&&z){var nt=Y();Z=nt||(parseInt(G,10)||void 0)}else Z=void 0;var it=Z,ot=!z||9<=Number(it),st=z&&!et("9"),ut=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{f.addEventListener("test",l,b),f.removeEventListener("test",l,b)}catch(t){}return a}();function at(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function ct(a,b){if(at.call(this,a?a.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,a){var t=this.type=a.type,e=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(W){t:{try{j(b.nodeName);var n=!0;break t}catch(t){}n=!1}n||(b=null)}}else"mouseover"==t?b=a.fromElement:"mouseout"==t&&(b=a.toElement);this.relatedTarget=b,e?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:ht[a.pointerType]||"",this.c=a,a.defaultPrevented&&this.b()}}at.prototype.b=function(){this.defaultPrevented=!0},T(ct,at);var ht={2:"touch",3:"pen",4:"mouse"};ct.prototype.b=function(){ct.S.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,st)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(t){}};var ft="closure_listenable_"+(1e6*Math.random()|0),lt=0;function pt(a,b,t,e,n){this.listener=a,this.proxy=null,this.src=b,this.type=t,this.capture=!!e,this.ca=n,this.key=++lt,this.Y=this.Z=!1}function vt(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function yt(a){this.src=a,this.a={},this.b=0}function gt(a,b){var t=b.type;if(t in a.a){var e,n=a.a[t],r=A(n,b);(e=0<=r)&&Array.prototype.splice.call(n,r,1),e&&(vt(b),0==a.a[t].length&&(delete a.a[t],a.b--))}}function mt(a,b,t,e){for(var n=0;n<a.length;++n){var r=a[n];if(!r.Y&&r.listener==b&&r.capture==!!t&&r.ca==e)return n}return-1}yt.prototype.add=function(a,b,t,e,n){var r=a.toString();(a=this.a[r])||(a=this.a[r]=[],this.b++);var o=mt(a,b,e,n);return-1<o?(b=a[o],t||(b.Z=!1)):((b=new pt(b,this.src,r,!!e,n)).Z=t,a.push(b)),b};var wt="closure_lm_"+(1e6*Math.random()|0),bt={};function _t(a,b,t,e,n){if(e&&e.once)return function t(a,b,e,n,r){if(Array.isArray(b)){for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);return null}return e=Dt(e),a&&a[ft]?a.wa(b,e,y(n)?!!n.capture:!!n,r):It(a,b,e,!0,n,r)}(a,b,t,e,n);if(Array.isArray(b)){for(var r=0;r<b.length;r++)_t(a,b[r],t,e,n);return null}return t=Dt(t),a&&a[ft]?a.va(b,t,y(e)?!!e.capture:!!e,n):It(a,b,t,!1,e,n)}function It(a,b,t,e,n,r){if(!b)throw Error("Invalid event type");var o=y(n)?!!n.capture:!!n;if(o&&!ot)return null;var c=St(a);if(c||(a[wt]=c=new yt(a)),(t=c.add(b,t,e,o,r)).proxy)return t;if(e=function(){var a=Nt,b=ot?function(t){return a.call(b.src,b.listener,t)}:function(t){if(!(t=a.call(b.src,b.listener,t)))return t};return b}(),t.proxy=e,e.src=a,e.listener=t,a.addEventListener)ut||(n=o),void 0===n&&(n=!1),a.addEventListener(b.toString(),e,n);else if(a.attachEvent)a.attachEvent(Tt(b.toString()),e);else{if(!a.addListener||!a.removeListener)throw Error("addEventListener and attachEvent are unavailable.");a.addListener(e)}return t}function Et(a){if("number"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[ft])gt(b.c,a);else{var t=a.type,e=a.proxy;b.removeEventListener?b.removeEventListener(t,e,a.capture):b.detachEvent?b.detachEvent(Tt(t),e):b.addListener&&b.removeListener&&b.removeListener(e),(t=St(b))?(gt(t,a),0==t.b&&(t.src=null,b[wt]=null)):vt(a)}}}function Tt(a){return a in bt?bt[a]:bt[a]="on"+a}function At(a,b){var t=a.listener,e=a.ca||a.src;return a.Z&&Et(a),t.call(e,b)}function Nt(a,b){if(a.Y)return!0;if(!ot){if(!b)t:{b=["window","event"];for(var t=f,e=0;e<b.length;e++)if(null==(t=t[b[e]])){b=null;break t}b=t}return At(a,b=new ct(b,this))}return At(a,new ct(b,this))}function St(a){return(a=a[wt])instanceof yt?a:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dt(a){return"function"==d(a)?a:(a[xt]||(a[xt]=function(b){return a.handleEvent(b)}),a[xt])}function kt(){u.call(this),this.c=new yt(this),this.J=this,this.C=null}function Ot(a,b,t,e){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var n=!0,r=0;r<b.length;++r){var o=b[r];if(o&&!o.Y&&o.capture==t){var c=o.listener,h=o.ca||o.src;o.Z&&gt(a.c,o),n=!1!==c.call(h,e)&&n}}return n&&!e.defaultPrevented}T(kt,u),kt.prototype[ft]=!0,(g=kt.prototype).addEventListener=function(a,b,t,e){_t(this,a,b,t,e)},g.removeEventListener=function(a,b,t,e){!function t(a,b,e,n,r){if(Array.isArray(b))for(var o=0;o<b.length;o++)t(a,b[o],e,n,r);else n=y(n)?!!n.capture:!!n,e=Dt(e),a&&a[ft]?(a=a.c,(b=String(b).toString())in a.a&&(-1<(e=mt(o=a.a[b],e,n,r))&&(vt(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete a.a[b],a.b--)))):a&&(a=St(a))&&(b=a.a[b.toString()],a=-1,b&&(a=mt(b,e,n,r)),(e=-1<a?b[a]:null)&&Et(e))}(this,a,b,t,e)},g.dispatchEvent=function(a){var b,t=this.C;if(t)for(b=[];t;t=t.C)b.push(t);t=this.J;var e=a.type||a;if("string"==typeof a)a=new at(a,t);else if(a instanceof at)a.target=a.target||t;else{var n=a;F(a=new at(e,t),n)}if(n=!0,b)for(var r=b.length-1;0<=r;r--){var o=a.a=b[r];n=Ot(o,e,!0,a)&&n}if(n=Ot(o=a.a=t,e,!0,a)&&n,n=Ot(o,e,!1,a)&&n,b)for(r=0;r<b.length;r++)n=Ot(o=a.a=b[r],e,!1,a)&&n;return n},g.G=function(){if(kt.S.G.call(this),this.c){var t,a=this.c;for(t in a.a){for(var e=a.a[t],n=0;n<e.length;n++)vt(e[n]);delete a.a[t],a.b--}}this.C=null},g.va=function(a,b,t,e){return this.c.add(String(a),b,!1,t,e)},g.wa=function(a,b,t,e){return this.c.add(String(a),b,!0,t,e)};var Lt=f.JSON.stringify;function Rt(){this.b=this.a=null}var Ct,Pt=new(function(){function t(a,b,t){this.f=t,this.c=a,this.g=b,this.b=0,this.a=null}return t.prototype.get=function(){var a;return 0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c(),a},t}())((function(){return new Vt}),(function(a){a.reset()}),100);function Ut(){var a=jt,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function Vt(){this.next=this.b=this.a=null}function Mt(a){f.setTimeout((function(){throw a}),0)}function Ft(a,b){Ct||function(){var a=f.Promise.resolve(void 0);Ct=function(){a.then(Gt)}}(),qt||(Ct(),qt=!0),jt.add(a,b)}Rt.prototype.add=function(a,b){var t=Pt.get();t.set(a,b),this.b?this.b.next=t:this.a=t,this.b=t},Vt.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},Vt.prototype.reset=function(){this.next=this.b=this.a=null};var qt=!1,jt=new Rt;function Gt(){for(var a;a=Ut();){try{a.a.call(a.b)}catch(t){Mt(t)}var b=Pt;b.g(a),b.b<b.f&&(b.b++,a.next=b.a,b.a=a)}qt=!1}function Bt(a,b){kt.call(this),this.b=a||1,this.a=b||f,this.f=p(this.Ya,this),this.g=q()}function zt(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function Qt(a,b,t){if("function"==d(a))t&&(a=p(a,t));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=p(a.handleEvent,a)}return 2147483647<Number(b)?-1:f.setTimeout(a,b||0)}function Kt(a){a.a=Qt((function(){a.a=null,a.c&&(a.c=!1,Kt(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}T(Bt,kt),(g=Bt.prototype).aa=!1,g.M=null,g.Ya=function(){if(this.aa){var a=q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(zt(this),this.start()))}},g.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},g.G=function(){Bt.S.G.call(this),zt(this),delete this.a};var Wt=function(t){function e(a,b,e){var n=t.call(this)||this;return n.g=null!=e?a.bind(e):a,n.h=b,n.b=null,n.c=!1,n.a=null,n}return function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t),e.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:Kt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(f.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(u);function Ht(a){u.call(this),this.b=a,this.a={}}T(Ht,u);var Yt=[];function Xt(a,b,t,e){Array.isArray(t)||(t&&(Yt[0]=t.toString()),t=Yt);for(var n=0;n<t.length;n++){var r=_t(b,t[n],e||a.handleEvent,!1,a.b||a);if(!r)break;a.a[r.key]=r}}function $t(a){U(a.a,(function(b,t){this.a.hasOwnProperty(t)&&Et(b)}),a),a.a={}}function Jt(){this.a=!0}function Zt(a,b,t,e){a.info((function(){return"XMLHTTP TEXT ("+b+"): "+function(a,b){if(!a.a)return b;if(!b)return null;try{var t=JSON.parse(b);if(t)for(a=0;a<t.length;a++)if(Array.isArray(t[a])){var e=t[a];if(!(2>e.length)){var n=e[1];if(Array.isArray(n)&&!(1>n.length)){var r=n[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<n.length;o++)n[o]=""}}}return Lt(t)}catch(t){return b}}(a,t)+(e?" "+e:"")}))}Ht.prototype.G=function(){Ht.S.G.call(this),$t(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Jt.prototype.info=function(){};var te=null;function ee(){return te=te||new kt}function ne(a){at.call(this,"serverreachability",a)}function re(a){var b=ee();b.dispatchEvent(new ne(b,a))}function ie(a){at.call(this,"statevent",a)}function oe(a){var b=ee();b.dispatchEvent(new ie(b,a))}function se(a){at.call(this,"timingevent",a)}function ue(a,b){if("function"!=d(a))throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){a()}),b)}T(ne,at),T(ie,at),T(se,at);var ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ce={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function he(){}function fe(a){var b;return(b=a.a)||(b=a.a={}),b}function le(){}he.prototype.a=null;var pe,de={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ve(){at.call(this,"d")}function ye(){at.call(this,"c")}function ge(){}function me(a,b,t,e){this.g=a,this.c=b,this.f=t,this.T=e||1,this.J=new Ht(this),this.P=we,a=K?125:void 0,this.R=new Bt(a),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}T(ve,at),T(ye,at),T(ge,he),pe=new ge;var we=45e3,be={},_e={};function Ie(a,b,t){a.H=1,a.i=ze(Me(b)),a.j=t,a.I=!0,Ee(a,null)}function Ee(a,b){a.u=q(),Ne(a),a.l=Me(a.i);var t=a.l,e=a.T;Array.isArray(e)||(e=[String(e)]),nn(t.b,"t",e),a.D=0,a.a=Xn(a.g,a.g.C?b:null),0<a.O&&(a.F=new Wt(p(a.Ca,a,a.a),a.O)),Xt(a.J,a.a,"readystatechange",a.Wa),b=a.B?V(a.B):{},a.j?(a.m||(a.m="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.a.ba(a.l,a.m,a.j,b)):(a.m="GET",a.a.ba(a.l,a.m,null,b)),re(1),function(a,b,t,e,n,r){a.info((function(){if(a.a)if(r)for(var o="",c=r.split("&"),h=0;h<c.length;h++){var f=c[h].split("=");if(1<f.length){var l=f[0];f=f[1];var d=l.split("_");o=2<=d.length&&"type"==d[1]?o+(l+"=")+f+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+e+") [attempt "+n+"]: "+b+"\n"+t+"\n"+o}))}(a.c,a.m,a.l,a.f,a.T,a.j)}function Te(a,b,t){for(var e=!0;!a.A&&a.D<t.length;){var n=Ae(a,t);if(n==_e){4==b&&(a.h=4,oe(14),e=!1),Zt(a.c,a.f,null,"[Incomplete Response]");break}if(n==be){a.h=4,oe(15),Zt(a.c,a.f,t,"[Invalid Chunk]"),e=!1;break}Zt(a.c,a.f,n,null),Oe(a,n)}4==b&&0==t.length&&(a.h=1,oe(16),e=!1),a.b=a.b&&e,e?0<t.length&&!a.W&&(a.W=!0,(b=a.g).a==a&&b.V&&!b.F&&(b.c.info("Great, no buffering proxy detected. Bytes received: "+t.length),Gn(b),b.F=!0)):(Zt(a.c,a.f,t,"[Invalid Chunked Response]"),ke(a),De(a))}function Ae(a,b){var t=a.D,e=b.indexOf("\n",t);return-1==e?_e:(t=Number(b.substring(t,e)),isNaN(t)?be:(e+=1)+t>b.length?_e:(b=b.substr(e,t),a.D=e+t,b))}function Ne(a){a.U=q()+a.P,Se(a,a.P)}function Se(a,b){if(null!=a.o)throw Error("WatchDog timer not null");a.o=ue(p(a.Ua,a),b)}function xe(a){a.o&&(f.clearTimeout(a.o),a.o=null)}function De(a){0==a.g.v||a.A||Qn(a.g,a)}function ke(a){xe(a);var b=a.F;b&&"function"==typeof b.ja&&b.ja(),a.F=null,zt(a.R),$t(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function Oe(a,b){try{var t=a.g;if(0!=t.v&&(t.a==a||hn(t.b,a)))if(t.I=a.N,!a.C&&hn(t.b,a)&&3==t.v){try{var e=t.ka.a.parse(b)}catch(t){e=null}if(Array.isArray(e)&&3==e.length){var n=e;if(0==n[0]){t:if(!t.j){if(t.a){if(!(t.a.u+3e3<a.u))break t;zn(t),Rn(t)}jn(t),oe(18)}}else t.oa=n[1],0<t.oa-t.P&&37500>n[2]&&t.H&&0==t.o&&!t.m&&(t.m=ue(p(t.Ra,t),6e3));if(1>=cn(t.b)&&t.ea){try{t.ea()}catch(t){}t.ea=void 0}}else Wn(t,11)}else if((a.C||t.a==a)&&zn(t),!D(b))for(b=e=t.ka.a.parse(b),e=0;e<b.length;e++)if(n=b[e],t.P=n[0],n=n[1],2==t.v)if("c"==n[0]){t.J=n[1],t.ga=n[2];var r=n[3];null!=r&&(t.ha=r,t.c.info("VER="+t.ha));var o=n[4];null!=o&&(t.pa=o,t.c.info("SVER="+t.pa));var c=n[5];if(null!=c&&"number"==typeof c&&0<c){var h=1.5*c;t.D=h,t.c.info("backChannelRequestTimeoutMs_="+h)}h=t;var f=a.a;if(f){var l=f.a?f.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var d=h.b;!d.a&&(L(l,"spdy")||L(l,"quic")||L(l,"h2"))&&(d.f=d.g,d.a=new Set,d.b&&(fn(d,d.b),d.b=null))}if(h.A){var v=f.a?f.a.getResponseHeader("X-HTTP-Session-Id"):null;v&&(h.na=v,Be(h.B,h.A,v))}}t.v=3,t.f&&t.f.ta(),t.V&&(t.N=q()-a.u,t.c.info("Handshake RTT: "+t.N+"ms"));var y=a;if((h=t).la=Yn(h,h.C?h.ga:null,h.fa),y.C){ln(h.b,y);var m=y,w=h.D;w&&m.setTimeout(w),m.o&&(xe(m),Ne(m)),h.a=y}else qn(h);0<t.g.length&&Un(t)}else"stop"!=n[0]&&"close"!=n[0]||Wn(t,7);else 3==t.v&&("stop"==n[0]||"close"==n[0]?"stop"==n[0]?Wn(t,7):Ln(t):"noop"!=n[0]&&t.f&&t.f.sa(n),t.o=0);re(4)}catch(t){}}function Le(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(v(a)||"string"==typeof a)N(a,b,void 0);else{if(a.L&&"function"==typeof a.L)var t=a.L();else if(a.K&&"function"==typeof a.K)t=void 0;else if(v(a)||"string"==typeof a){t=[];for(var e=a.length,n=0;n<e;n++)t.push(n)}else for(n in t=[],e=0,a)t[e++]=n;n=(e=function(a){if(a.K&&"function"==typeof a.K)return a.K();if("string"==typeof a)return a.split("");if(v(a)){for(var b=[],t=a.length,e=0;e<t;e++)b.push(a[e]);return b}for(e in b=[],t=0,a)b[t++]=a[e];return b}(a)).length;for(var r=0;r<n;r++)b.call(void 0,e[r],t&&t[r],a)}}function Re(a,b){this.b={},this.a=[],this.c=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var e=0;e<t;e+=2)this.set(arguments[e],arguments[e+1])}else if(a)if(a instanceof Re)for(t=a.L(),e=0;e<t.length;e++)this.set(t[e],a.get(t[e]));else for(e in a)this.set(e,a[e])}function Ce(a){if(a.c!=a.a.length){for(var b=0,t=0;b<a.a.length;){var e=a.a[b];Pe(a.b,e)&&(a.a[t++]=e),b++}a.a.length=t}if(a.c!=a.a.length){var n={};for(t=b=0;b<a.a.length;)Pe(n,e=a.a[b])||(a.a[t++]=e,n[e]=1),b++;a.a.length=t}}function Pe(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(g=me.prototype).setTimeout=function(a){this.P=a},g.Wa=function(a){a=a.target;var b=this.F;b&&3==xn(a)?b.f():this.Ca(a)},g.Ca=function(a){try{if(a==this.a)t:{var b=xn(this.a),t=this.a.ua(),e=this.a.X();if(!(3>b||3==b&&!K&&!this.a.$())){this.A||4!=b||7==t||re(8==t||0>=e?3:2),xe(this);var n=this.a.X();this.N=n;var r=this.a.$();if(this.b=200==n,function(a,b,t,e,n,r,o){a.info((function(){return"XMLHTTP RESP ("+e+") [ attempt "+n+"]: "+b+"\n"+t+"\n"+r+" "+o}))}(this.c,this.m,this.l,this.f,this.T,b,n),this.b){if(this.V&&!this.C){e:{if(this.a){var o,c=this.a;if((o=c.a?c.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(o)){var h=o;break e}}h=null}if(!h){this.b=!1,this.h=3,oe(12),ke(this),De(this);break t}Zt(this.c,this.f,h,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Oe(this,h)}this.I?(Te(this,b,r),K&&this.b&&3==b&&(Xt(this.J,this.R,"tick",this.Va),this.R.start())):(Zt(this.c,this.f,r,null),Oe(this,r)),4==b&&ke(this),this.b&&!this.A&&(4==b?Qn(this.g,this):(this.b=!1,Ne(this)))}else 400==n&&0<r.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),ke(this),De(this)}}}catch(t){}},g.Va=function(){if(this.a){var a=xn(this.a),b=this.a.$();this.D<b.length&&(xe(this),Te(this,a,b),this.b&&4!=a&&Ne(this))}},g.cancel=function(){this.A=!0,ke(this)},g.Ua=function(){this.o=null;var a=q();0<=a-this.U?(function(a,b){a.info((function(){return"TIMEOUT: "+b}))}(this.c,this.l),2!=this.H&&(re(3),oe(17)),ke(this),this.h=2,De(this)):Se(this,this.U-a)},(g=Re.prototype).K=function(){Ce(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},g.L=function(){return Ce(this),this.a.concat()},g.get=function(a,b){return Pe(this.b,a)?this.b[a]:b},g.set=function(a,b){Pe(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},g.forEach=function(a,b){for(var t=this.L(),e=0;e<t.length;e++){var n=t[e],r=this.get(n);a.call(b,r,n,this)}};var Ue=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ve(a,b){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,a instanceof Ve){this.a=void 0!==b?b:a.a,Fe(this,a.f),this.j=a.j,qe(this,a.c),je(this,a.h),this.g=a.g,b=a.b;var t=new Ze;t.c=b.c,b.a&&(t.a=new Re(b.a),t.b=b.b),Ge(this,t),this.i=a.i}else a&&(t=String(a).match(Ue))?(this.a=!!b,Fe(this,t[1]||"",!0),this.j=Qe(t[2]||""),qe(this,t[3]||"",!0),je(this,t[4]),this.g=Qe(t[5]||"",!0),Ge(this,t[6]||"",!0),this.i=Qe(t[7]||"")):(this.a=!!b,this.b=new Ze(null,this.a))}function Me(a){return new Ve(a)}function Fe(a,b,t){a.f=t?Qe(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,""))}function qe(a,b,t){a.c=t?Qe(b,!0):b}function je(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.h=b}else a.h=null}function Ge(a,b,t){b instanceof Ze?(a.b=b,function(a,b){b&&!a.f&&(tn(a),a.c=null,a.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(dd(this,e),nn(this,n,t))}),a)),a.f=b}(a.b,a.a)):(t||(b=Ke(b,$e)),a.b=new Ze(b,a.a))}function Be(a,b,t){a.b.set(b,t)}function ze(a){return Be(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),a}function Qe(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ke(a,b,t){return"string"==typeof a?(a=encodeURI(a).replace(b,We),t&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function We(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Ve.prototype.toString=function(){var a=[],b=this.f;b&&a.push(Ke(b,He,!0),":");var t=this.c;return(t||"file"==b)&&(a.push("//"),(b=this.j)&&a.push(Ke(b,He,!0),"@"),a.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.h)&&a.push(":",String(t))),(t=this.g)&&(this.c&&"/"!=t.charAt(0)&&a.push("/"),a.push(Ke(t,"/"==t.charAt(0)?Xe:Ye,!0))),(t=this.b.toString())&&a.push("?",t),(t=this.i)&&a.push("#",Ke(t,Je)),a.join("")};var He=/[#\/\?@]/g,Ye=/[#\?:]/g,Xe=/[#\?]/g,$e=/[#\?@]/g,Je=/#/g;function Ze(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function tn(a){a.a||(a.a=new Re,a.b=0,a.c&&function(a,b){if(a){a=a.split("&");for(var t=0;t<a.length;t++){var e=a[t].indexOf("="),n=null;if(0<=e){var r=a[t].substring(0,e);n=a[t].substring(e+1)}else r=a[t];b(r,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(a.c,(function(b,t){a.add(decodeURIComponent(b.replace(/\+/g," ")),t)})))}function dd(a,b){tn(a),b=rn(a,b),Pe(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,Pe((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Ce(a)))}function en(a,b){return tn(a),b=rn(a,b),Pe(a.a.b,b)}function nn(a,b,t){dd(a,b),0<t.length&&(a.c=null,a.a.set(rn(a,b),x(t)),a.b+=t.length)}function rn(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}function on(a,b){this.b=a,this.a=b}function sn(a){this.g=a||un,f.PerformanceNavigationTiming?a=0<(a=f.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):a=!!(f.ia&&f.ia.ya&&f.ia.ya()&&f.ia.ya().qb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(g=Ze.prototype).add=function(a,b){tn(this),this.c=null,a=rn(this,a);var t=this.a.get(a);return t||this.a.set(a,t=[]),t.push(b),this.b+=1,this},g.forEach=function(a,b){tn(this),this.a.forEach((function(t,e){N(t,(function(t){a.call(b,t,e,this)}),this)}),this)},g.L=function(){tn(this);for(var a=this.a.K(),b=this.a.L(),t=[],e=0;e<b.length;e++)for(var n=a[e],r=0;r<n.length;r++)t.push(b[e]);return t},g.K=function(a){tn(this);var b=[];if("string"==typeof a)en(this,a)&&(b=S(b,this.a.get(rn(this,a))));else{a=this.a.K();for(var t=0;t<a.length;t++)b=S(b,a[t])}return b},g.set=function(a,b){return tn(this),this.c=null,en(this,a=rn(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},g.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.L(),t=0;t<b.length;t++){var e=b[t],n=encodeURIComponent(String(e));e=this.K(e);for(var r=0;r<e.length;r++){var o=n;""!==e[r]&&(o+="="+encodeURIComponent(String(e[r]))),a.push(o)}}return this.c=a.join("&")};var un=10;function an(a){return!!a.b||!!a.a&&a.a.size>=a.f}function cn(a){return a.b?1:a.a?a.a.size:0}function hn(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function fn(a,b){a.a?a.a.add(b):a.b=b}function ln(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function pn(a){var t,e;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var n=o(a.a.values()),r=n.next();!r.done;r=n.next()){var c=r.value;b=b.concat(c.s)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return b}return x(a.c)}function dn(){}function vn(){this.a=new dn}function yn(a,b,t){var e=t||"";try{Le(a,(function(t,n){var r=t;y(t)&&(r=Lt(t)),b.push(e+n+"="+encodeURIComponent(r))}))}catch(t){throw b.push(e+"type="+encodeURIComponent("_badmap")),t}}function gn(a,b,t,e,n){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,n(e)}catch(t){}}sn.prototype.cancel=function(){var t,e;if(this.c=pn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},dn.prototype.stringify=function(a){return f.JSON.stringify(a,void 0)},dn.prototype.parse=function(a){return f.JSON.parse(a,void 0)};var mn=f.JSON.parse;function wn(a){kt.call(this),this.headers=new Re,this.H=a||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=bn,this.D=this.F=!1}T(wn,kt);var bn="",_n=/^https?$/i,In=["POST","PUT"];function En(a){return"content-type"==a.toLowerCase()}function td(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,Tn(a),Nn(a)}function Tn(a){a.u||(a.u=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}function An(a){if(a.b&&void 0!==h&&(!a.s[1]||4!=xn(a)||2!=a.X()))if(a.l&&4==xn(a))Qt(a.za,0,a);else if(a.dispatchEvent("readystatechange"),4==xn(a)){a.b=!1;try{var t,b=a.X();t:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}if(!(t=e)){var n;if(n=0===b){var r=String(a.B).match(Ue)[1]||null;if(!r&&f.self&&f.self.location){var o=f.self.location.protocol;r=o.substr(0,o.length-1)}n=!_n.test(r?r.toLowerCase():"")}t=n}if(t)a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.h=6;try{var c=2<xn(a)?a.a.statusText:""}catch(t){c=""}a.f=c+" ["+a.X()+"]",Tn(a)}}finally{Nn(a)}}}function Nn(a,b){if(a.a){Sn(a);var t=a.a,e=a.s[0]?l:null;a.a=null,a.s=null,b||a.dispatchEvent("ready");try{t.onreadystatechange=e}catch(t){}}}function Sn(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(f.clearTimeout(a.m),a.m=null)}function xn(a){return a.a?a.a.readyState:0}function Dn(a,b,t){t:{for(e in t){var e=!1;break t}e=!0}e||(t=function(a){var b="";return U(a,(function(t,e){b+=e,b+=":",b+=t,b+="\r\n"})),b}(t),"string"==typeof a?null!=t&&encodeURIComponent(String(t)):Be(a,b,t))}function kn(a,b,t){return t&&t.internalChannelParams&&t.internalChannelParams[a]||b}function On(a){this.pa=0,this.g=[],this.c=new Jt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=kn("failFast",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=kn("baseRetryDelayMs",5e3,a),this.Ma=kn("retryDelaySeedMs",1e4,a),this.Ja=kn("forwardChannelMaxRetries",2,a),this.ma=kn("forwardChannelRequestTimeoutMs",2e4,a),this.Ka=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J="",this.b=new sn(a&&a.concurrentRequestLimit),this.ka=new vn,this.da=a&&a.fastHandshake||!1,this.Ga=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&a&&a.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Ln(a){if(Cn(a),3==a.v){var b=a.R++,t=Me(a.B);Be(t,"SID",a.J),Be(t,"RID",b),Be(t,"TYPE","terminate"),Mn(a,t),(b=new me(a,a.c,b,void 0)).H=2,b.i=ze(Me(t)),t=!1,f.navigator&&f.navigator.sendBeacon&&(t=f.navigator.sendBeacon(b.i.toString(),"")),!t&&f.Image&&((new Image).src=b.i,t=!0),t||(b.a=Xn(b.g,null),b.a.ba(b.i)),b.u=q(),Ne(b)}Hn(a)}function Rn(a){a.a&&(Gn(a),a.a.cancel(),a.a=null)}function Cn(a){Rn(a),a.j&&(f.clearTimeout(a.j),a.j=null),zn(a),a.b.cancel(),a.h&&("number"==typeof a.h&&f.clearTimeout(a.h),a.h=null)}function Pn(a,b){a.g.push(new on(a.La++,b)),3==a.v&&Un(a)}function Un(a){an(a.b)||a.h||(a.h=!0,Ft(a.Ba,a),a.u=0)}function Vn(a,b){var t;t=b?b.f:a.R++;var e=Me(a.B);Be(e,"SID",a.J),Be(e,"RID",t),Be(e,"AID",a.P),Mn(a,e),a.i&&a.l&&Dn(e,a.i,a.l),t=new me(a,a.c,t,a.u+1),null===a.i&&(t.B=a.l),b&&(a.g=b.s.concat(a.g)),b=Fn(a,t,1e3),t.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),fn(a.b,t),Ie(t,e,b)}function Mn(a,b){a.f&&Le({},(function(t,e){Be(b,e,t)}))}function Fn(a,b,t){t=Math.min(a.g.length,t);var e=a.f?p(a.f.Ha,a.f,a):null;t:for(var n=a.g,r=-1;;){var o=["count="+t];-1==r?0<t?(r=n[0].b,o.push("ofs="+r)):r=0:o.push("ofs="+r);for(var c=!0,h=0;h<t;h++){var f=n[h].b,l=n[h].a;if(0>(f-=r))r=Math.max(0,n[h].b-100),c=!1;else try{yn(l,o,"req"+f+"_")}catch(t){e&&e(l)}}if(c){e=o.join("&");break t}}return a=a.g.splice(0,t),b.s=a,e}function qn(a){a.a||a.j||(a.U=1,Ft(a.Aa,a),a.o=0)}function jn(a){return!(a.a||a.j||3<=a.o)&&(a.U++,a.j=ue(p(a.Aa,a),Kn(a,a.o)),a.o++,!0)}function Gn(a){null!=a.s&&(f.clearTimeout(a.s),a.s=null)}function Bn(a){a.a=new me(a,a.c,"rpc",a.U),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=Me(a.la);Be(b,"RID","rpc"),Be(b,"SID",a.J),Be(b,"CI",a.H?"0":"1"),Be(b,"AID",a.P),Mn(a,b),Be(b,"TYPE","xmlhttp"),a.i&&a.l&&Dn(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var t=a.a;a=a.ga,t.H=1,t.i=ze(Me(b)),t.j=null,t.I=!0,Ee(t,a)}function zn(a){null!=a.m&&(f.clearTimeout(a.m),a.m=null)}function Qn(a,b){var t=null;if(a.a==b){zn(a),Gn(a),a.a=null;var e=2}else{if(!hn(a.b,b))return;t=b.s,ln(a.b,b),e=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==e){t=b.j?b.j.length:0,b=q()-b.u;var n=a.u;(e=ee()).dispatchEvent(new se(e,t,b,n)),Un(a)}else qn(a);else if(3==(n=b.h)||0==n&&0<a.I||!(1==e&&function(a,b){return!(cn(a.b)>=a.b.f-(a.h?1:0))&&(a.h?(a.g=b.s.concat(a.g),!0):!(1==a.v||2==a.v||a.u>=(a.Ia?0:a.Ja))&&(a.h=ue(p(a.Ba,a,b),Kn(a,a.u)),a.u++,!0))}(a,b)||2==e&&jn(a)))switch(t&&0<t.length&&(b=a.b,b.c=b.c.concat(t)),n){case 1:Wn(a,5);break;case 4:Wn(a,10);break;case 3:Wn(a,6);break;default:Wn(a,2)}}function Kn(a,b){var t=a.Fa+Math.floor(Math.random()*a.Ma);return a.f||(t*=2),t*b}function Wn(a,b){if(a.c.info("Error code "+b),2==b){var t=null;a.f&&(t=null);var e=p(a.Xa,a);t||(t=new Ve("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||Fe(t,"https"),ze(t)),function(a,b){var t=new Jt;if(f.Image){var e=new Image;e.onload=E(gn,t,e,"TestLoadImage: loaded",!0,b),e.onerror=E(gn,t,e,"TestLoadImage: error",!1,b),e.onabort=E(gn,t,e,"TestLoadImage: abort",!1,b),e.ontimeout=E(gn,t,e,"TestLoadImage: timeout",!1,b),f.setTimeout((function(){e.ontimeout&&e.ontimeout()}),1e4),e.src=a}else b(!1)}(t.toString(),e)}else oe(2);a.v=0,a.f&&a.f.ra(b),Hn(a),Cn(a)}function Hn(a){a.v=0,a.I=-1,a.f&&(0==pn(a.b).length&&0==a.g.length||(a.b.c.length=0,x(a.g),a.g.length=0),a.f.qa())}function Yn(a,b,t){var e=function(a){return a instanceof Ve?Me(a):new Ve(a,void 0)}(t);if(""!=e.c)b&&qe(e,b+"."+e.c),je(e,e.h);else{var n=f.location;e=function(a,b,t,e){var n=new Ve(null,void 0);return a&&Fe(n,a),b&&qe(n,b),t&&je(n,t),e&&(n.g=e),n}(n.protocol,b?b+"."+n.hostname:n.hostname,+n.port,t)}return a.W&&U(a.W,(function(t,n){Be(e,n,t)})),b=a.A,t=a.na,b&&t&&Be(e,b,t),Be(e,"VER",a.ha),Mn(a,e),e}function Xn(a,b){if(b&&!a.C)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new wn(a.Ka)).F=a.C,b}function $n(){}function Jn(){if(z&&!(10<=Number(it)))throw Error("Environmental error: no available transport.")}function Zn(a,b){kt.call(this),this.a=new On(b),this.l=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.a&&(a?a["X-WebChannel-Client-Profile"]=b.a:a={"X-WebChannel-Client-Profile":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!D(a)&&(this.a.i=a),this.h=b&&b.supportsCrossDomainXhr||!1,this.g=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&(b in(a=this.b)&&delete a[b])),this.f=new rr(this)}function er(a){ve.call(this);var b=a.__sm__;if(b){t:{for(var t in b){a=t;break t}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function nr(){ye.call(this),this.status=1}function rr(a){this.a=a}(g=wn.prototype).ba=function(a,b,t,e){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+a);b=b?b.toUpperCase():"GET",this.B=a,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fe(this.H):fe(pe),this.a.onreadystatechange=p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(t){return void td(this,t)}a=t||"";var n=new Re(this.headers);e&&Le(e,(function(t,e){n.set(e,t)})),e=function(a){t:{for(var b=En,t=a.length,e="string"==typeof a?a.split(""):a,n=0;n<t;n++)if(n in e&&b.call(void 0,e[n],n,a)){b=n;break t}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]}(n.L()),t=f.FormData&&a instanceof f.FormData,!(0<=A(In,b))||e||t||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Sn(this),0<this.o&&((this.D=function(a){return z&&et(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=p(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(t){td(this,t)}},g.xa=function(){void 0!==h&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Nn(this))},g.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Nn(this,!0)),wn.S.G.call(this)},g.za=function(){this.j||(this.A||this.l||this.g?An(this):this.Ta())},g.Ta=function(){An(this)},g.X=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},g.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},g.Na=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),mn(b)}},g.ua=function(){return this.h},g.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(g=On.prototype).ha=8,g.v=1,g.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var t,b=new me(this,this.c,a,void 0),e=this.l;if(this.O&&(e?F(e=V(e),this.O):e=this.O),null===this.i&&(b.B=e),this.da)t:{for(var n=t=0;n<this.g.length;n++){var r=this.g[n];if(void 0===(r="__data__"in r.a&&"string"==typeof(r=r.a.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break t}if(4096===t||n===this.g.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Fn(this,b,t),Be(n=Me(this.B),"RID",a),Be(n,"CVER",22),this.A&&Be(n,"X-HTTP-Session-Id",this.A),Mn(this,n),this.i&&e&&Dn(n,this.i,e),fn(this.b,b),this.Ga&&Be(n,"TYPE","init"),this.da?(Be(n,"$req",t),Be(n,"SID","null"),b.V=!0,Ie(b,n,null)):Ie(b,n,t),this.v=2}}else 3==this.v&&(a?Vn(this,a):0==this.g.length||an(this.b)||Vn(this))},g.Aa=function(){if(this.j=null,Bn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info("BP detection timer enabled: "+a),this.s=ue(p(this.Sa,this),a)}},g.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Rn(this),Bn(this))},g.Ra=function(){null!=this.m&&(this.m=null,Rn(this),jn(this),oe(19))},g.Xa=function(a){a?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(g=$n.prototype).ta=function(){},g.sa=function(){},g.ra=function(){},g.qa=function(){},g.Ha=function(){},Jn.prototype.a=function(a,b){return new Zn(a,b)},T(Zn,kt),(g=Zn.prototype).addEventListener=function(a,b,t,e){Zn.S.addEventListener.call(this,a,b,t,e)},g.removeEventListener=function(a,b,t,e){Zn.S.removeEventListener.call(this,a,b,t,e)},g.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var a=this.a,b=this.l,t=this.b||void 0;oe(0),a.fa=b,a.W=t||{},a.H=a.T,a.B=Yn(a,null,a.fa),Un(a)},g.close=function(){Ln(this.a)},g.Pa=function(a){if("string"==typeof a){var b={};b.__data__=a,Pn(this.a,b)}else this.g?((b={}).__data__=Lt(a),Pn(this.a,b)):Pn(this.a,a)},g.G=function(){this.a.f=null,delete this.f,Ln(this.a),delete this.a,Zn.S.G.call(this)},T(er,ve),T(nr,ye),T(rr,$n),rr.prototype.ta=function(){this.a.dispatchEvent("a")},rr.prototype.sa=function(a){this.a.dispatchEvent(new er(a))},rr.prototype.ra=function(a){this.a.dispatchEvent(new nr(a))},rr.prototype.qa=function(){this.a.dispatchEvent("b")},Jn.prototype.createWebChannel=Jn.prototype.a,Zn.prototype.send=Zn.prototype.Pa,Zn.prototype.open=Zn.prototype.Oa,Zn.prototype.close=Zn.prototype.close,ae.NO_ERROR=0,ae.TIMEOUT=8,ae.HTTP_ERROR=6,ce.COMPLETE="complete",le.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",kt.prototype.listen=kt.prototype.va,wn.prototype.listenOnce=wn.prototype.wa,wn.prototype.getLastError=wn.prototype.Qa,wn.prototype.getLastErrorCode=wn.prototype.ua,wn.prototype.getStatus=wn.prototype.X,wn.prototype.getResponseJson=wn.prototype.Na,wn.prototype.getResponseText=wn.prototype.$,wn.prototype.send=wn.prototype.ba;var ir={createWebChannelTransport:function(){return new Jn},ErrorCode:ae,EventType:ce,WebChannel:le,XhrIo:wn},or=ir.createWebChannelTransport,sr=ir.ErrorCode,ur=ir.EventType,ar=ir.WebChannel,cr=ir.XhrIo;e.default=ir}.call(this,n(22))},254:function(t,e,n){"use strict";n.r(e);n(251)}}]);